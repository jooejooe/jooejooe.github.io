<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>松果小站</title>
  
  <subtitle>松果小站博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.songuo.tech/"/>
  <updated>2021-04-02T01:08:45.189Z</updated>
  <id>https://blog.songuo.tech/</id>
  
  <author>
    <name>松鼠</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>模拟操作之word编辑问题</title>
    <link href="https://blog.songuo.tech/p/d973a64a.html"/>
    <id>https://blog.songuo.tech/p/d973a64a.html</id>
    <published>2021-04-02T02:22:00.000Z</published>
    <updated>2021-04-02T01:08:45.189Z</updated>
    
    <content type="html"><![CDATA[<p>背景：软航的word编辑操作，在模拟操作中无法进行定位处理。</p><a id="more"></a><p>方案：</p><ol><li>打开需要进行模拟的编辑页面</li><li>找到保存按钮或上一步打开编辑页面loadword的对应的方法，在方法中看能否找到保存的是哪个文件（保存方法的request中看能否查到）。</li><li>在本机找到对应的文件缓存目录（js中找到的路径）</li><li>使用poi或其他中间件操作word</li><li>模拟操作进行提交。</li></ol><p>例如：</p><p>1.软航中保存的按钮，看SaveToURL(type,returnFlag)方法，首先接受了所有的修订AcceptAllRevisions()，接受修订调用了ActiveX插件进行的，document.getElementById(“TANGER_OCX”).ActiveDocument.AcceptAllRevisions()，接受修订完成后进行的word上传保存操作。从如下js中获取</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> returnFlag_glob = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> spxtPath = <span class="string">'http://149.0.150.10:8080/ajgl/'</span>;</span><br><span class="line"><span class="keyword">var</span> sfJaws;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">SaveToURL</span>(<span class="params">type,returnFlag</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> sfgg=<span class="string">"0"</span>;</span><br><span class="line"><span class="keyword">if</span>(sfgg==<span class="string">'1'</span>)&#123;</span><br><span class="line">AcceptAllRevisions();</span><br><span class="line">&#125;</span><br><span class="line">       <span class="keyword">if</span>(type == <span class="number">2</span>)&#123;</span><br><span class="line">             <span class="keyword">if</span>(confirm(<span class="string">"定稿之后文书将无法修改，确认要继续？"</span>))&#123;</span><br><span class="line">                 commit(type,returnFlag);</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">             commit(type,returnFlag);</span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//接受所有修订</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AcceptAllRevisions</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ActiveDocument.AcceptAllRevisions();</span><br><span class="line">&#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">commit</span>(<span class="params">type,returnFlag</span>)</span>&#123;</span><br><span class="line">  showLoading();</span><br><span class="line">$(<span class="string">"#loading-indicator-LoadingInfo-overlay"</span>).html(<span class="string">"&lt;div style='text-align:left;background-color:yellow;width:100px;color:red;font-size:14px;margin-top:3px;'&gt;&lt;strong&gt;数据提交中....&lt;/strong&gt;&lt;/div&gt;"</span>);</span><br><span class="line">  <span class="keyword">var</span> ntkoobj = <span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>);</span><br><span class="line">  <span class="keyword">var</span> filePath = <span class="string">'M13/fgsws/2021/4_1/M13_da5681a8-b648-4b34-9f0d-4b17bb3d4e44.doc'</span>;</span><br><span class="line"> <span class="keyword">var</span> fileNameArray = filePath.split(<span class="string">"/"</span>);</span><br><span class="line"> <span class="keyword">var</span> fileName = fileNameArray[fileNameArray.length<span class="number">-1</span>];</span><br><span class="line"> <span class="keyword">var</span> isgk = $(<span class="string">"#sfgk"</span>).val();</span><br><span class="line"><span class="keyword">var</span> isJaws=sfJaws; <span class="comment">//是否是结案文书</span></span><br><span class="line"> <span class="keyword">if</span>(!isgk)&#123;</span><br><span class="line"> isgk = <span class="string">''</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">var</span> bgkyy = $(<span class="string">"#bgkyy"</span>).val();</span><br><span class="line"> <span class="keyword">if</span>(!bgkyy)&#123;</span><br><span class="line"> bgkyy = <span class="string">''</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> returnFlag_glob = returnFlag;</span><br><span class="line"> <span class="comment">//ntkoobj.WebUserName = "11"; </span></span><br><span class="line"> <span class="keyword">var</span> save_type = <span class="number">5</span>;</span><br><span class="line"> <span class="keyword">if</span>(fileName.indexOf(<span class="string">".rtf"</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line"> save_type = <span class="number">3</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> saveUrl = <span class="string">'http://149.0.150.10:8080/ajgl/FgswsServletUpload'</span>;</span><br><span class="line"> <span class="keyword">if</span>(type==<span class="number">2</span>)&#123;<span class="comment">//定稿</span></span><br><span class="line"> saveUrl= <span class="string">'http://149.0.158.70/ajgl/FgswsServletUpload'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> saveUrl += <span class="string">'?isJaws='</span>+isJaws+<span class="string">'&amp;spid=&amp;dsrId=ef55d25a-48fb-45e8-ba4f-a6a89a217b5b&amp;sddzid=&amp;fydm=M13&amp;mbids=M0026145bce-67df-473e-93a8-acb18dcdd9f8&amp;ajbs=c9fdcdcc-940f-4eaa-9d9b-339687ec2354&amp;isgk='</span>+isgk+<span class="string">'&amp;bizpaycode=&amp;bgkyy='</span>+bgkyy+<span class="string">"&amp;sfzdybt="</span>+$(<span class="string">"#sfzdybt"</span>).val()+<span class="string">"&amp;wjxsmc="</span>+$(<span class="string">"#wjxsmc"</span>).val()+<span class="string">"&amp;type="</span>+type+loginParams;</span><br><span class="line">saveUrl+=<span class="string">"&amp;ywjlid=&amp;txm=3115585141528-20190001"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(saveUrl);</span><br><span class="line"><span class="keyword">if</span> (browser==<span class="string">"IE"</span>)&#123;</span><br><span class="line"> <span class="keyword">var</span> doc_res=ntkoobj.SaveAsOtherFormatToURL(save_type,saveUrl,<span class="string">'EDITFILE'</span>,<span class="string">''</span>,fileName,<span class="string">'commitForm'</span>,<span class="literal">true</span>);</span><br><span class="line"> <span class="comment">//var doc_res=ntkoobj.SaveToURL(encodeURI(saveUrl),'EDITFILE','',fileName,0); </span></span><br><span class="line"> <span class="keyword">var</span> res = doc_res.split(<span class="string">"#"</span>);</span><br><span class="line"> <span class="keyword">if</span>(res[<span class="number">0</span>]==<span class="string">"success"</span>)&#123;</span><br><span class="line"> hideLoading();</span><br><span class="line"> <span class="keyword">if</span>(returnFlag == <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> url=spxtPath+<span class="string">'/xbsswsIndexAction/inFgswsSideIndex.action?type=1&amp;swh=0&amp;jlid='</span>+res[<span class="number">1</span>]+<span class="string">'&amp;ajbs=c9fdcdcc-940f-4eaa-9d9b-339687ec2354&amp;nodeId=SPGL_SA&amp;opr=edit'</span>;</span><br><span class="line">  <span class="built_in">window</span>.parent.location = url+loginParams+<span class="string">"#refresh"</span>;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="string">"1"</span>==<span class="string">"main"</span>)&#123;</span><br><span class="line">  toback();</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  closeWin();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ShowTipMessage(<span class="string">"提示"</span>,<span class="string">"文书保存失败！"</span>);</span><br><span class="line">  hideLoading();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> ntkoobj.SaveAsOtherFormatToURL(save_type,saveUrl,<span class="string">'EDITFILE'</span>,<span class="string">''</span>,fileName,<span class="string">'commitForm'</span>,<span class="literal">true</span>);</span><br><span class="line"> <span class="comment">//var doc_res=ntkoobj.SaveToURL(encodeURI(saveUrl),'EDITFILE','',fileName,0); </span></span><br><span class="line"> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">savetourlre</span>(<span class="params">type,code,html</span>)</span>&#123;</span><br><span class="line">  tipsShow = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> res = html.split(<span class="string">"#"</span>);</span><br><span class="line">  <span class="keyword">if</span>(res[<span class="number">0</span>] == <span class="string">"success"</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> url=spxtPath+<span class="string">'/xbsswsIndexAction/inFgswsSideIndex.action?type=1&amp;swh=0&amp;jlid='</span>+res[<span class="number">1</span>]+<span class="string">'&amp;ajbs=c9fdcdcc-940f-4eaa-9d9b-339687ec2354&amp;nodeId=SPGL_SA&amp;opr=edit'</span>;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ShowTipMessage(<span class="string">"提示"</span>,<span class="string">"文书保存成功!"</span>);</span><br><span class="line">hideLoading();</span><br><span class="line"><span class="keyword">if</span>(returnFlag_glob == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"1"</span>==<span class="string">"main"</span>)&#123;</span><br><span class="line">  toback();</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">closeWin();</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">window</span>.parent.location = url+loginParams+<span class="string">"#refresh"</span>;</span><br><span class="line">&#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(res[<span class="number">0</span>] == <span class="string">"error"</span>)&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ShowTipMessage(<span class="string">"提示"</span>,<span class="string">"文书保存失败!"</span>);</span><br><span class="line">  hideLoading();</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//保存之后的回调</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">saveasotherurl</span>(<span class="params">type,code,html</span>)</span>&#123;</span><br><span class="line">  tipsShow = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> res = html.split(<span class="string">"#"</span>);</span><br><span class="line">  <span class="keyword">if</span>(res[<span class="number">0</span>] == <span class="string">"success"</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> url=spxtPath+<span class="string">'/xbsswsIndexAction/inFgswsSideIndex.action?type=1&amp;swh=0&amp;jlid='</span>+res[<span class="number">1</span>]+<span class="string">'&amp;ajbs=c9fdcdcc-940f-4eaa-9d9b-339687ec2354&amp;nodeId=SPGL_SA&amp;opr=edit'</span>;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ShowTipMessage(<span class="string">"提示"</span>,<span class="string">"文书保存成功!"</span>);</span><br><span class="line">hideLoading();</span><br><span class="line"><span class="keyword">if</span>(returnFlag_glob == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">"1"</span>==<span class="string">"main"</span>)&#123;</span><br><span class="line">  toback();</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">closeWin();</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">window</span>.parent.location = url+loginParams+<span class="string">"#refresh"</span>;</span><br><span class="line">&#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(res[<span class="number">0</span>] == <span class="string">"error"</span>)&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"TANGER_OCX"</span>).ShowTipMessage(<span class="string">"提示"</span>,<span class="string">"文书保存失败!"</span>);</span><br><span class="line">  hideLoading();</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">"checkbox_d2"</span>).onclick=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> checkbox_css = $(<span class="string">"#checkbox_d2"</span>).attr(<span class="string">"class"</span>);</span><br><span class="line"><span class="keyword">if</span>(checkbox_css==<span class="string">"qiehuan"</span>)&#123;</span><br><span class="line">$(<span class="string">"#checkbox_d2"</span>).attr(<span class="string">"class"</span>,<span class="string">"qiehuan2"</span>);</span><br><span class="line">$(<span class="string">"#checkbox_span"</span>).text(<span class="string">"该文书是本案结案文书"</span>);</span><br><span class="line">sfJaws = <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$(<span class="string">"#checkbox_d2"</span>).attr(<span class="string">"class"</span>,<span class="string">"qiehuan"</span>);</span><br><span class="line">$(<span class="string">"#checkbox_span"</span>).text(<span class="string">"该文书不是结案文书"</span>);</span><br><span class="line">sfJaws = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clearbtn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"#left_item"</span>).empty();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">addbtn</span>(<span class="params">nr</span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"#left_item"</span>).append(nr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> json;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">btnjson</span>(<span class="params">mc,url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(json==<span class="string">""</span>||json==<span class="literal">null</span>)&#123;</span><br><span class="line">    json = <span class="string">"'"</span>+mc+<span class="string">"':"</span>+<span class="string">"'"</span>+url+<span class="string">"'"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    json += <span class="string">",'"</span>+mc+<span class="string">"':"</span>+<span class="string">"'"</span>+url+<span class="string">"'"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getjson</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//$("#temp").text("&#123;"+json+"&#125;");</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>2.在本机中找到对应的文件路径“<em>M13/fgsws/2021/4_1/M13_da5681a8-b648-4b34-9f0d-4b17bb3d4e44.doc</em>”</p><p>3.使用poi进行word操作</p><p>4.操作完成或，模拟进行提交</p><p>参考资料：</p><p>aspose-word-for-java-acceptallrevisions-method-is-not-working-as-expected: <a href="https://stackoverflow.com/questions/49119524/aspose-word-for-java-acceptallrevisions-method-is-not-working-as-expected" target="_blank" rel="noopener">https://stackoverflow.com/questions/49119524/aspose-word-for-java-acceptallrevisions-method-is-not-working-as-expected</a></p><p>Document. Open 事件 (Word): <a href="https://docs.microsoft.com/zh-cn/office/vba/api/word.document.open" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/office/vba/api/word.document.open</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;背景：软航的word编辑操作，在模拟操作中无法进行定位处理。&lt;/p&gt;
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium操作易盾验证码</title>
    <link href="https://blog.songuo.tech/p/c585010e.html"/>
    <id>https://blog.songuo.tech/p/c585010e.html</id>
    <published>2021-03-21T09:55:00.000Z</published>
    <updated>2021-03-31T09:57:30.562Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.opencv.core.*;</span><br><span class="line"><span class="keyword">import</span> org.opencv.imgcodecs.Imgcodecs;</span><br><span class="line"><span class="keyword">import</span> org.opencv.imgproc.Imgproc;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.JavascriptExecutor;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeOptions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.interactions.Actions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.ExpectedCondition;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.ExpectedConditions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.WebDriverWait;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YidunRPA</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Long start = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">            login();</span><br><span class="line">            log.info(<span class="string">"第&#123;&#125;次登陆，耗时&#123;&#125;秒"</span>,(i+<span class="number">1</span>),(System.currentTimeMillis()-start)/<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.setProperty(<span class="string">"webdriver.chrome.driver"</span>,<span class="string">"C:\\windows\\chromedriver.exe"</span>);</span><br><span class="line">        <span class="comment">//创建无Chrome无头参数</span></span><br><span class="line">        ChromeOptions chromeOptions=<span class="keyword">new</span> ChromeOptions();</span><br><span class="line">        <span class="comment">//chromeOptions.addArguments("-headless");</span></span><br><span class="line">        WebDriver browser = <span class="keyword">new</span> ChromeDriver(chromeOptions);</span><br><span class="line">        browser.get(<span class="string">"https://ssfw.gdcourts.gov.cn/web/loginA"</span>);</span><br><span class="line">        WebElement loginWE = browser.findElement(By.id(<span class="string">"login_user_name"</span>));</span><br><span class="line">        loginWE.sendKeys(<span class="string">"151111111111"</span>);</span><br><span class="line">        WebElement psdWE = browser.findElement(By.id(<span class="string">"psw"</span>));</span><br><span class="line">        psdWE.sendKeys(<span class="string">"1111111"</span>);</span><br><span class="line">        JavascriptExecutor jse = (JavascriptExecutor)browser;</span><br><span class="line">        jse.executeScript(<span class="string">"document.getElementById(\"psw\").value=\"pwd\";"</span>);</span><br><span class="line">        jse.executeScript(<span class="string">"document.getElementById(\"login_pwdkey_txt\").value=\"pwd\";"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> count=<span class="number">0</span>;count&lt;<span class="number">10</span>;count++)&#123;</span><br><span class="line">            log.info(<span class="string">"验证码重试次数&#123;&#125;"</span>,(count+<span class="number">1</span>));</span><br><span class="line">            <span class="keyword">if</span> (captcha(browser))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"end"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">captcha</span><span class="params">(WebDriver browser)</span></span>&#123;</span><br><span class="line">        <span class="comment">//需要UI界面，有头模式</span></span><br><span class="line">        Actions action=<span class="keyword">new</span> Actions(browser);</span><br><span class="line">        action.moveToElement(browser.findElement(By.id(<span class="string">"captcha"</span>)));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//等待图片出现</span></span><br><span class="line">        WebElement bgimgWE = (<span class="keyword">new</span> WebDriverWait( browser, <span class="number">3</span>)).until(<span class="keyword">new</span> ExpectedCondition&lt;WebElement&gt;()&#123;</span><br><span class="line">                                                             <span class="meta">@Override</span></span><br><span class="line">                                                             <span class="function"><span class="keyword">public</span> WebElement <span class="title">apply</span><span class="params">(WebDriver d)</span></span>&#123;</span><br><span class="line">                                                                 <span class="keyword">return</span> d.findElement(By.className(<span class="string">"yidun_bg-img"</span>));</span><br><span class="line">                                                             &#125;</span><br><span class="line">                                                         &#125;</span><br><span class="line">        );</span><br><span class="line">        String bgimgUrl = bgimgWE.getAttribute(<span class="string">"src"</span>);</span><br><span class="line">        WebElement jigsawWE = browser.findElement(By.className(<span class="string">"yidun_jigsaw"</span>));</span><br><span class="line">        String jigsawUrl = jigsawWE.getAttribute(<span class="string">"src"</span>);</span><br><span class="line">        <span class="keyword">double</span> distance = getDistance(bgimgUrl,jigsawUrl);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            move(browser,browser.findElement(By.className(<span class="string">"yidun_slider"</span>)),Integer.parseInt(<span class="keyword">new</span> java.text.DecimalFormat(<span class="string">"0"</span>).format(distance)));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        WebElement element =<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//等待元素出现</span></span><br><span class="line">             element = (<span class="keyword">new</span> WebDriverWait( browser, <span class="number">5</span>)).until(<span class="keyword">new</span> ExpectedCondition&lt;WebElement&gt;()&#123;</span><br><span class="line">                                                                                <span class="meta">@Override</span></span><br><span class="line">                                                                                <span class="function"><span class="keyword">public</span> WebElement <span class="title">apply</span><span class="params">(WebDriver d)</span></span>&#123;</span><br><span class="line">                                                                                    <span class="keyword">return</span> d.findElement(By.xpath(<span class="string">"//*[@id=\"page-wrapper\"]/div[2]/nav/div/a"</span>));</span><br><span class="line">                                                                                &#125;</span><br><span class="line">                                                                            &#125;</span><br><span class="line">            );</span><br><span class="line">            log.info(element.getText());</span><br><span class="line">            browser.quit();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.info(<span class="string">"获取元素失败"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取网易验证滑动距离</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String dllPath = <span class="string">"E:\\CODE\\rpa\\opencv\\opencv_java451.dll"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">getDistance</span><span class="params">(String bUrl, String sUrl)</span> </span>&#123;</span><br><span class="line">        log.info(bUrl);</span><br><span class="line">        log.info(sUrl);</span><br><span class="line">        System.load(dllPath);</span><br><span class="line">        File bFile = <span class="keyword">new</span> File(<span class="string">"E:/EasyDun_b.png"</span>);</span><br><span class="line">        File sFile = <span class="keyword">new</span> File(<span class="string">"E:/EasyDun_s.png"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(bUrl), bFile);</span><br><span class="line">            BufferedImage bgBI = ImageIO.read(bFile);</span><br><span class="line"></span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(sUrl), sFile);</span><br><span class="line">            BufferedImage sBI = ImageIO.read(sFile);</span><br><span class="line">            <span class="comment">// 裁剪</span></span><br><span class="line">            cropImage(bgBI, sBI, bFile, sFile);</span><br><span class="line">            Mat s_mat = Imgcodecs.imread(sFile.getPath());</span><br><span class="line">            Mat b_mat  = Imgcodecs.imread(bFile.getPath());</span><br><span class="line"></span><br><span class="line">            <span class="comment">//阴影部分为黑底时需要转灰度和二值化，为白底时不需要</span></span><br><span class="line">            <span class="comment">// 转灰度图像</span></span><br><span class="line">            Mat s_newMat = <span class="keyword">new</span> Mat();</span><br><span class="line">            Imgproc.cvtColor(s_mat, s_newMat, Imgproc.COLOR_BGR2GRAY);</span><br><span class="line">            <span class="comment">// 二值化图像</span></span><br><span class="line">            binaryzation(s_newMat);</span><br><span class="line">            Imgcodecs.imwrite(sFile.getPath(), s_newMat);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> result_rows = b_mat.rows() - s_mat.rows() + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> result_cols = b_mat.cols() - s_mat.cols() + <span class="number">1</span>;</span><br><span class="line">            Mat g_result = <span class="keyword">new</span> Mat(result_rows, result_cols, CvType.CV_32FC1);</span><br><span class="line">            Imgproc.matchTemplate(b_mat, s_mat, g_result, Imgproc.TM_SQDIFF);</span><br><span class="line">            <span class="comment">// 归一化平方差匹配法TM_SQDIFF 相关系数匹配法TM_CCOEFF</span></span><br><span class="line"></span><br><span class="line">            Core.normalize(g_result, g_result, <span class="number">0</span>, <span class="number">1</span>, Core.NORM_MINMAX, -<span class="number">1</span>, <span class="keyword">new</span> Mat());</span><br><span class="line">            Point matchLocation = <span class="keyword">new</span> Point();</span><br><span class="line">            Core.MinMaxLocResult mmlr = Core.minMaxLoc(g_result);</span><br><span class="line">            matchLocation = mmlr.maxLoc;</span><br><span class="line">            <span class="comment">// 此处使用maxLoc还是minLoc取决于使用的匹配算法</span></span><br><span class="line">            Imgproc.rectangle(b_mat, matchLocation, <span class="keyword">new</span> Point(matchLocation.x + s_mat.cols(), matchLocation.y + s_mat.rows()), <span class="keyword">new</span> Scalar(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">            Imgcodecs.imwrite(bFile.getPath(), b_mat);</span><br><span class="line">            <span class="keyword">return</span> matchLocation.x + s_mat.cols() - sBI.getWidth() + <span class="number">12</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//            bFile.delete();</span></span><br><span class="line"><span class="comment">//            sFile.delete();</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 图片亮度调整</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> image</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> param</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bloding</span><span class="params">(BufferedImage image, <span class="keyword">int</span> param)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (image == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> rgb, R, G, B;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; image.getWidth(); i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; image.getHeight(); j++) &#123;</span><br><span class="line">                    rgb = image.getRGB(i, j);</span><br><span class="line">                    R = ((rgb &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>) - param;</span><br><span class="line">                    G = ((rgb &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>) - param;</span><br><span class="line">                    B = (rgb &amp; <span class="number">0xff</span>) - param;</span><br><span class="line">                    rgb = ((clamp(<span class="number">255</span>) &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">24</span>) | ((clamp(R) &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">16</span>) | ((clamp(G) &amp; <span class="number">0xff</span>) &lt;&lt; <span class="number">8</span>) | ((clamp(B) &amp; <span class="number">0xff</span>));</span><br><span class="line">                    image.setRGB(i, j, rgb);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断a,r,g,b值，大于256返回256，小于0则返回0,0到256之间则直接返回原始值</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">clamp</span><span class="params">(<span class="keyword">int</span> rgb)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rgb &gt; <span class="number">255</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">255</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span> (rgb &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">        <span class="keyword">return</span> rgb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成半透明小图并裁剪</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> image</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cropImage</span><span class="params">(BufferedImage bigImage, BufferedImage smallImage, File bigFile, File smallFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> h_ = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 2 生成半透明图片</span></span><br><span class="line">            bloding(bigImage, <span class="number">75</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">0</span>; w &lt; smallImage.getWidth(); w++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> h = smallImage.getHeight() - <span class="number">2</span>; h &gt;= <span class="number">0</span>; h--) &#123;</span><br><span class="line">                    <span class="keyword">int</span> rgb = smallImage.getRGB(w, h);</span><br><span class="line">                    <span class="keyword">int</span> A = (rgb &amp; <span class="number">0xFF000000</span>) &gt;&gt;&gt; <span class="number">24</span>;</span><br><span class="line">                    <span class="keyword">if</span> (A &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">                        rgb = (<span class="number">127</span> &lt;&lt; <span class="number">24</span>) | (rgb &amp; <span class="number">0x00ffffff</span>);</span><br><span class="line">                        smallImage.setRGB(w, h, rgb);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">1</span>; h &lt; smallImage.getHeight(); h++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> w = <span class="number">1</span>; w &lt; smallImage.getWidth(); w++) &#123;</span><br><span class="line">                    <span class="keyword">int</span> rgb = smallImage.getRGB(w, h);</span><br><span class="line">                    <span class="keyword">int</span> A = (rgb &amp; <span class="number">0xFF000000</span>) &gt;&gt;&gt; <span class="number">24</span>;</span><br><span class="line">                    <span class="keyword">if</span> (A &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (y == <span class="number">0</span>)&#123;</span><br><span class="line">                            y = h;&#125;</span><br><span class="line">                        h_ = h - y;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            smallImage = smallImage.getSubimage(<span class="number">0</span>, y, smallImage.getWidth(), h_);</span><br><span class="line">            bigImage = bigImage.getSubimage(<span class="number">0</span>, y, bigImage.getWidth(), h_);</span><br><span class="line">            ImageIO.write(bigImage, <span class="string">"png"</span>, bigFile);</span><br><span class="line">            ImageIO.write(smallImage, <span class="string">"png"</span>, smallFile);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mat</span></span><br><span class="line"><span class="comment">     *            二值化图像</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">binaryzation</span><span class="params">(Mat mat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> BLACK = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> WHITE = <span class="number">255</span>;</span><br><span class="line">        <span class="keyword">int</span> ucThre = <span class="number">0</span>, ucThre_new = <span class="number">127</span>;</span><br><span class="line">        <span class="keyword">int</span> nBack_count, nData_count;</span><br><span class="line">        <span class="keyword">int</span> nBack_sum, nData_sum;</span><br><span class="line">        <span class="keyword">int</span> nValue;</span><br><span class="line">        <span class="keyword">int</span> i, j;</span><br><span class="line">        <span class="keyword">int</span> width = mat.width(), height = mat.height();</span><br><span class="line">        <span class="comment">// 寻找最佳的阙值</span></span><br><span class="line">        <span class="keyword">while</span> (ucThre != ucThre_new) &#123;</span><br><span class="line">            nBack_sum = nData_sum = <span class="number">0</span>;</span><br><span class="line">            nBack_count = nData_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; height; ++j) &#123;</span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; width; i++) &#123;</span><br><span class="line">                    nValue = (<span class="keyword">int</span>) mat.get(j, i)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (nValue &gt; ucThre_new) &#123;</span><br><span class="line">                        nBack_sum += nValue;</span><br><span class="line">                        nBack_count++;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        nData_sum += nValue;</span><br><span class="line">                        nData_count++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            nBack_sum = nBack_sum / nBack_count;</span><br><span class="line">            nData_sum = nData_sum / nData_count;</span><br><span class="line">            ucThre = ucThre_new;</span><br><span class="line">            ucThre_new = (nBack_sum + nData_sum) / <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 二值化处理</span></span><br><span class="line">        <span class="keyword">int</span> nBlack = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> nWhite = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; height; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; width; ++i) &#123;</span><br><span class="line">                nValue = (<span class="keyword">int</span>) mat.get(j, i)[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (nValue &gt; ucThre_new) &#123;</span><br><span class="line">                    mat.put(j, i, WHITE);</span><br><span class="line">                    nWhite++;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mat.put(j, i, BLACK);</span><br><span class="line">                    nBlack++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 确保白底黑字</span></span><br><span class="line">        <span class="keyword">if</span> (nBlack &gt; nWhite) &#123;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; height; ++j) &#123;</span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; width; ++i) &#123;</span><br><span class="line">                    nValue = (<span class="keyword">int</span>) (mat.get(j, i)[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">if</span> (nValue == <span class="number">0</span>) &#123;</span><br><span class="line">                        mat.put(j, i, WHITE);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        mat.put(j, i, BLACK);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 延时加载</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> WebElement <span class="title">waitWebElement</span><span class="params">(WebDriver driver, By by, <span class="keyword">int</span> count)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        WebElement webElement = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">boolean</span> isWait = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; count; k++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                webElement = driver.findElement(by);</span><br><span class="line">                <span class="keyword">if</span> (isWait) &#123;</span><br><span class="line">                    System.out.println(<span class="string">" ok!"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> webElement;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (org.openqa.selenium.NoSuchElementException ex) &#123;</span><br><span class="line">                isWait = <span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.print(<span class="string">"waitWebElement("</span> + by.toString() + <span class="string">")"</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.print(<span class="string">"."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                Thread.sleep(<span class="number">50</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isWait) &#123;</span><br><span class="line">            System.out.println(<span class="string">" outTime!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟人工移动</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> driver</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> element页面滑块</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> distance需要移动距离</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">(WebDriver driver, WebElement element, <span class="keyword">int</span> distance)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> randomTime = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (distance &gt; <span class="number">90</span>) &#123;</span><br><span class="line">            randomTime = <span class="number">250</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (distance &gt; <span class="number">80</span> &amp;&amp; distance &lt;= <span class="number">90</span>) &#123;</span><br><span class="line">            randomTime = <span class="number">150</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Integer&gt; track = getMoveTrack(distance - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">int</span> moveY = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Actions actions = <span class="keyword">new</span> Actions(driver);</span><br><span class="line">            actions.clickAndHold(element).perform();</span><br><span class="line">            <span class="comment">//Thread.sleep(200);</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; track.size(); i++) &#123;</span><br><span class="line">                actions.moveByOffset(track.get(i), moveY).perform();</span><br><span class="line">                Thread.sleep(<span class="keyword">new</span> Random().nextInt(<span class="number">300</span>) + randomTime);</span><br><span class="line">            &#125;</span><br><span class="line">            Thread.sleep(<span class="number">200</span>);</span><br><span class="line">            actions.release(element).perform();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据距离获取滑动轨迹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> distance需要移动的距离</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title">getMoveTrack</span><span class="params">(<span class="keyword">int</span> distance)</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; track = <span class="keyword">new</span> ArrayList&lt;&gt;();<span class="comment">// 移动轨迹</span></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> current = <span class="number">0</span>;<span class="comment">// 已经移动的距离</span></span><br><span class="line">        <span class="keyword">int</span> mid = (<span class="keyword">int</span>) distance * <span class="number">4</span> / <span class="number">5</span>;<span class="comment">// 减速阈值</span></span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> move = <span class="number">0</span>;<span class="comment">// 每次循环移动的距离</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            a = random.nextInt(<span class="number">10</span>);</span><br><span class="line">            <span class="keyword">if</span> (current &lt;= mid) &#123;</span><br><span class="line">                move += a;<span class="comment">// 不断加速</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                move -= a;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((current + move) &lt; distance) &#123;</span><br><span class="line">                track.add(move);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                track.add(distance - current);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            current += move;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> track;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算滑动距离</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bUrl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sUrl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">getSlideDistance</span><span class="params">(String bUrl, String sUrl)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            File bFile = <span class="keyword">new</span> File(<span class="string">"E:/EasyDun1_b.png"</span>);</span><br><span class="line">            File sFile = <span class="keyword">new</span> File(<span class="string">"E:/EasyDun1_s.png"</span>);</span><br><span class="line">            <span class="comment">// 加载OpenCV本地库</span></span><br><span class="line">            <span class="comment">//System.loadLibrary(Core.NATIVE_LIBRARY_NAME);</span></span><br><span class="line">            System.load(dllPath);</span><br><span class="line"></span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(bUrl), bFile);</span><br><span class="line">            BufferedImage bgBI = ImageIO.read(bFile);</span><br><span class="line"></span><br><span class="line">            FileUtils.copyURLToFile(<span class="keyword">new</span> URL(sUrl), sFile);</span><br><span class="line">            BufferedImage sBI = ImageIO.read(sFile);</span><br><span class="line">            <span class="comment">// 裁剪</span></span><br><span class="line"><span class="comment">//            cropImage(bgBI, sBI, bFile, sFile);</span></span><br><span class="line">            <span class="comment">//对滑块进行处理</span></span><br><span class="line">            Mat slideBlockMat = Imgcodecs.imread(sFile.getPath());</span><br><span class="line">            <span class="comment">//1、灰度化图片</span></span><br><span class="line">            Imgproc.cvtColor(slideBlockMat, slideBlockMat, Imgproc.COLOR_BGR2GRAY);</span><br><span class="line">            <span class="comment">//2、去除周围黑边</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; slideBlockMat.height(); row++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; slideBlockMat.width(); col++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (slideBlockMat.get(row, col)[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">                        slideBlockMat.put(row, col, <span class="number">96</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//3、inRange二值化转黑白图</span></span><br><span class="line">            Core.inRange(slideBlockMat, Scalar.all(<span class="number">96</span>), Scalar.all(<span class="number">96</span>), slideBlockMat);</span><br><span class="line"></span><br><span class="line">            Imgcodecs.imwrite(sFile.getPath(), slideBlockMat);</span><br><span class="line">            <span class="comment">//对滑动背景图进行处理</span></span><br><span class="line">            Mat slideBgMat = Imgcodecs.imread(bFile.getPath());</span><br><span class="line">            <span class="comment">//1、灰度化图片</span></span><br><span class="line">            Imgproc.cvtColor(slideBgMat, slideBgMat, Imgproc.COLOR_BGR2GRAY);</span><br><span class="line">            <span class="comment">//2、二值化</span></span><br><span class="line">            Imgproc.threshold(slideBgMat, slideBgMat, <span class="number">127</span>, <span class="number">255</span>, Imgproc.THRESH_BINARY);</span><br><span class="line">            Imgcodecs.imwrite(bFile.getPath(), slideBgMat);</span><br><span class="line">            Mat g_result = <span class="keyword">new</span> Mat();</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * matchTemplate：在模板和输入图像之间寻找匹配,获得匹配结果图像</span></span><br><span class="line"><span class="comment">             * result：保存匹配的结果矩阵</span></span><br><span class="line"><span class="comment">             * TM_CCOEFF_NORMED标准相关匹配算法</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            Imgproc.matchTemplate(slideBgMat, slideBlockMat, g_result, Imgproc.TM_CCOEFF_NORMED);</span><br><span class="line">            <span class="comment">/* minMaxLoc：在给定的结果矩阵中寻找最大和最小值，并给出它们的位置</span></span><br><span class="line"><span class="comment">             * maxLoc最大值</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            Point matchLocation = Core.minMaxLoc(g_result).maxLoc;</span><br><span class="line">            <span class="comment">//返回匹配点的横向距离</span></span><br><span class="line">            <span class="keyword">return</span> matchLocation.x;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;187&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;188&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;189&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;190&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;191&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;193&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;194&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;195&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;196&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;197&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;198&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;199&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;200&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;201&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;202&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;203&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;204&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;205&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;206&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;207&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;208&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;210&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;211&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;212&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;213&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;214&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;215&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;216&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;217&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;218&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;219&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;220&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;221&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;222&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;223&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;224&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;225&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;226&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;227&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;228&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;229&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;231&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;232&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;233&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;234&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;236&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;238&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;239&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;241&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;242&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;243&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;244&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;245&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;246&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;247&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;248&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;249&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;250&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;251&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;252&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;253&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;254&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;255&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;256&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;257&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;258&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;259&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;261&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;262&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;264&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;265&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;266&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;267&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;268&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;269&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;270&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;271&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;272&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;273&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;274&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;275&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;276&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;277&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;278&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;279&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;280&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;281&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;282&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;283&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;285&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;286&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;287&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;289&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;290&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;291&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;292&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;293&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;294&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;295&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;297&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;298&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;299&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;300&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;301&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;302&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;303&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;304&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;305&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;306&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;307&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;308&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;309&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;310&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;311&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;312&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;313&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;315&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;316&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;317&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;318&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;319&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;320&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;321&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;322&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;323&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;324&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;325&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;326&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;327&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;328&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;329&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;330&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;331&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;332&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;333&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;334&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;335&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;336&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;337&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;338&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;339&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;340&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;341&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;342&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;343&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;344&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;345&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;346&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;347&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;348&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;349&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;350&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;351&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;352&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;353&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;354&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;355&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;356&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;357&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;358&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;359&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;360&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;361&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;362&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;363&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;364&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;365&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;366&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;367&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;368&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;369&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;370&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;371&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;372&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;373&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;374&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;375&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;376&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;377&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;378&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;379&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;380&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;381&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;382&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;383&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;385&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;386&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;387&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;388&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;389&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;390&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;391&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;392&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;393&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;394&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;395&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;396&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;397&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;398&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;399&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;400&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;401&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;402&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;403&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;404&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;405&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;406&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;407&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;408&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;409&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;410&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;411&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;412&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;413&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;414&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;415&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;416&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;417&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;418&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;419&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;420&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;421&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;422&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;423&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;424&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;425&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;426&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;427&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;428&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;429&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;430&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;431&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;432&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;433&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;434&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;435&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;436&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;437&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;438&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;439&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;440&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;441&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;442&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;443&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;444&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;445&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;446&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;447&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;448&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;449&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;450&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;451&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;452&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;453&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;454&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;455&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;456&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;457&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;458&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;459&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;460&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;461&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; lombok.extern.slf4j.Slf4j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.io.FileUtils;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.lang3.StringUtils;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.opencv.core.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.opencv.imgcodecs.Imgcodecs;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.opencv.imgproc.Imgproc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.By;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.JavascriptExecutor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.WebDriver;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.WebElement;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.chrome.ChromeDriver;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.chrome.ChromeOptions;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.interactions.Actions;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.support.ui.ExpectedCondition;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.support.ui.ExpectedConditions;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.support.ui.WebDriverWait;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; javax.imageio.ImageIO;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.image.BufferedImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.io.File;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.net.URL;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.util.ArrayList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.util.List;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.util.Random;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Slf&lt;/span&gt;4j&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;YidunRPA&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Long start = System.currentTimeMillis();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;i&amp;lt;&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;;i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            login();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            log.info(&lt;span class=&quot;string&quot;&gt;&quot;第&amp;#123;&amp;#125;次登陆，耗时&amp;#123;&amp;#125;秒&quot;&lt;/span&gt;,(i+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),(System.currentTimeMillis()-start)/&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.setProperty(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.driver&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;C:\\windows\\chromedriver.exe&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//创建无Chrome无头参数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ChromeOptions chromeOptions=&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeOptions();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//chromeOptions.addArguments(&quot;-headless&quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebDriver browser = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeDriver(chromeOptions);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        browser.get(&lt;span class=&quot;string&quot;&gt;&quot;https://ssfw.gdcourts.gov.cn/web/loginA&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement loginWE = browser.findElement(By.id(&lt;span class=&quot;string&quot;&gt;&quot;login_user_name&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        loginWE.sendKeys(&lt;span class=&quot;string&quot;&gt;&quot;151111111111&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement psdWE = browser.findElement(By.id(&lt;span class=&quot;string&quot;&gt;&quot;psw&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        psdWE.sendKeys(&lt;span class=&quot;string&quot;&gt;&quot;1111111&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        JavascriptExecutor jse = (JavascriptExecutor)browser;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        jse.executeScript(&lt;span class=&quot;string&quot;&gt;&quot;document.getElementById(\&quot;psw\&quot;).value=\&quot;pwd\&quot;;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        jse.executeScript(&lt;span class=&quot;string&quot;&gt;&quot;document.getElementById(\&quot;login_pwdkey_txt\&quot;).value=\&quot;pwd\&quot;;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;count&amp;lt;&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;count++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            log.info(&lt;span class=&quot;string&quot;&gt;&quot;验证码重试次数&amp;#123;&amp;#125;&quot;&lt;/span&gt;,(count+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (captcha(browser))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;end&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;captcha&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(WebDriver browser)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//需要UI界面，有头模式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Actions action=&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Actions(browser);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        action.moveToElement(browser.findElement(By.id(&lt;span class=&quot;string&quot;&gt;&quot;captcha&quot;&lt;/span&gt;)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Thread.sleep(&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//等待图片出现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement bgimgWE = (&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; WebDriverWait( browser, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)).until(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ExpectedCondition&amp;lt;WebElement&amp;gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                             &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                             &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; WebElement &lt;span class=&quot;title&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(WebDriver d)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                 &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; d.findElement(By.className(&lt;span class=&quot;string&quot;&gt;&quot;yidun_bg-img&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                             &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                         &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        String bgimgUrl = bgimgWE.getAttribute(&lt;span class=&quot;string&quot;&gt;&quot;src&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement jigsawWE = browser.findElement(By.className(&lt;span class=&quot;string&quot;&gt;&quot;yidun_jigsaw&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        String jigsawUrl = jigsawWE.getAttribute(&lt;span class=&quot;string&quot;&gt;&quot;src&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; distance = getDistance(bgimgUrl,jigsawUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            move(browser,browser.findElement(By.className(&lt;span class=&quot;string&quot;&gt;&quot;yidun_slider&quot;&lt;/span&gt;)),Integer.parseInt(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; java.text.DecimalFormat(&lt;span class=&quot;string&quot;&gt;&quot;0&quot;&lt;/span&gt;).format(distance)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement element =&lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//等待元素出现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             element = (&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; WebDriverWait( browser, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)).until(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ExpectedCondition&amp;lt;WebElement&amp;gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; WebElement &lt;span class=&quot;title&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(WebDriver d)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                                    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; d.findElement(By.xpath(&lt;span class=&quot;string&quot;&gt;&quot;//*[@id=\&quot;page-wrapper\&quot;]/div[2]/nav/div/a&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            log.info(element.getText());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            browser.quit();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            log.info(&lt;span class=&quot;string&quot;&gt;&quot;获取元素失败&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 获取网易验证滑动距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; String dllPath = &lt;span class=&quot;string&quot;&gt;&quot;E:\\CODE\\rpa\\opencv\\opencv_java451.dll&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getDistance&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String bUrl, String sUrl)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        log.info(bUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        log.info(sUrl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.load(dllPath);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        File bFile = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;string&quot;&gt;&quot;E:/EasyDun_b.png&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        File sFile = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;string&quot;&gt;&quot;E:/EasyDun_s.png&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            FileUtils.copyURLToFile(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(bUrl), bFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            BufferedImage bgBI = ImageIO.read(bFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            FileUtils.copyURLToFile(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(sUrl), sFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            BufferedImage sBI = ImageIO.read(sFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 裁剪&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cropImage(bgBI, sBI, bFile, sFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat s_mat = Imgcodecs.imread(sFile.getPath());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat b_mat  = Imgcodecs.imread(bFile.getPath());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//阴影部分为黑底时需要转灰度和二值化，为白底时不需要&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 转灰度图像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat s_newMat = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Mat();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.cvtColor(s_mat, s_newMat, Imgproc.COLOR_BGR2GRAY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 二值化图像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            binaryzation(s_newMat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgcodecs.imwrite(sFile.getPath(), s_newMat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; result_rows = b_mat.rows() - s_mat.rows() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; result_cols = b_mat.cols() - s_mat.cols() + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat g_result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Mat(result_rows, result_cols, CvType.CV_32FC1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.matchTemplate(b_mat, s_mat, g_result, Imgproc.TM_SQDIFF);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 归一化平方差匹配法TM_SQDIFF 相关系数匹配法TM_CCOEFF&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Core.normalize(g_result, g_result, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, Core.NORM_MINMAX, -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Mat());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Point matchLocation = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Point();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Core.MinMaxLocResult mmlr = Core.minMaxLoc(g_result);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            matchLocation = mmlr.maxLoc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 此处使用maxLoc还是minLoc取决于使用的匹配算法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.rectangle(b_mat, matchLocation, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Point(matchLocation.x + s_mat.cols(), matchLocation.y + s_mat.rows()), &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Scalar(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgcodecs.imwrite(bFile.getPath(), b_mat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; matchLocation.x + s_mat.cols() - sBI.getWidth() + &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;finally&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//            bFile.delete();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//            sFile.delete();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 图片亮度调整&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; image&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; param&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@throws&lt;/span&gt; IOException&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bloding&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(BufferedImage image, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; param)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (image == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; rgb, R, G, B;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; image.getWidth(); i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; image.getHeight(); j++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    rgb = image.getRGB(i, j);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    R = ((rgb &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) - param;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    G = ((rgb &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) - param;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    B = (rgb &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) - param;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    rgb = ((clamp(&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;) | ((clamp(R) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;) | ((clamp(G) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;) &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;) | ((clamp(B) &amp;amp; &lt;span class=&quot;number&quot;&gt;0xff&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    image.setRGB(i, j, rgb);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 判断a,r,g,b值，大于256返回256，小于0则返回0,0到256之间则直接返回原始值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;clamp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; rgb)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rgb &amp;gt; &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rgb &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; rgb;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 生成半透明小图并裁剪&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; image&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;cropImage&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(BufferedImage bigImage, BufferedImage smallImage, File bigFile, File smallFile)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; h_ = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 2 生成半透明图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            bloding(bigImage, &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; w &amp;lt; smallImage.getWidth(); w++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; h = smallImage.getHeight() - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; h &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; h--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; rgb = smallImage.getRGB(w, h);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; A = (rgb &amp;amp; &lt;span class=&quot;number&quot;&gt;0xFF000000&lt;/span&gt;) &amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (A &amp;gt;= &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        rgb = (&lt;span class=&quot;number&quot;&gt;127&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;) | (rgb &amp;amp; &lt;span class=&quot;number&quot;&gt;0x00ffffff&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        smallImage.setRGB(w, h, rgb);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; h = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; h &amp;lt; smallImage.getHeight(); h++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; w = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; w &amp;lt; smallImage.getWidth(); w++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; rgb = smallImage.getRGB(w, h);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; A = (rgb &amp;amp; &lt;span class=&quot;number&quot;&gt;0xFF000000&lt;/span&gt;) &amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (A &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (y == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            y = h;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        h_ = h - y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            smallImage = smallImage.getSubimage(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, y, smallImage.getWidth(), h_);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            bigImage = bigImage.getSubimage(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, y, bigImage.getWidth(), h_);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ImageIO.write(bigImage, &lt;span class=&quot;string&quot;&gt;&quot;png&quot;&lt;/span&gt;, bigFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ImageIO.write(smallImage, &lt;span class=&quot;string&quot;&gt;&quot;png&quot;&lt;/span&gt;, smallFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.out.println(e.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; mat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     *            二值化图像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;binaryzation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Mat mat)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; BLACK = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; WHITE = &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ucThre = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, ucThre_new = &lt;span class=&quot;number&quot;&gt;127&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; nBack_count, nData_count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; nBack_sum, nData_sum;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; nValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i, j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; width = mat.width(), height = mat.height();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 寻找最佳的阙值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (ucThre != ucThre_new) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            nBack_sum = nData_sum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            nBack_count = nData_count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; height; ++j) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; width; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    nValue = (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) mat.get(j, i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nValue &amp;gt; ucThre_new) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        nBack_sum += nValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        nBack_count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        nData_sum += nValue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        nData_count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            nBack_sum = nBack_sum / nBack_count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            nData_sum = nData_sum / nData_count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ucThre = ucThre_new;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ucThre_new = (nBack_sum + nData_sum) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 二值化处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; nBlack = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; nWhite = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; height; ++j) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; width; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                nValue = (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) mat.get(j, i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nValue &amp;gt; ucThre_new) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    mat.put(j, i, WHITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    nWhite++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    mat.put(j, i, BLACK);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    nBlack++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 确保白底黑字&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nBlack &amp;gt; nWhite) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; height; ++j) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; width; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    nValue = (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) (mat.get(j, i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (nValue == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        mat.put(j, i, WHITE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        mat.put(j, i, BLACK);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 延时加载&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; WebElement &lt;span class=&quot;title&quot;&gt;waitWebElement&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(WebDriver driver, By by, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement webElement = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; isWait = &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; k = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; k &amp;lt; count; k++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                webElement = driver.findElement(by);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isWait) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    System.out.println(&lt;span class=&quot;string&quot;&gt;&quot; ok!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; webElement;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (org.openqa.selenium.NoSuchElementException ex) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                isWait = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (k == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    System.out.print(&lt;span class=&quot;string&quot;&gt;&quot;waitWebElement(&quot;&lt;/span&gt; + by.toString() + &lt;span class=&quot;string&quot;&gt;&quot;)&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    System.out.print(&lt;span class=&quot;string&quot;&gt;&quot;.&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Thread.sleep(&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isWait) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.out.println(&lt;span class=&quot;string&quot;&gt;&quot; outTime!&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 模拟人工移动&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; driver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; element页面滑块&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; distance需要移动距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;move&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(WebDriver driver, WebElement element, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; distance)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; randomTime = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (distance &amp;gt; &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            randomTime = &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (distance &amp;gt; &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt; &amp;amp;&amp;amp; distance &amp;lt;= &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            randomTime = &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Integer&amp;gt; track = getMoveTrack(distance - &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; moveY = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Actions actions = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Actions(driver);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actions.clickAndHold(element).perform();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//Thread.sleep(200);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; track.size(); i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                actions.moveByOffset(track.get(i), moveY).perform();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Thread.sleep(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Random().nextInt(&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;) + randomTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Thread.sleep(&lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            actions.release(element).perform();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 根据距离获取滑动轨迹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; distance需要移动的距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Integer&amp;gt; &lt;span class=&quot;title&quot;&gt;getMoveTrack&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; distance)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Integer&amp;gt; track = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;span class=&quot;comment&quot;&gt;// 移动轨迹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Random random = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Random();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; current = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;// 已经移动的距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mid = (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) distance * &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt; / &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;// 减速阈值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; a = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; move = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;// 每次循环移动的距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            a = random.nextInt(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (current &amp;lt;= mid) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                move += a;&lt;span class=&quot;comment&quot;&gt;// 不断加速&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                move -= a;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((current + move) &amp;lt; distance) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                track.add(move);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                track.add(distance - current);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            current += move;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; track;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * 计算滑动距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; bUrl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; sUrl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getSlideDistance&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String bUrl, String sUrl)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            File bFile = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;string&quot;&gt;&quot;E:/EasyDun1_b.png&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            File sFile = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;string&quot;&gt;&quot;E:/EasyDun1_s.png&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 加载OpenCV本地库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//System.loadLibrary(Core.NATIVE_LIBRARY_NAME);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.load(dllPath);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            FileUtils.copyURLToFile(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(bUrl), bFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            BufferedImage bgBI = ImageIO.read(bFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            FileUtils.copyURLToFile(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; URL(sUrl), sFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            BufferedImage sBI = ImageIO.read(sFile);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 裁剪&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//            cropImage(bgBI, sBI, bFile, sFile);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//对滑块进行处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat slideBlockMat = Imgcodecs.imread(sFile.getPath());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//1、灰度化图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.cvtColor(slideBlockMat, slideBlockMat, Imgproc.COLOR_BGR2GRAY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//2、去除周围黑边&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; row = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; row &amp;lt; slideBlockMat.height(); row++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; col = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; col &amp;lt; slideBlockMat.width(); col++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (slideBlockMat.get(row, col)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        slideBlockMat.put(row, col, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//3、inRange二值化转黑白图&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Core.inRange(slideBlockMat, Scalar.all(&lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;), Scalar.all(&lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;), slideBlockMat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgcodecs.imwrite(sFile.getPath(), slideBlockMat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//对滑动背景图进行处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat slideBgMat = Imgcodecs.imread(bFile.getPath());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//1、灰度化图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.cvtColor(slideBgMat, slideBgMat, Imgproc.COLOR_BGR2GRAY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//2、二值化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.threshold(slideBgMat, slideBgMat, &lt;span class=&quot;number&quot;&gt;127&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, Imgproc.THRESH_BINARY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgcodecs.imwrite(bFile.getPath(), slideBgMat);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Mat g_result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Mat();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             * matchTemplate：在模板和输入图像之间寻找匹配,获得匹配结果图像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             * result：保存匹配的结果矩阵&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             * TM_CCOEFF_NORMED标准相关匹配算法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Imgproc.matchTemplate(slideBgMat, slideBlockMat, g_result, Imgproc.TM_CCOEFF_NORMED);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;/* minMaxLoc：在给定的结果矩阵中寻找最大和最小值，并给出它们的位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             * maxLoc最大值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;             */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Point matchLocation = Core.minMaxLoc(g_result).maxLoc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//返回匹配点的横向距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; matchLocation.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium操作chrome时的一些配置</title>
    <link href="https://blog.songuo.tech/p/f606163d.html"/>
    <id>https://blog.songuo.tech/p/f606163d.html</id>
    <published>2021-03-21T03:00:00.000Z</published>
    <updated>2021-03-31T09:57:30.612Z</updated>
    
    <content type="html"><![CDATA[<p>收集的一些selenium chrome配置信息：<br>　　一些Chrome的地址栏命令（这些命令会不停的变动，所有不一定都是好用的）<br>　　在Chrome的浏览器地址栏中输入以下命令，就会返回相应的结果。这些命令包括查看内存状态，浏览器状态，网络状态，DNS服务器状态，插件缓存等等。<br>　　about:version - 显示当前版本<br>　　about:memory - 显示本机浏览器内存使用状况<br>　　about:plugins - 显示已安装插件<br>　　about:histograms - 显示历史记录<br>　　about:dns - 显示DNS状态<br>　　about:cache - 显示缓存页面<br>　　about:gpu -是否有硬件加速<br>　　about:flags -开启一些插件 //使用后弹出这么些东西：“请小心，这些实验可能有风险”，不知会不会搞乱俺的配置啊！<br>　　chrome://extensions/ - 查看已经安装的扩展<br>　　其他的一些关于Chrome的实用参数及简要的中文说明（使用方法同上，当然也可以在shell中使用）<br>　　–user-data-dir=”[PATH]” 指定用户文件夹User Data路径，可以把书签这样的用户数据保存在系统分区以外的分区。<br>　　–disk-cache-dir=”[PATH]“ 指定缓存Cache路径<br>　　–disk-cache-size= 指定Cache大小，单位Byte<br>　　–first run 重置到初始状态，第一次运行<br>　　–incognito 隐身模式启动<br>　　–disable-javascript 禁用Javascript<br>　　—omnibox-popup-count=”num” 将地址栏弹出的提示菜单数量改为num个。我都改为15个了。<br>　　—user-agent=”xxxxxxxx” 修改HTTP请求头部的Agent字符串，可以通过about:version页面查看修改效果<br>　　—disable-plugins 禁止加载所有插件，可以增加速度。可以通过about:plugins页面查看效果<br>　　—disable-javascript 禁用JavaScript，如果觉得速度慢在加上这个<br>　　—disable-java 禁用java<br>　　—start-maximized 启动就最大化<br>　　—no-sandbox 取消沙盒模式<br>　　—single-process 单进程运行<br>　　—process-per-tab 每个标签使用单独进程<br>　　—process-per-site 每个站点使用单独进程<br>　　—in-process-plugins 插件不启用单独进程<br>　　—disable-popup-blocking 禁用弹出拦截<br>　　—disable-plugins 禁用插件<br>　　—disable-images 禁用图像<br>　　—incognito 启动进入隐身模式<br>　　—enable-udd-profiles 启用账户切换菜单<br>　　—proxy-pac-url 使用pac代理 [via 1/2]<br>　　—lang=zh-CN 设置语言为简体中文<br>　　—disk-cache-dir 自定义缓存目录<br>　　—disk-cache-size 自定义缓存最大值（单位byte）<br>　　—media-cache-size 自定义多媒体缓存最大值（单位byte）<br>　　—bookmark-menu 在工具 栏增加一个书签按钮<br>　　—enable-sync 启用书签同步</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getChromeDriver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Config config = <span class="keyword">new</span> ConfigProvider().get();</span><br><span class="line">    </span><br><span class="line">    Config configToUse = Optional.ofNullable(config).orElse(ConfigLoader.load());</span><br><span class="line">    prepareChromeDriver(configToUse);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> String osName = config.getString(<span class="string">"os.name"</span>);</span><br><span class="line">    ChromeOptions chromeOptions = <span class="keyword">new</span> ChromeOptions();</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.containsIgnoreCase(osName, <span class="string">"windows"</span>)) &#123; <span class="comment">// 本地Windows环境, 初始化local环境的chrome driver</span></span><br><span class="line">      logger.info(<span class="string">"windows环境"</span>, osName);</span><br><span class="line">      chromeOptions.setBinary(configToUse.getString(<span class="string">"webdriver.chrome.binary"</span>)); <span class="comment">// windows下chrome地址</span></span><br><span class="line">      chromeOptions.addArguments(<span class="string">"--profile-directory=target"</span>);</span><br><span class="line">      chromeOptions.addArguments(<span class="string">"--user-data-dir=target\\"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// FAT/UAT/PROD等Linux环境, 初始化Linux环境的chrome driver</span></span><br><span class="line">      logger.info(<span class="string">"Linux环境"</span>, osName);</span><br><span class="line">      chromeOptions.setBinary(<span class="string">"/usr/bin/google-chrome-stable"</span>); <span class="comment">// 配置chrome安装地址</span></span><br><span class="line">      chromeOptions.addArguments(<span class="string">"--headless"</span>);</span><br><span class="line">      chromeOptions.addArguments(<span class="string">"--disable-gpu"</span>);</span><br><span class="line">      String proxyServer = qconfigService.getConfig(<span class="string">"proxyHost"</span>) + <span class="string">":"</span> + qconfigService.getConfig(<span class="string">"proxyPort"</span>); <span class="comment">//代理配置</span></span><br><span class="line">      chromeOptions.addArguments(<span class="string">"--proxy-server="</span> + proxyServer);</span><br><span class="line">    &#125;</span><br><span class="line">    chromeOptions.addArguments(<span class="string">"--incognito"</span>); <span class="comment">// 打开隐私模式</span></span><br><span class="line">    chromeOptions.addArguments(<span class="string">"--lang="</span> + chineses); <span class="comment">// 中文</span></span><br><span class="line">    chromeOptions.addArguments(<span class="string">"-test-type"</span>, <span class="string">"--ignore-certificate-errors"</span>); <span class="comment">// 忽略证书错误</span></span><br><span class="line">    chromeOptions.addArguments(<span class="string">"--no-sandbox"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//    添加chrome模拟器</span></span><br><span class="line"><span class="comment">//    Map&lt;String, String&gt; mobileEmulation = new HashMap&lt;String, String&gt;();</span></span><br><span class="line"><span class="comment">//    mobileEmulation.put("deviceName", "Galaxy S5");//"Nexus 5X");</span></span><br><span class="line"><span class="comment">//    chromeOptions.setExperimentalOption("mobileEmulation", mobileEmulation);</span></span><br><span class="line">    </span><br><span class="line">    String webDriverPath = System.getProperty(<span class="string">"webdriver.chrome.driver"</span>);</span><br><span class="line">    ChromeDriverService driverService = <span class="keyword">new</span> ChromeDriverService.Builder().usingDriverExecutable(<span class="keyword">new</span> File(webDriverPath)).usingAnyFreePort().build();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      driverService.start();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      logger.error(e);</span><br><span class="line">    &#125;</span><br><span class="line">    logger.info(<span class="string">"webdriver.chrome.driver"</span>, webDriverPath);</span><br><span class="line">    ChromeDriver driver = <span class="keyword">new</span> ChromeDriver(driverService, chromeOptions);</span><br><span class="line">    logger.info(<span class="string">"webdriver.chrome.driver"</span>, webDriverPath);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;收集的一些selenium chrome配置信息：&lt;br&gt;　　一些Chrome的地址栏命令（这些命令会不停的变动，所有不一定都是好用的）&lt;br&gt;　　在Chrome的浏览器地址栏中输入以下命令，就会返回相应的结果。这些命令包括查看内存状态，浏览器状态，网络状态，DNS服务器状态，插件缓存等等。&lt;br&gt;　　about:version - 显示当前版本&lt;br&gt;　　about:memory - 显示本机浏览器内存使用状况&lt;br&gt;　　about:plugins - 显示已安装插件&lt;br&gt;　　about:histograms - 显示历史记录&lt;br&gt;　　about:dns - 显示DNS状态&lt;br&gt;　　about:cache - 显示缓存页面&lt;br&gt;　　about:gpu -是否有硬件加速&lt;br&gt;　　about:flags -开启一些插件 //使用后弹出这么些东西：“请小心，这些实验可能有风险”，不知会不会搞乱俺的配置啊！&lt;br&gt;　　chrome://extensions/ - 查看已经安装的扩展&lt;br&gt;　　其他的一些关于Chrome的实用参数及简要的中文说明（使用方法同上，当然也可以在shell中使用）&lt;br&gt;　　–user-data-dir=”[PATH]” 指定用户文件夹User Data路径，可以把书签这样的用户数据保存在系统分区以外的分区。&lt;br&gt;　　–disk-cache-dir=”[PATH]“ 指定缓存Cache路径&lt;br&gt;　　–disk-cache-size= 指定Cache大小，单位Byte&lt;br&gt;　　–first run 重置到初始状态，第一次运行&lt;br&gt;　　–incognito 隐身模式启动&lt;br&gt;　　–disable-javascript 禁用Javascript&lt;br&gt;　　—omnibox-popup-count=”num” 将地址栏弹出的提示菜单数量改为num个。我都改为15个了。&lt;br&gt;　　—user-agent=”xxxxxxxx” 修改HTTP请求头部的Agent字符串，可以通过about:version页面查看修改效果&lt;br&gt;　　—disable-plugins 禁止加载所有插件，可以增加速度。可以通过about:plugins页面查看效果&lt;br&gt;　　—disable-javascript 禁用JavaScript，如果觉得速度慢在加上这个&lt;br&gt;　　—disable-java 禁用java&lt;br&gt;　　—start-maximized 启动就最大化&lt;br&gt;　　—no-sandbox 取消沙盒模式&lt;br&gt;　　—single-process 单进程运行&lt;br&gt;　　—process-per-tab 每个标签使用单独进程&lt;br&gt;　　—process-per-site 每个站点使用单独进程&lt;br&gt;　　—in-process-plugins 插件不启用单独进程&lt;br&gt;　　—disable-popup-blocking 禁用弹出拦截&lt;br&gt;　　—disable-plugins 禁用插件&lt;br&gt;　　—disable-images 禁用图像&lt;br&gt;　　—incognito 启动进入隐身模式&lt;br&gt;　　—enable-udd-profiles 启用账户切换菜单&lt;br&gt;　　—proxy-pac-url 使用pac代理 [via 1/2]&lt;br&gt;　　—lang=zh-CN 设置语言为简体中文&lt;br&gt;　　—disk-cache-dir 自定义缓存目录&lt;br&gt;　　—disk-cache-size 自定义缓存最大值（单位byte）&lt;br&gt;　　—media-cache-size 自定义多媒体缓存最大值（单位byte）&lt;br&gt;　　—bookmark-menu 在工具 栏增加一个书签按钮&lt;br&gt;　　—enable-sync 启用书签同步&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getChromeDriver&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Config config = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ConfigProvider().get();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Config configToUse = Optional.ofNullable(config).orElse(ConfigLoader.load());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    prepareChromeDriver(configToUse);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String osName = config.getString(&lt;span class=&quot;string&quot;&gt;&quot;os.name&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ChromeOptions chromeOptions = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeOptions();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (StringUtils.containsIgnoreCase(osName, &lt;span class=&quot;string&quot;&gt;&quot;windows&quot;&lt;/span&gt;)) &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 本地Windows环境, 初始化local环境的chrome driver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      logger.info(&lt;span class=&quot;string&quot;&gt;&quot;windows环境&quot;&lt;/span&gt;, osName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.setBinary(configToUse.getString(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.binary&quot;&lt;/span&gt;)); &lt;span class=&quot;comment&quot;&gt;// windows下chrome地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--profile-directory=target&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--user-data-dir=target\\&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123; &lt;span class=&quot;comment&quot;&gt;// FAT/UAT/PROD等Linux环境, 初始化Linux环境的chrome driver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      logger.info(&lt;span class=&quot;string&quot;&gt;&quot;Linux环境&quot;&lt;/span&gt;, osName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.setBinary(&lt;span class=&quot;string&quot;&gt;&quot;/usr/bin/google-chrome-stable&quot;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 配置chrome安装地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--headless&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--disable-gpu&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      String proxyServer = qconfigService.getConfig(&lt;span class=&quot;string&quot;&gt;&quot;proxyHost&quot;&lt;/span&gt;) + &lt;span class=&quot;string&quot;&gt;&quot;:&quot;&lt;/span&gt; + qconfigService.getConfig(&lt;span class=&quot;string&quot;&gt;&quot;proxyPort&quot;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;//代理配置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--proxy-server=&quot;&lt;/span&gt; + proxyServer);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--incognito&quot;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 打开隐私模式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--lang=&quot;&lt;/span&gt; + chineses); &lt;span class=&quot;comment&quot;&gt;// 中文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;-test-type&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;--ignore-certificate-errors&quot;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 忽略证书错误&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    chromeOptions.addArguments(&lt;span class=&quot;string&quot;&gt;&quot;--no-sandbox&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//    添加chrome模拟器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//    Map&amp;lt;String, String&amp;gt; mobileEmulation = new HashMap&amp;lt;String, String&amp;gt;();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//    mobileEmulation.put(&quot;deviceName&quot;, &quot;Galaxy S5&quot;);//&quot;Nexus 5X&quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//    chromeOptions.setExperimentalOption(&quot;mobileEmulation&quot;, mobileEmulation);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    String webDriverPath = System.getProperty(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.driver&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ChromeDriverService driverService = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeDriverService.Builder().usingDriverExecutable(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; File(webDriverPath)).usingAnyFreePort().build();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      driverService.start();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      logger.error(e);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    logger.info(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.driver&quot;&lt;/span&gt;, webDriverPath);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ChromeDriver driver = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeDriver(driverService, chromeOptions);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    logger.info(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.driver&quot;&lt;/span&gt;, webDriverPath);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium获取验证码图片</title>
    <link href="https://blog.songuo.tech/p/d53ef6cb.html"/>
    <id>https://blog.songuo.tech/p/d53ef6cb.html</id>
    <published>2021-03-21T02:22:00.000Z</published>
    <updated>2021-03-31T09:57:30.650Z</updated>
    
    <content type="html"><![CDATA[<p>获取验证码图片</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import java.awt.image.BufferedImage;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSONObject;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import okhttp3.Response;</span><br><span class="line">import okhttp3.ResponseBody;</span><br><span class="line">import org.apache.commons.httpclient.HttpClient;</span><br><span class="line">import org.apache.commons.io.FileUtils;</span><br><span class="line">import org.apache.http.HeaderIterator;</span><br><span class="line">import org.apache.http.HttpEntity;</span><br><span class="line">import org.apache.http.HttpResponse;</span><br><span class="line">import org.apache.http.HttpStatus;</span><br><span class="line">import org.apache.http.NameValuePair;</span><br><span class="line">import org.apache.http.ParseException;</span><br><span class="line">import org.apache.http.client.ClientProtocolException;</span><br><span class="line">import org.apache.http.client.CookieStore;</span><br><span class="line">import org.apache.http.client.config.RequestConfig;</span><br><span class="line">import org.apache.http.client.entity.UrlEncodedFormEntity;</span><br><span class="line">import org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line">import org.apache.http.client.methods.HttpGet;</span><br><span class="line">import org.apache.http.client.methods.HttpPost;</span><br><span class="line">import org.apache.http.client.protocol.HttpClientContext;</span><br><span class="line">import org.apache.http.cookie.Cookie;</span><br><span class="line">import org.apache.http.impl.client.*;</span><br><span class="line">import org.apache.http.impl.cookie.BasicClientCookie;</span><br><span class="line">import org.apache.http.message.BasicNameValuePair;</span><br><span class="line">import org.apache.http.util.EntityUtils;</span><br><span class="line">import org.openqa.selenium.*;</span><br><span class="line">import org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line">import org.openqa.selenium.chrome.ChromeOptions;</span><br><span class="line"></span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line"></span><br><span class="line">@Slf4j</span><br><span class="line">public class LsptRPA &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            System.setProperty(&quot;webdriver.chrome.driver&quot;,&quot;C:\\windows\\chromedriver.exe&quot;);</span><br><span class="line">            &#x2F;&#x2F;创建无Chrome无头参数</span><br><span class="line">            ChromeOptions chromeOptions&#x3D;new ChromeOptions();</span><br><span class="line">            chromeOptions.addArguments(&quot;-headless&quot;);</span><br><span class="line">            WebDriver browser &#x3D; new ChromeDriver(chromeOptions);</span><br><span class="line">            browser.manage().window().maximize();</span><br><span class="line">            browser.get(&quot;https:&#x2F;&#x2F;lspt.court.gov.cn&#x2F;ssoserver&#x2F;login?service&#x3D;https%3A%2F%2Flspt.court.gov.cn%2Fapi%2Fv1%2Flogin%3FredirectUrl%3Dhttps%253A%252F%252Flspt.court.gov.cn%252F&quot;);</span><br><span class="line">            JavascriptExecutor jse &#x3D; (JavascriptExecutor)browser;</span><br><span class="line">            jse.executeScript(&quot;document.getElementById(&#39;captchaImage&#39;).className&#x3D;&#39;&#39;;&quot;);</span><br><span class="line">            WebElement ele &#x3D; browser.findElement(By.xpath(&quot;&#x2F;&#x2F;*[@id&#x3D;\&quot;captchaImage\&quot;]&quot;));</span><br><span class="line">            String img &#x3D; ele.getScreenshotAs(OutputType.BASE64);</span><br><span class="line">            System.out.println(img);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;获取验证码图片&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;import java.awt.image.BufferedImage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import java.io.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import java.util.ArrayList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import java.util.HashMap;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import java.util.List;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import java.util.Map;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import com.alibaba.fastjson.JSONObject;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import lombok.extern.slf4j.Slf4j;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import okhttp3.Response;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import okhttp3.ResponseBody;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.commons.httpclient.HttpClient;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.commons.io.FileUtils;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.HeaderIterator;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.HttpEntity;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.HttpResponse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.HttpStatus;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.NameValuePair;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.ParseException;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.ClientProtocolException;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.CookieStore;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.config.RequestConfig;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.entity.UrlEncodedFormEntity;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.methods.CloseableHttpResponse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.methods.HttpGet;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.methods.HttpPost;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.client.protocol.HttpClientContext;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.cookie.Cookie;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.impl.client.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.impl.cookie.BasicClientCookie;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.message.BasicNameValuePair;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.apache.http.util.EntityUtils;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.openqa.selenium.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.openqa.selenium.chrome.ChromeDriver;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import org.openqa.selenium.chrome.ChromeOptions;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;import javax.imageio.ImageIO;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@Slf4j&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;public class LsptRPA &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	public static void main(String[] args) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.setProperty(&amp;quot;webdriver.chrome.driver&amp;quot;,&amp;quot;C:\\windows\\chromedriver.exe&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#x2F;&amp;#x2F;创建无Chrome无头参数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ChromeOptions chromeOptions&amp;#x3D;new ChromeOptions();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            chromeOptions.addArguments(&amp;quot;-headless&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            WebDriver browser &amp;#x3D; new ChromeDriver(chromeOptions);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            browser.manage().window().maximize();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            browser.get(&amp;quot;https:&amp;#x2F;&amp;#x2F;lspt.court.gov.cn&amp;#x2F;ssoserver&amp;#x2F;login?service&amp;#x3D;https%3A%2F%2Flspt.court.gov.cn%2Fapi%2Fv1%2Flogin%3FredirectUrl%3Dhttps%253A%252F%252Flspt.court.gov.cn%252F&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            JavascriptExecutor jse &amp;#x3D; (JavascriptExecutor)browser;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            jse.executeScript(&amp;quot;document.getElementById(&amp;#39;captchaImage&amp;#39;).className&amp;#x3D;&amp;#39;&amp;#39;;&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            WebElement ele &amp;#x3D; browser.findElement(By.xpath(&amp;quot;&amp;#x2F;&amp;#x2F;*[@id&amp;#x3D;\&amp;quot;captchaImage\&amp;quot;]&amp;quot;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String img &amp;#x3D; ele.getScreenshotAs(OutputType.BASE64);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.out.println(img);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; finally &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium操作webupload进行文件上传</title>
    <link href="https://blog.songuo.tech/p/15032461.html"/>
    <id>https://blog.songuo.tech/p/15032461.html</id>
    <published>2021-03-21T02:00:00.000Z</published>
    <updated>2021-03-31T09:57:30.545Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeOptions;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.datatransfer.StringSelection;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadFileRPA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        webuploader(<span class="string">"E:\\lspt\\f2ud.jpg"</span></span><br><span class="line">                ,<span class="string">"d:\\Users\\Pictures\\banner.jpg"</span></span><br><span class="line">                <span class="comment">//,"E:\\lspt\\临时\\2am7.jpg"</span></span><br><span class="line">                ,<span class="string">"d:\\Users\\Pictures\\view_123.pdf"</span></span><br><span class="line">                ,<span class="string">"E:\\lspt\\0\\2a4c_1616552975916.jpg"</span></span><br><span class="line">                ,<span class="string">"d:/Users/Pictures/view_123.pdf"</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">webuploader</span><span class="params">(String... filePaths)</span></span>&#123;</span><br><span class="line">        System.setProperty(<span class="string">"webdriver.chrome.driver"</span>,<span class="string">"C:\\windows\\chromedriver.exe"</span>);</span><br><span class="line">        <span class="comment">//创建无Chrome无头参数</span></span><br><span class="line">        ChromeOptions chromeOptions=<span class="keyword">new</span> ChromeOptions();</span><br><span class="line">        <span class="comment">//chromeOptions.addArguments("-headless");</span></span><br><span class="line">        WebDriver browser = <span class="keyword">new</span> ChromeDriver(chromeOptions);</span><br><span class="line">        browser.get(<span class="string">"http://fex.baidu.com/webuploader/getting-started.html"</span>);</span><br><span class="line">        WebElement uploaderWE = browser.findElement(By.xpath(<span class="string">"//*[@id=\"picker\"]/div[2]"</span>));</span><br><span class="line">        <span class="keyword">for</span> (String filePath:filePaths) &#123;</span><br><span class="line">            uploaderWE.click();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">                <span class="comment">//指定文件路径</span></span><br><span class="line">                StringSelection sel=<span class="keyword">new</span> StringSelection(filePath);</span><br><span class="line">                <span class="comment">//将图片复制到剪切板上</span></span><br><span class="line">                Toolkit.getDefaultToolkit().getSystemClipboard().setContents(sel, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//新建robot类</span></span><br><span class="line">                Robot robot=<span class="keyword">new</span> Robot();</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                <span class="comment">//按下回车，释放回车，（可有可无，有：选中文件，无：直接将文件路径复制到搜索框里）</span></span><br><span class="line">                robot.keyPress(KeyEvent.VK_ENTER);</span><br><span class="line">                robot.keyRelease(KeyEvent.VK_ENTER);</span><br><span class="line">                <span class="comment">//按下ctril v，拷贝文件</span></span><br><span class="line">                robot.keyPress(KeyEvent.VK_CONTROL);</span><br><span class="line">                robot.keyPress(KeyEvent.VK_V);</span><br><span class="line">                <span class="comment">//释放ctril v</span></span><br><span class="line">                robot.keyRelease(KeyEvent.VK_CONTROL);</span><br><span class="line">                robot.keyRelease(KeyEvent.VK_V);</span><br><span class="line">                <span class="comment">//按下回车，释放回车，确定</span></span><br><span class="line">                robot.keyPress(KeyEvent.VK_ENTER);</span><br><span class="line">                robot.keyRelease(KeyEvent.VK_ENTER);</span><br><span class="line">                robot.delay(<span class="number">500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：文件路径使用反斜杠\进行处理，否则会报错。</p>]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.By;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.WebDriver;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.WebElement;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.chrome.ChromeDriver;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; org.openqa.selenium.chrome.ChromeOptions;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.*;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.datatransfer.StringSelection;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; java.awt.event.KeyEvent;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;UploadFileRPA&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String[] args)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        webuploader(&lt;span class=&quot;string&quot;&gt;&quot;E:\\lspt\\f2ud.jpg&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ,&lt;span class=&quot;string&quot;&gt;&quot;d:\\Users\\Pictures\\banner.jpg&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//,&quot;E:\\lspt\\临时\\2am7.jpg&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ,&lt;span class=&quot;string&quot;&gt;&quot;d:\\Users\\Pictures\\view_123.pdf&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ,&lt;span class=&quot;string&quot;&gt;&quot;E:\\lspt\\0\\2a4c_1616552975916.jpg&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ,&lt;span class=&quot;string&quot;&gt;&quot;d:/Users/Pictures/view_123.pdf&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;webuploader&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String... filePaths)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.setProperty(&lt;span class=&quot;string&quot;&gt;&quot;webdriver.chrome.driver&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;C:\\windows\\chromedriver.exe&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//创建无Chrome无头参数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ChromeOptions chromeOptions=&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeOptions();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//chromeOptions.addArguments(&quot;-headless&quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebDriver browser = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ChromeDriver(chromeOptions);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        browser.get(&lt;span class=&quot;string&quot;&gt;&quot;http://fex.baidu.com/webuploader/getting-started.html&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        WebElement uploaderWE = browser.findElement(By.xpath(&lt;span class=&quot;string&quot;&gt;&quot;//*[@id=\&quot;picker\&quot;]/div[2]&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (String filePath:filePaths) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            uploaderWE.click();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Thread.sleep(&lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//指定文件路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                StringSelection sel=&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; StringSelection(filePath);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//将图片复制到剪切板上&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Toolkit.getDefaultToolkit().getSystemClipboard().setContents(sel, &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//新建robot类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Robot robot=&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Robot();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Thread.sleep(&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//按下回车，释放回车，（可有可无，有：选中文件，无：直接将文件路径复制到搜索框里）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyPress(KeyEvent.VK_ENTER);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyRelease(KeyEvent.VK_ENTER);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//按下ctril v，拷贝文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyPress(KeyEvent.VK_CONTROL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyPress(KeyEvent.VK_V);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//释放ctril v&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyRelease(KeyEvent.VK_CONTROL);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyRelease(KeyEvent.VK_V);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//按下回车，释放回车，确定&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyPress(KeyEvent.VK_ENTER);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.keyRelease(KeyEvent.VK_ENTER);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                robot.delay(&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意：文件路径使用反斜杠\进行处理，否则会报错。&lt;/p&gt;

    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>最高院:2016版民事裁判文书制作规范及样式模板</title>
    <link href="https://blog.songuo.tech/p/3cae6b70.html"/>
    <id>https://blog.songuo.tech/p/3cae6b70.html</id>
    <published>2020-12-30T02:14:00.000Z</published>
    <updated>2020-12-30T01:31:28.662Z</updated>
    
    <content type="html"><![CDATA[<p>最高人民法院关于印发《人民法院民事裁判文书制作规范》《民事诉讼文书样式》的通知</p><p>　　 法〔2016〕221号</p><p>　　各省、自治区、直辖市高级人民法院，解放军军事法院，新疆维吾尔自治区高级人民法院生产建设兵团分院：</p><p>　　为进一步规范和统一民事裁判文书写作标准，提高民事诉讼文书质量，最高人民法院制定了《人民法院民事裁判文书制作规范》《民事诉讼文书样式》。该两份文件已于2016年2月22日经最高人民法院审判委员会第1679次会议通过，现予印发，自2016年8月1日起施行。请认真遵照执行。<a id="more"></a></p><p>　　 最高人民法院</p><p>　 　2016年6月28日</p><p>　　 <strong>人民法院民事裁判文书制作规范</strong></p><p>　　为指导全国法院民事裁判文书的制作，确保文书撰写做到格式统一、要素齐全、结构完整、繁简得当、逻辑严密、用语准确，提高文书质量，制定本规范。</p><p>　　<strong>一、基本要素</strong></p><p>　　文书由标题、正文、落款三部分组成。</p><p>　　标题包括法院名称、文书名称和案号。</p><p>　　正文包括首部、事实、理由、裁判依据、裁判主文、尾部。首部包括诉讼参加人及其基本情况，案件由来和审理经过等;事实包括当事人的诉讼请求、事实和理由，人民法院认定的证据及事实;理由是根据认定的案件事实和法律依据，对当事人的诉讼请求是否成立进行分析评述，阐明理由;裁判依据是人民法院作出裁判所依据的实体法和程序法条文;裁判主文是人民法院对案件实体、程序问题作出的明确、具体、完整的处理决定;尾部包括诉讼费用负担和告知事项。</p><p>　　落款包括署名和日期。</p><p>　　<strong>二、标题</strong></p><p>　　标题由法院名称、文书名称和案号构成，例如：“××××人民法院民事判决书(民事调解书、民事裁定书)+案号”。</p><p>　　(一)法院名称</p><p>　　法院名称一般应与院印的文字一致。基层人民法院、中级人民法院名称前应冠以省、自治区、直辖市的名称，但军事法院、海事法院、铁路运输法院、知识产权法院等专门人民法院除外。</p><p>　　涉外裁判文书，法院名称前一般应冠以“中华人民共和国”国名;案件当事人中如果没有外国人、无国籍人、外国企业或组织的，地方人民法院、专门人民法院制作的裁判文书标题中的法院名称无需冠以“中华人民共和国”。</p><p>　　(二)案号</p><p>　　案号由收案年度、法院代字、类型代字、案件编号组成。</p><p>　　案号=“(”+收案年度+“)”+法院代字+类型代字+案件编号+“号”。</p><p>　　案号的编制、使用应根据《最高人民法院关于人民法院案件案号的若干规定》等执行。</p><p>　　<strong>三、正文</strong></p><p>　　(一)当事人的基本情况</p><p>　　1.当事人的基本情况包括：诉讼地位和基本信息。</p><p>　　2.当事人是自然人的，应当写明其姓名、性别、出生年月日、民族、职业或者工作单位和职务、住所。姓名、性别等身份事项以居民身份证、户籍证明为准。</p><p>　　当事人职业或者工作单位和职务不明确的，可以不表述。</p><p>　　当事人住所以其户籍所在地为准;离开户籍所在地有经常居住地的，经常居住地为住所。连续两个当事人的住所相同的，应当分别表述，不用“住所同上”的表述。</p><p>　　3.有法定代理人或指定代理人的，应当在当事人之后另起一行写明其姓名、性别、职业或工作单位和职务、住所，并在姓名后用括号注明其与当事人的关系。代理人为单位的，写明其名称及其参加诉讼人员的基本信息。</p><p>　　4.当事人是法人的，写明名称和住所，并另起一行写明法定代表人的姓名和职务。当事人是其他组织的，写明名称和住所，并另起一行写明负责人的姓名和职务。</p><p>　　当事人是个体工商户的，写明经营者的姓名、性别、出生年月日、民族、住所;起有字号的，以营业执照上登记的字号为当事人，并写明该字号经营者的基本信息。</p><p>　　当事人是起字号的个人合伙的，在其姓名之后用括号注明“系……(写明字号)合伙人”。</p><p>　　5.法人、其他组织、个体工商户、个人合伙的名称应写全称，以其注册登记文件记载的内容为准。</p><p>　　6.法人或者其他组织的住所是指法人或者其他组织的主要办事机构所在地;主要办事机构所在地不明确的，法人或者其他组织的注册地或者登记地为住所。</p><p>　　7.当事人为外国人的，应当写明其经过翻译的中文姓名或者名称和住所，并用括号注明其外文姓名或者名称和住所。</p><p>　　外国自然人应当注明其国籍。国籍应当用全称。无国籍人，应当注明无国籍。</p><p>　　港澳台地区的居民在姓名后写明“香港特别行政区居民”“澳门特别行政区居民”或“台湾地区居民”。</p><p>　　外国自然人的姓名、性别等基本信息以其护照等身份证明文件记载的内容为准;外国法人或者其他组织的名称、住所等基本信息以其注册登记文件记载的内容为准。</p><p>　　8.港澳地区当事人的住所，应当冠以“香港特别行政区”“澳门特别行政区”。</p><p>　　台湾地区当事人的住所，应当冠以“台湾地区”。</p><p>　　9.当事人有曾用名，且该曾用名与本案有关联的，裁判文书在当事人现用名之后用括号注明曾用名。</p><p>　　诉讼过程中当事人姓名或名称变更的，裁判文书应当列明变更后的姓名或名称，变更前姓名或名称无需在此处列明。对于姓名或者名称变更的事实，在查明事实部分写明。</p><p>　　10.诉讼过程中，当事人权利义务继受人参加诉讼的，诉讼地位从其承继的诉讼地位。裁判文书中，继受人为当事人;被继受人在当事人部分不写，在案件由来中写明继受事实。</p><p>　　11.在代表人诉讼中，被代表或者登记权利的当事人人数众多的，可以采取名单附后的方式表述，“原告×××等×人(名单附后)”。</p><p>　　当事人自行参加诉讼的，要写明其诉讼地位及基本信息。</p><p>　　12.当事人诉讼地位在前，其后写当事人姓名或者名称，两者之间用冒号。当事人姓名或者名称之后，用逗号。</p><p>　　(二)委托诉讼代理人的基本情况</p><p>　　1.当事人有委托诉讼代理人的，应当在当事人之后另起一行写明为“委托诉讼代理人”，并写明委托诉讼代理人的姓名和其他基本情况。有两个委托诉讼代理人的，分行分别写明。</p><p>　　2.当事人委托近亲属或者本单位工作人员担任委托诉讼代理人的，应当列在第一位，委托外单位的人员或者律师等担任委托诉讼代理人的列在第二位。</p><p>　　3.当事人委托本单位人员作为委托诉讼代理人的，写明姓名、性别及其工作人员身份。其身份信息可表述为“该单位(如公司、机构、委员会、厂等)工作人员”。</p><p>　　4.律师、基层法律服务工作者担任委托诉讼代理人的，写明律师、基层法院法律服务工作者的姓名，所在律师事务所的名称、法律服务所的名称及执业身份。其身份信息表述为“××律师事务所律师”“××法律服务所法律工作者”。属于提供法律援助的，应当写明法律援助情况。</p><p>　　5.委托诉讼代理人是当事人近亲属的，应当在姓名后用括号注明其与当事人的关系，写明住所。代理人是当事人所在社区、单位以及有关社会团体推荐的公民的，写明姓名、性别、住所，并在住所之后注明具体由何社区、单位、社会团体推荐。</p><p>　　6.委托诉讼代理人变更的，裁判文书首部只列写变更后的委托诉讼代理人。对于变更的事实可根据需要写明。</p><p>　　7.委托诉讼代理人后用冒号，再写委托诉讼代理人姓名。委托诉讼代理人姓名后用逗号。</p><p>　　(三)当事人的诉讼地位</p><p>　　1.一审民事案件当事人的诉讼地位表述为“原告”“被告”和“第三人”。先写原告，后写被告，再写第三人。有多个原告、被告、第三人的，按照起诉状列明的顺序写。起诉状中未列明的当事人，按照参加诉讼的时间顺序写。</p><p>　　提出反诉的，需在本诉称谓后用括号注明反诉原告、反诉被告。反诉情况在案件由来和事实部分写明。</p><p>　　2.二审民事案件当事人的诉讼地位表述为“上诉人”“被上诉人”“第三人”“原审原告”“原审被告”“原审第三人”。先写上诉人，再写被上诉人，后写其他当事人。其他当事人按照原审诉讼地位和顺序写明。被上诉人也提出上诉的，列为“上诉人”。</p><p>　　上诉人和被上诉人之后，用括号注明原审诉讼地位。</p><p>　　3.再审民事案件当事人的诉讼地位表述为“再审申请人”“被申请人”。其他当事人按照原审诉讼地位表述，例如，一审终审的，列为“原审原告”“原审被告”“原审第三人”;二审终审的，列为“二审上诉人”“二审被上诉人”等。</p><p>　　再审申请人、被申请人和其他当事人诉讼地位之后，用括号注明一审、二审诉讼地位。</p><p>　　抗诉再审案件(再审检察建议案件)，应当写明抗诉机关(再审检察建议机关)及申诉人与被申诉人的诉讼地位。案件由来部分写明检察机关出庭人员的基本情况。对于检察机关因国家利益、社会公共利益受损而依职权启动程序的案件，应列明当事人的原审诉讼地位。</p><p>　　4.第三人撤销之诉案件，当事人的诉讼地位表述为“原告”“被告”“第三人”。“被告”之后用括号注明原审诉讼地位。</p><p>　　5.执行异议之诉案件，当事人的诉讼地位表述为“原告”“被告”“第三人”，并用括号注明当事人在执行异议程序中的诉讼地位。</p><p>　　6.特别程序案件，当事人的诉讼地位表述为“申请人”。有被申请人的，应当写明被申请人。</p><p>　　选民资格案件，当事人的诉讼地位表述为“起诉人”。</p><p>　　7.督促程序案件，当事人的诉讼地位表述为“申请人”“被申请人”。</p><p>　　公示催告程序案件，当事人的诉讼地位表述为“申请人”;有权利申报人的，表述为“申报人”。申请撤销除权判决的案件，当事人表述为“原告”“被告”。</p><p>　　8.保全案件，当事人的诉讼地位表述为“申请人”“被申请人”。</p><p>　　9.复议案件，当事人的诉讼地位表述为“复议申请人”“被申请人”。</p><p>　　10.执行案件，执行实施案件，当事人的诉讼地位表述为“申请执行人”“被执行人”。</p><p>　　执行异议案件，提出异议的当事人或者利害关系人的诉讼地位表述为“异议人”，异议人之后用括号注明案件当事人或利害关系人，其他未提出异议的当事人亦应分别列明。</p><p>　　案外人异议案件，当事人的诉讼地位表述为“案外人”“申请执行人”“被执行人”。</p><p>　　(四)案件由来和审理经过</p><p>　　1.案件由来部分简要写明案件名称与来源。</p><p>　　2.案件名称是当事人与案由的概括。民事一审案件名称表述为“原告×××与被告×××……(写明案由)一案”。</p><p>　　诉讼参加人名称过长的，可以在案件由来部分第一次出现时用括号注明其简称，表述为“(以下简称×××)”。裁判文书中其他单位或组织名称过长的，也可在首次表述时用括号注明其简称。</p><p>　　诉讼参加人的简称应当规范，需能够准确反映其名称的特点。</p><p>　　3.案由应当准确反映案件所涉及的民事法律关系的性质，符合最高人民法院有关民事案件案由的规定。</p><p>　　经审理认为立案案由不当的，以经审理确定的案由为准，但应在本院认为部分予以说明。</p><p>　　4.民事一审案件来源包括：</p><p>　　(1)新收;</p><p>　　(2)有新的事实、证据重新起诉;</p><p>　　(3)上级人民法院发回重审;</p><p>　　(4)上级人民法院指令立案受理;</p><p>　　(5)上级人民法院指定审理;</p><p>　　(6)上级人民法院指定管辖;</p><p>　　(7)其他人民法院移送管辖;</p><p>　　(8)提级管辖。</p><p>　　5.书写一审案件来源的总体要求是：</p><p>　　(1)新收、重新起诉的，应当写明起诉人;</p><p>　　(2)上级法院指定管辖、本院提级管辖的，除应当写明起诉人外，还应写明报请上级人民法院指定管辖(报请移送上级人民法院)日期或者下级法院报请指定管辖(下级法院报请移送)日期，以及上级法院或者本院作出管辖裁定日期;</p><p>　　(3)上级法院发回重审、上级法院指令受理、上级法院指定审理、移送管辖的，应当写明原审法院作出裁判的案号及日期，上诉人，上级法院作出裁判的案号及日期、裁判结果，说明引起本案的起因。</p><p>　　6.一审案件来源为上级人民法院发回重审的，发回重审的案件应当写明“原告×××与被告×××……(写明案由)一案，本院于××××年××月××日作出……(写明案号)民事判决。×××不服该判决，向××××法院提起上诉。××××法院于××××年××月××日作出……(写明案号)裁定，发回重审。本院依法另行组成合议庭……”。</p><p>　　7.审理经过部分应写明立案日期及庭审情况。</p><p>　　8.立案日期表述为：“本院于××××年××月××日立案后”。</p><p>　　9.庭审情况包括适用程序、程序转换、审理方式、参加庭审人员等。</p><p>　　10.适用程序包括普通程序、简易程序、小额诉讼程序和非讼程序。</p><p>　　非讼程序包括特别程序、督促程序、公示催告程序等。</p><p>　　11.民事一审案件由简易程序(小额诉讼程序)转为普通程序的，审理经过表述为：“于××××年××月××日公开/因涉及……不公开(写明不公开开庭的理由)开庭审理了本案，经审理发现有不宜适用简易程序(小额诉讼程序)的情形，裁定转为普通程序，于××××年××月××日再次公开/不公开开庭审理了本案”。</p><p>　　12.审理方式包括开庭审理和不开庭审理。开庭审理包括公开开庭和不公开开庭。</p><p>　　不公开开庭的情形包括：</p><p>　　(1)因涉及国家秘密不公开开庭;</p><p>　　(2)因涉及个人隐私不公开开庭;</p><p>　　(3)因涉及商业秘密，经当事人申请，决定不公开开庭;</p><p>　　(4)因离婚，经当事人申请，决定不公开开庭;</p><p>　　(5)法律另有规定的。</p><p>　　13.开庭审理的应写明当事人出庭参加诉讼情况(包括未出庭或者中途退庭情况);不开庭的，不写。不开庭审理的，应写明不开庭的原因。</p><p>　　14.当事人未到庭应诉或者中途退庭的，写明经传票传唤，无正当理由拒不到庭或者未经法庭许可中途退庭的情况。</p><p>　　15.一审庭审情况表述为：“本院于××××年××月××日公开/因涉及……(写明不公开开庭的理由)不公开开庭审理了本案，原告×××及其诉讼代理人×××，被告×××及其诉讼代理人×××等到庭参加诉讼。”</p><p>　　16.对于审理中其他程序性事项，如中止诉讼情况应当写明。对中止诉讼情形，表述为：“因……(写明中止诉讼事由)，于××××年××月××日裁定中止诉讼，××××年××月××日恢复诉讼。”</p><p>　　(五)事实</p><p>　　1.裁判文书的事实主要包括：原告起诉的诉讼请求、事实和理由，被告答辩的事实和理由，法院认定的事实和据以定案的证据。</p><p>　　2.事实首先写明当事人的诉辩意见。按照原告、被告、第三人的顺序依次表述当事人的起诉意见、答辩意见、陈述意见。诉辩意见应当先写明诉讼请求，再写事实和理由。</p><p>　　二审案件先写明当事人的上诉请求等诉辩意见。然后再概述一审当事人的诉讼请求，人民法院认定的事实、裁判理由、裁判结果。</p><p>　　再审案件应当先写明当事人的再审请求等诉辩意见，然后再简要写明原审基本情况。生效判决为一审判决的，原审基本情况应概述一审诉讼请求、法院认定的事实、裁判理由和裁判结果;生效判决为二审判决的，原审基本情况先概述一审诉讼请求、法院认定的事实和裁判结果，再写明二审上诉请求、认定的事实、裁判理由和裁判结果。</p><p>　　3.诉辩意见不需原文照抄当事人的起诉状或答辩状、代理词内容或起诉、答辩时提供的证据，应当全案考虑当事人在法庭上的诉辩意见和提供的证据综合表述。</p><p>　　4.当事人在法庭辩论终结前变更诉讼请求或者提出新的请求的，应当在诉称部分中写明。</p><p>　　5.被告承认原告主张的全部事实的，写明“×××承认×××主张的事实”。被告承认原告主张的部分事实的，写明“×××承认×××主张的……事实”。</p><p>　　被告承认全部诉讼请求的，写明：“×××承认×××的全部诉讼请求”。被告承认部分诉讼请求的，写明被告承认原告的部分诉讼请求的具体内容。</p><p>　　6.在诉辩意见之后，另起一段简要写明当事人举证、质证的一般情况，表述为：“本案当事人围绕诉讼请求依法提交了证据，本院组织当事人进行了证据交换和质证。”</p><p>　　7.当事人举证质证一般情况后直接写明人民法院对证据和事实的认定情况。对当事人所提交的证据原则上不一一列明，可以附录全案证据或者证据目录。</p><p>　　对当事人无争议的证据，写明“对当事人无异议的证据，本院予以确认并在卷佐证”。对有争议的证据，应当写明争议的证据名称及人民法院对争议证据认定的意见和理由;对有争议的事实，应当写明事实认定意见和理由。</p><p>　　8.对于人民法院调取的证据、鉴定意见，经庭审质证后，按照当事人是否有争议分别写明。对逾期提交的证据、非法证据等不予采纳的，应当说明理由。</p><p>　　9.争议证据认定和事实认定，可以合并写，也可以分开写。分开写的，在证据的审查认定之后，另起一段概括写明法院认定的基本事实，表述为：“根据当事人陈述和经审查确认的证据，本院认定事实如下：……”。</p><p>　　10.认定的事实，应当重点围绕当事人争议的事实展开。按照民事举证责任分配和证明标准，根据审查认定的证据有无证明力、证明力大小，对待证事实存在与否进行认定。要说明事实认定的结果、认定的理由以及审查判断证据的过程。</p><p>　　11.认定事实的书写方式应根据案件的具体情况，层次清楚，重点突出，繁简得当，避免遗漏与当事人争议有关的事实。一般按时间先后顺序叙述，或者对法律关系或请求权认定相关的事实着重叙述，对其他事实则可归纳、概括叙述。</p><p>　　综述事实时，可以划分段落层次，亦可根据情况以“另查明”为引语叙述其他相关事实。</p><p>　　12.召开庭前会议时或者在庭审时归纳争议焦点的，应当写明争议焦点。争议焦点的摆放位置，可以根据争议的内容处理。争议焦点中有证据和事实内容的，可以在当事人诉辩意见之后在当事人争议的证据和事实中写明。争议焦点主要是法律适用问题的，可以在本院认为部分，先写明争议焦点。</p><p>　　13.适用外国法的，应当叙述查明外国法的事实。</p><p>　　(六)理由</p><p>　　1.理由部分的核心内容是针对当事人的诉讼请求，根据认定的案件事实，依照法律规定，明确当事人争议的法律关系，阐述原告请求权是否成立，依法应当如何处理。裁判文书说理要做到论理透彻，逻辑严密，精炼易懂，用语准确。</p><p>　　2.理由部分以“本院认为”作为开头，其后直接写明具体意见。</p><p>　　3.理由部分应当明确纠纷的性质、案由。原审确定案由错误，二审或者再审予以改正的，应在此部分首先进行叙述并阐明理由。</p><p>　　4.说理应当围绕争议焦点展开，逐一进行分析论证，层次明确。对争议的法律适用问题，应当根据案件的性质、争议的法律关系、认定的事实，依照法律、司法解释规定的法律适用规则进行分析，作出认定，阐明支持或不予支持的理由。</p><p>　　5.争议焦点之外，涉及当事人诉讼请求能否成立或者与本案裁判结果有关的问题，也应在说理部分一并进行分析论证。</p><p>　　6.理由部分需要援引法律、法规、司法解释时，应当准确、完整地写明规范性法律文件的名称、条款项序号和条文内容，不得只引用法律条款项序号，在裁判文书后附相关条文。引用法律条款中的项的，一律使用汉字不加括号，例如：“第一项”。</p><p>　　7.正在审理的案件在基本案情和法律适用方面与最高人民法院颁布的指导性案例相类似的，应当将指导性案例作为裁判理由引述，并写明指导性案例的编号和裁判要点。</p><p>　　8.司法指导性文件体现的原则和精神，可在理由部分予以阐述或者援引。</p><p>　　9.在说理最后，可以另起一段，以“综上所述”引出，对当事人的诉讼请求是否支持进行评述。</p><p>　　(七)裁判依据</p><p>　　1.引用法律、法规、司法解释时，应当严格适用《最高人民法院关于裁判文书引用法律、法规等规范性法律文件的规定》。</p><p>　　2.引用多个法律文件的，顺序如下：法律及法律解释、行政法规、地方性法规、自治条例或者单行条例、司法解释;同时引用两部以上法律的，应当先引用基本法律，后引用其他法律;同时引用实体法和程序法的，先引用实体法，后引用程序法。</p><p>　　3.确需引用的规范性文件之间存在冲突，根据《中华人民共和国立法法》等有关法律规定无法选择适用的，应依法提请有决定权的机关作出裁决，不得自行在裁判文书中认定相关规范性法律文件的效力。</p><p>　　4.裁判文书不得引用宪法和各级人民法院关于审判工作的指导性文件、会议纪要、各审判业务庭的答复意见以及人民法院与有关部门联合下发的文件作为裁判依据，但其体现的原则和精神可以在说理部分予以阐述。</p><p>　　5.引用最高人民法院的司法解释时，应当按照公告公布的格式书写。</p><p>　　6.指导性案例不作为裁判依据引用。</p><p>　　(八)裁判主文</p><p>　　1.裁判主文中当事人名称应当使用全称。</p><p>　　2.裁判主文内容必须明确、具体、便于执行。</p><p>　　3.多名当事人承担责任的，应当写明各当事人承担责任的形式、范围。</p><p>　　4.有多项给付内容的，应当先写明各项目的名称、金额，再写明累计金额。如：“交通费……元、误工费……元、……，合计……元”。</p><p>　　5.当事人互负给付义务且内容相同的，应当另起一段写明抵付情况。</p><p>　　6.对于金钱给付的利息，应当明确利息计算的起止点、计息本金及利率。</p><p>　　7.一审判决未明确履行期限的，二审判决应当予以纠正。</p><p>　　判决承担利息，当事人提出具体请求数额的，二审法院可以根据当事人请求的数额作出相应判决;当事人没有提出具体请求数额的，可以表述为“按×××利率，自××××年××月××日起计算至××××年××月××日止”。</p><p>　　(九)尾部</p><p>　　1.尾部应当写明诉讼费用的负担和告知事项。</p><p>　　2.诉讼费用包括案件受理费和其他诉讼费用。收取诉讼费用的，写明诉讼费用的负担情况。如：“案件受理费……元，由……负担;申请费……元，由……负担”。</p><p>　　3.诉讼费用不属于诉讼争议的事项，不列入裁判主文，在判决主文后另起一段写明。</p><p>　　4.一审判决中具有金钱给付义务的，应当在所有判项之后另起一行写明：“如果未按本判决指定的期间履行给付金钱义务，应当依照《中华人民共和国民事诉讼法》第二百五十三条的规定，加倍支付迟延履行期间的债务利息。”二审判决具有金钱给付义务的，属于二审改判的，无论一审判决是否写入了上述告知内容，均应在所有判项之后另起一行写明上述告知内容。二审维持原判的判决，如果一审判决已经写明上述告知内容，可不再重复告知。</p><p>　　5.对依法可以上诉的一审判决，在尾部表述为：“如不服本判决，可以在判决书送达之日起十五日内，向本院递交上诉状，并按对方当事人的人数或者代表人的人数提出副本，上诉于××××人民法院。”</p><p>　　6.对一审不予受理、驳回起诉、管辖权异议的裁定，尾部表述为：“如不服本裁定，可以在裁定书送达之日起十日内，向本院递交上诉状，并按对方当事人的人数或者代表人的人数提出副本，上诉于××××人民法院。”</p><p>　　<strong>四、落款</strong></p><p>　　(一)署名</p><p>　　诉讼文书应当由参加审判案件的合议庭组成人员或者独任审判员署名。</p><p>　　合议庭的审判长，不论审判职务，均署名为“审判长”;合议庭成员有审判员的，署名为“审判员”;有助理审判员的，署名为“代理审判员”;有陪审员的，署名为“人民陪审员”。独任审理的，署名为“审判员”或者“代理审判员”。书记员，署名为“书记员”。</p><p>　　(二)日期</p><p>　　裁判文书落款日期为作出裁判的日期，即裁判文书的签发日期。当庭宣判的，应当写宣判的日期。</p><p>　　(三)核对戳</p><p>　　本部分加盖“本件与原本核对无异”字样的印戳。</p><p>　　<strong>五、数字用法</strong></p><p>　　(一)裁判主文的序号使用汉字数字，例：“一”“二”;</p><p>　　(二)裁判尾部落款时间使用汉字数字，例：“二〇一六年八月二十九日”;</p><p>　　(三)案号使用阿拉伯数字，例：“(2016)京0101民初1号”;</p><p>　　(四)其他数字用法按照《中华人民共和国国家标准GB/T15835-2011出版物上数字用法》执行。</p><p>　　<strong>六、标点符号用法</strong></p><p>　　(一)“被告辩称”“本院认为”等词语之后用逗号。</p><p>　　(二)“×××向本院提出诉讼请求”“本院认定如下”“判决如下”“裁定如下”等词语之后用冒号。</p><p>　　(三)裁判项序号后用顿号。</p><p>　　(四)除本规范有明确要求外，其他标点符号用法按照《中华人民共和国国家标准GB/T15834-2011标点符号用法》执行。</p><p>　　<strong>七、引用规范</strong></p><p>　　(一)引用法律、法规、司法解释应书写全称并加书名号。</p><p>　　(二)法律全称太长的，也可以简称，简称不使用书名号。可以在第一次出现全称后使用简称，例：“《中华人民共和国民事诉讼法》(以下简称民事诉讼法)”。</p><p>　　(三)引用法律、法规和司法解释条文有序号的，书写序号应与法律、法规和司法解释正式文本中的写法一致。</p><p>　　(四)引用公文应先用书名号引标题，后用圆括号引发文字号;引用外文应注明中文译文。</p><p>　　<strong>八、印刷标准</strong></p><p>　　(一)纸张标准，A4型纸，成品幅面尺寸为：210mm×297mm。</p><p>　　(二)版心尺寸为：156mm×225mm，一般每面排22行，每行排28个字。</p><p>　　(三)采用双面印刷;单页页码居右，双页页码居左;印品要字迹清楚、均匀。</p><p>　　(四)标题位于版心下空两行，居中排布。标题中的法院名称和文书名称一般用二号小标宋体字;标题中的法院名称与文书名称分两行排列。</p><p>　　(五)案号之后空二个汉字空格至行末端。</p><p>　　(六)案号、主文等用三号仿宋体字。</p><p>　　(七)落款与正文同处一面。排版后所剩空白处不能容下印章时，可以适当调整行距、字距，不用“此页无正文”的方法解决。审判长、审判员每个字之间空二个汉字空格。审判长、审判员与姓名之间空三个汉字空格，姓名之后空二个汉字空格至行末端。</p><p>　　(八)院印加盖在日期居中位置。院印上不压审判员，下不压书记员，下弧骑年压月在成文时间上。印章国徽底边缘及上下弧以不覆盖文字为限。公章不应歪斜、模糊。</p><p>　　(九)凡裁判文书中出现误写、误算，诉讼费用漏写、误算和其他笔误的，未送达的应重新制作，已送达的应以裁定补正，避免使用校对章。</p><p>　　(十)确需加装封面的应印制封面。封面可参照以下规格制作：</p><p>　　1.国徽图案高55mm，宽50mm。</p><p>　　2.上页边距为65mm，国徽下沿与标题文字上沿之间距离为75mm。</p><p>　　3.标题文字为“××××人民法院××判决书(或裁定书等)”，位于国徽图案下方，字体为小标宋体字;标题分两行或三行排列，法院名称字体大小为30磅，裁判文书名称字体大小为36磅。</p><p>　　4.封面应庄重、美观，页边距、字体大小及行距可适当进行调整。</p><p>　　<strong>九、其他</strong></p><p>　　(一)本规范可以适用于人民法院制作的其他诉讼文书，根据具体文书性质和内容作相应调整。</p><p>　　(二)本规范关于裁判文书的要素和文书格式、标点符号、数字使用、印刷规范等技术化标准，各级人民法院应当认真执行。对于裁判文书正文内容、事实认定和说理部分，可以根据案件的情况合理确定。</p><p>　　(三)逐步推行裁判文书增加二维条形码，增加裁判文书的可识别性。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最高人民法院关于印发《人民法院民事裁判文书制作规范》《民事诉讼文书样式》的通知&lt;/p&gt;
&lt;p&gt;　　 法〔2016〕221号&lt;/p&gt;
&lt;p&gt;　　各省、自治区、直辖市高级人民法院，解放军军事法院，新疆维吾尔自治区高级人民法院生产建设兵团分院：&lt;/p&gt;
&lt;p&gt;　　为进一步规范和统一民事裁判文书写作标准，提高民事诉讼文书质量，最高人民法院制定了《人民法院民事裁判文书制作规范》《民事诉讼文书样式》。该两份文件已于2016年2月22日经最高人民法院审判委员会第1679次会议通过，现予印发，自2016年8月1日起施行。请认真遵照执行。
    
    </summary>
    
    
      <category term="法律知识" scheme="https://blog.songuo.tech/categories/%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="法院" scheme="https://blog.songuo.tech/tags/%E6%B3%95%E9%99%A2/"/>
    
      <category term="文书" scheme="https://blog.songuo.tech/tags/%E6%96%87%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>【民事诉讼指南】案件的审理期限和审限的计算</title>
    <link href="https://blog.songuo.tech/p/e8dcab84.html"/>
    <id>https://blog.songuo.tech/p/e8dcab84.html</id>
    <published>2020-12-07T07:14:00.000Z</published>
    <updated>2020-12-30T01:31:28.689Z</updated>
    
    <content type="html"><![CDATA[<p>（一）案件的审理期限</p><p>1.普通程序案件</p><p><strong>《中华人民共和国民事诉讼法》第一百四十九条</strong> 法院适用普通程序审理的案件，应当在立案之日起六个月内审结。有特殊情况需要延长的，由本院院长批准，可以延长六个月；还需要延长的，报请上级法院批准。</p><p><strong>《中华人民共和国民事诉讼法》第一百七十六条</strong> 法院审理对判决的上诉案件，应当在第二审立案之日起三个月内审结。有特殊情况需要延长的，由本院院长批准。</p><p>法院审理对裁定的上诉案件，应当在第二审立案之日起三十日内作出终审裁定。</p><p>2.简易程序案件</p><p><strong>《中华人民共和国民事诉讼法》第一百六十一条</strong> 法院适用简易程序审理案件，应当在立案之日起三个月内审结。</p><p>3.特别程序案件</p><p><strong>《中华人民共和国民事诉讼法》第一百八十条</strong> 法院适用特别程序审理的案件，应当在立案之日起三十日内或者公告期满后三十日内审结。有特殊情况需要延长的，由法院院长批准。但审理选民资格案件除外。</p><p>4.审判监督案件</p><p>通过审判监督程序再审的案件按照第一审程序或者第二审程序审理的，适用《中华人民共和国民事诉讼法》第一百四十九条、第一百七十六条规定的审限。审限自决定再审的次日起计算。</p><p>5.涉外民事案件</p><p><strong>《中华人民共和国民事诉讼法》第二百七十条</strong> 法院审理涉外民事案件的期间，不受本法第一百四十九条、第一百七十六条规定的限制。</p><p>（二）案件审限的计算</p><p>案件的审限从立案次日开始计算，至结案之日截止。</p><p>下列期间不计入审限:1.刑事案件对被告人精神病等进行专业鉴定的期间；</p><p>2.刑事案件因另行委托、指定辩护人，法院决定延期审理的，自案件宣布延期审理之日起至第十日止准备辩护的期间；</p><p>3.合议庭成员、检察员等相关人员发现案件需要补充侦查，提出延期审理建议，法院同意延期审理的期间；</p><p>4.刑事案件因当事人、诉讼代理人、辩护人申请通知新的证人到庭、调取新的证据、申请重新鉴定或者勘验，法院决定延期一个月的期间；</p><p>5.刑事案件二审期间，检察院查阅案卷超过七日后的期间；</p><p>6.审理当事人提出的管辖权异议和处理法院之间的管辖争议的期间；</p><p>\7. 民事、行政案件公告、鉴定的期间；</p><p>\8. 民事、行政、执行案件由有关专业机构进行审计、评估、资产清理的期间；</p><p>\9. 中止诉讼（审理）或执行至恢复诉讼（审理）或执行的期间；</p><p>10.审限届满前，当事人申请调解的案件，从申请之日起三十日的调解期间；</p><p>11.执行中拍卖、变卖被查封、冻结、扣押财产的期间；</p><p>12.当事人达成执行和解协议或者提交执行担保后，执行法院决定暂缓执行的期间；</p><p>13.申诉、申请再审案件和国家赔偿确认案件的调卷期间；</p><p>14.上级法院通知暂缓执行的期间；</p><p>15.向上级法院或单位请示、协调、报请复核的期间；</p><p>16.其他可以不计入审限的期间。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;（一）案件的审理期限&lt;/p&gt;
&lt;p&gt;1.普通程序案件&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;《中华人民共和国民事诉讼法》第一百四十九条&lt;/strong&gt; 法院适用普通程序审理的案件，应当在立案之日起六个月内审结。有特殊情况需要延长的，由本院院长批准，可以延长六个月；还需要延长的，报请上级法院批准。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;《中华人民共和国民事诉讼法》第一百七十六条&lt;/strong&gt; 法院审理对判决的上诉案件，应当在第二审立案之日起三个月内审结。有特殊情况需要延长的，由本院院长批准。&lt;/p&gt;
&lt;p&gt;法院审理对裁定的上诉案件，应当在第二审立案之日起三十日内作出终审裁定。&lt;/p&gt;
&lt;p&gt;2.简易程序案件&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;《中华人民共和国民事诉讼法》第一百六十一条&lt;/strong&gt; 法院适用简易程序审理案件，应当在立案之日起三个月内审结。&lt;/p&gt;
&lt;p&gt;3.特别程序案件&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;《中华人民共和国民事诉讼法》第一百八十条&lt;/strong&gt; 法院适用特别程序审理的案件，应当在立案之日起三十日内或者公告期满后三十日内审结。有特殊情况需要延长的，由法院院长批准。但审理选民资格案件除外。&lt;/p&gt;
&lt;p&gt;4.审判监督案件&lt;/p&gt;
    
    </summary>
    
    
      <category term="法律知识" scheme="https://blog.songuo.tech/categories/%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="法院" scheme="https://blog.songuo.tech/tags/%E6%B3%95%E9%99%A2/"/>
    
      <category term="民诉法" scheme="https://blog.songuo.tech/tags/%E6%B0%91%E8%AF%89%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>doc/docx转html</title>
    <link href="https://blog.songuo.tech/p/dc0fda17.html"/>
    <id>https://blog.songuo.tech/p/dc0fda17.html</id>
    <published>2020-12-03T02:30:00.000Z</published>
    <updated>2020-12-03T07:38:33.246Z</updated>
    
    <content type="html"><![CDATA[<p>在一些特殊场景下，我们要使用word模板，来规范文档格式，然而我们无法使用富文本编辑器来实现和word模板一样的样式，这样的工作量是非常繁重的。</p><p>所以，在需要使用到word模板时，我们可以先讲word转换为html之后，将html拼接完整，将文件名修改为doc文件即可保留word原格式输出。</p><p>word转html可使用腾讯企业有限，点击【写信】，将word复制到内容区域，点击【<HTML>】,则切换到html代码视图下，将视图下代码copy保存到，html的body区域中，保存，然后将html文件修改为doc/docx后缀文件。使用office打开即可看到文档保留了原格式。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在一些特殊场景下，我们要使用word模板，来规范文档格式，然而我们无法使用富文本编辑器来实现和word模板一样的样式，这样的工作量是非常繁重的。&lt;/p&gt;
&lt;p&gt;所以，在需要使用到word模板时，我们可以先讲word转换为html之后，将html拼接完整，将文件名修改为doc文件即可保留word原格式输出。&lt;/p&gt;
&lt;p&gt;word转html可使用腾讯企业有限，点击【写信】，将word复制到内容区域，点击【&lt;html&gt;】,则切换到html代码视图下，将视图下代码copy保存到，html的body区域中，保存，然后将html文件修改为doc/docx后缀文件。使用office打开即可看到文档保留了原格式。&lt;/html&gt;&lt;/p&gt;

    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="doc转html" scheme="https://blog.songuo.tech/tags/doc%E8%BD%AChtml/"/>
    
  </entry>
  
  <entry>
    <title>反思与再造：证据交换制度在互联网庭审中的应用研究</title>
    <link href="https://blog.songuo.tech/p/8a16fb43.html"/>
    <id>https://blog.songuo.tech/p/8a16fb43.html</id>
    <published>2020-11-07T03:14:00.000Z</published>
    <updated>2020-11-07T03:13:38.918Z</updated>
    
    <content type="html"><![CDATA[<p><strong>反思与再造：证据交换制度在互联网庭审中的应用研究</strong></p><p>科学技术的迅猛发展使得整个世界形成了一个扁平化、虚拟化的信息时代，信息技术推动着这个社会从生产工具到生产关系的巨大变革，渗透、辐射到各个领域。 人们将社会生活的方方面面慢慢从实体转向了虚拟，从线下转向了线上，由此所产生的人们对司法运行模式的多元化、简洁化、精确化的需求日益更甚。2017年8月中国第一家互联网法院的揭牌就是顺应时代的需求、当事人的需求而创造出的成果，由此带来的对民事诉讼制度的挑战不容忽视。目前C市P区人民法院在S省、C市三级法院的大力支持下正在紧锣密鼓的筹备C市P区法院互联网法庭，作者作为本次互联网法庭建设的工作人员，全程参与互联网法庭的建设、测试工作，亲身体验网上诉讼的全部流程，不断改进创新网上诉讼流程，作为初步的研究，本文是对民事诉讼中的证据交换制度在互联网庭审中的运用之探析。</p><p>一、梳理与检视：互联网庭审面临的现实难题</p><p>互联网庭审不同于一般的网络庭审。目前我们所称的网络庭审是指“网络庭审直播”。即，将审理案件的过程通过网络媒介平台同步制作和发布图文、视频信息，是一种便于公众在第一时间了解庭审现状的双向互动直播模式。与新闻媒体片段化的记录、报导不同，“网络庭审直播”呈现出公开性、完整性和及时性的特点。庭审过程的可视化、审判流程公开、裁判文书公开、执行信息公开，让当事人迅速了解案件的进程，使“程序正义”在案件审理中得以真正实现。互联网庭审则是基于互联网法院管辖网络空间发生的各类案件并且审判活动全程在网上实现的庭审过程。具体而言，原、被告双方在不到实体法庭的情况下直接通过网络视频方式开庭的庭审模式，当事人无需踏进法院，便可实现诉讼全程在线化，大大提升了司法质效、为当事人带来了极大的便利，更为重要的是进一步推进网络空间的法治化。</p><p>（一）互联网庭审的快速、便捷、高效与庭审程序法定性、程序正义的冲突</p><p>习惯于“快餐式”网络交易的当事人，希望诉讼也能够尽可能通过简化诉讼程序、优化程序规则、缩短诉讼流程的方式，快速、便捷、高效的得以解决。这就要求互联网庭审程序尽可能简单、快速、流畅，但是庭审程序、规则的法定性以及当事人诉讼权利的保护等问题都是程序正义的必然要求，即使是互联网庭审程序再造，也不能损害当事人的合法权益、违反诉讼法的强制性规定。笔者通过S省法院庭审直播网的100件网络直播庭审案件分析，从审判员宣布开庭到原告宣读起诉状之前的程序处理平均用时7分43秒，证据交换程序平均耗时17分4秒。可见，程序的处理以及证据交换需要花费大量的庭审时间。</p><p>（二）“互联网庭审”以适用简易程序为主的“简单”案件与“证据交换制度”实践中普遍适用于普通程序为主的“重大、疑难、复杂”案件的冲突</p><p>目前互联网庭审主要是适用简易程序，由审判员独任审理，这是《民事诉讼法》的基本要求。《民诉法解释》第259条规定，开庭方式可由当事人申请，法院决定。“视听传输技术”等其他方式开庭的，须经双方当事人许可。互联网法院网上开庭的依据来源于此。笔者从杭州互联网法院微信诉讼平台“阳光司法”项下公开的庭审视频中99.4%适用简易程序审理，笔者随机点击的100个案件的庭审视频的平均开庭时长为26分钟。对于适用普通程序的案件，在技术上还存在部分障碍。例如《民诉法解释》第227 条规定， 诉讼代理人、证人、鉴定人、翻译人员、勘验人是应当到庭参加诉讼的。就目前P区法院互联网法庭的构建情况来看存在部分技术障碍，如电脑、手机或者平板电脑的尺寸使得原告、被告、证人、鉴定人、勘验人、翻译人员等同时开设庭审窗口受到限制，在笔者与技术人员沟通中发现，一个屏幕在保证庭审程序顺利进行的前提下 能够允许开设的视频窗口数量是受到很大限制的。</p><p>根据最高人民法院颁布的《关于民事诉讼证据的若干规定》（以下简称《证据规定》）第三十七条 ，证据交换可以由当事人申请，法院在开庭审理前进行。法院对证据较多或复杂疑难的案件，应当组织当事人在答辩期届满后、开庭审理前交换证据。该条款明确了证据交换的启动包括当事人申请和法院依职权确定两种方式。当事人申请方式对当事人的法律素养、专业能力等要求较高，一般适用于当事人有专业委托代理人的情况下。此外对于当事人的申请，法院是可以而不是应当组织当事人交换证据，对此法院享有审查权和最终决定权。从该条第二款可以看出审查的依据则是证据较多或复杂疑难案件。故而，证据交换制度的适用范围可以确定为：证据较多或复杂、疑难的案件。与互联网庭审主要适用简易程序为主的简单案件相冲突。</p><p>（三）互联网庭审对网络环境、硬件设备的高要求与当事人因主客观因素导致的庭审程序不稳定因素之间的冲突</p><p>《杭州互联网法院诉讼平台审理规程》（以下简称《杭互法规程》）第二十九条、第三十条 ，一方面对当事人使用的网络条件、设备、场所进行检测；另一方面对法官使用的网络环境、音响、摄像头、远程庭审系统等软硬件测试确保顺利开庭。这一规定可以看出互联网庭审对于网络环境、硬件设备的要求。 由于当事人一方的诉讼环境脱离了传统法院模式的控制由此出现了以下重要的程序问题：一是当事人由于网络中断或者信号不稳定、停电等客观原因导致的庭审中断，法官是否能按照中途退庭处理；二是当事人主观故意致使网络中断或者停电的情况下，法官如何判断当事人的主观状态以及如何作出程序的处理；三是当事人一方故意、过失扰乱庭审秩序或其他不当行为的处理已不再可能通过“责令退出法庭”或使用司法警察的方式。此时，法官应当如何维护庭审秩序。以上问题都会导致互联网庭审的中断或者中止，是对互联网庭审以及法庭严肃性的极大挑战。那么尽量缩短庭审时间便是间接解决该项问题的方式。</p><p>（四）互联网庭审证据的虚拟性与传统庭审要求现场出示原件的实在性之间的冲突</p><p>《证据规定》 第十条，规定当事人提供的证据应当是原件或者核对无异议的复制件；第四十九条，进一步规定了另一方当事人有权要求出示证据的原件或者原物的规定，特别列举针对书证、物证、视听资料。两项规定说明我国传统的庭审方式要求证据需出示原件以及有权要求对方当事人提供原件。《杭互法规程》第二十五条第二款：“当事人将证据拍照、扫描或电子证据等上传至诉讼平台。涉及到实物证据，一般要求当事人在庭审前邮寄给审理法官。在庭审时，在线展示给各方当事人。”这里的实物证据是指以物品或者痕迹的形式存在或表现的。其中物证、书证、勘验笔录、现场笔录、视听资料等都属于实物证据。在互联网庭审中出示的证据均为拍照或者扫描等复制版，且在庭审中无法与原件进行核对，如果当事人当庭对该项证据的真实性表示异议并且要求查看原件或者当事人出示实物证据的情况下，将会导致庭审无法进行，需线下处理证据原件交换的问题，再另定日期开庭。这使得原本以高效、便捷为目的的互联网庭审的意义不复存在。此类问题，如当事人在开庭时提出鉴定申请、提出反诉等问题，均可以通过证据交换制度在庭前解决，提高庭审效率。</p><p>二、思考与设计：当前证据交换制度之实证性与其运用于杭州互联网庭审的司法实践</p><p>（一）证据交换制度之实证性</p><p>证据交换制度是我国司法实践中形成的一种创造性的做法。 根据证据交换制度在审判实践中的尝试发现，实践中越重视，审判效果越提升。笔者调取P区法院2017年审结的50件经过庭前证据交换的案件对比未经过证据交换的随机抽样50件案件发现：</p><p>　　1.证据交换后，庭前调解、撤诉率显著提升。在50件经过庭前证据交换的案件中，1件案件当事人提出鉴定申请；10件案件未能在庭前达成调解意见，直接开庭；1件案件需要补充证据；其余38件案件均撤诉或者调解，庭前调解、撤诉率为76%。对比随机抽样的50件未经过庭前证据交换的案件调解、撤诉率为63%。庭前证据交换后调解、撤诉率明显提升。该项实证研究表明证据交换制度可以有效帮助调解、撤诉互联网纠纷，适应当下“快餐式”互联网庭审的纠纷处理模式。</p><p>2.证据交换后，审判效率显著提升。在抽样的50件证据交换的案件中10件直接开庭的案件，因事实清楚、焦点明确均一次性开庭审结；1件需要补充证据的，也因为证据交换而避免“开庭-休庭-再开庭”的诉累。此外在10件开庭的案件中有2件有庭审录像，庭审时间平均耗时15分钟；在抽样50件未进行证据交换的案件中有5件有庭审录像的案件中，庭审平均耗时43分钟。庭审效率明显加快。互联网庭审要求的快速、便捷、高效通过证据交换制度便可以实现。互联网庭审对网络环境、硬件设备稳定性的高要求便可通过减少开庭次数、缩短庭审时间——“速战速决”的方式来解决。</p><p>（二）杭州互联网法院适用“证据交换”的司法实践</p><p>杭州互联网法院已经通过系统流程设置的方式将证据交换制度运用到互联网庭审中。在笔者通过实践操作过后发现其在理念上符合互联网庭审的要求，但在实际操作中却存在障碍。下面对杭州互联网法院证据交换制度进行简单的梳理并检视。</p><p>　　1.庭前在线举证。《杭互法规程》第二十五条　 ，举证期限与线下一致，为简易程序不超过15日；答辩状和管辖异议申请被告在线提交；双方当事人可以通过书面形式放弃举证期限；当事人上传复制或者扫描件证据材料，实物证据庭前邮寄。虽然互联网庭审的案件普遍采用简易程序审理，但是举证答辩期限由于系统设定以及电子送达时间的问题，均自动默认为15天（普通程序的举证、答辩期，简易程序法官可以依法确定），无形中拖长了审判期限；并且笔者在对杭州互联网法院平台系统的实务操作过程中发现双方当事人均举证结束以后才能开始质证；对于实物证据的处理，杭州互联网法院采用庭前邮寄给法官的方式灵活处理，为庭审的顺利进行减少举证障碍。</p><p>　　2.举证期限届满后补充证据。《杭互法规程》中并没有对补充证据的问题作进一步的处理，在笔者与阿里巴巴公司的技术人员沟通庭审细节以及实际操作过程中了解到，杭州互联网法院的庭审程序中举证期限届满或者法官手动点击结束举证以后，则不可再通过系统实现证据的补充。《民事诉讼法》第六十五条 ，《民事诉讼法解释》第一百零一条第一款、第二款 ，对于当事人逾期举证的作出了明确规定：首先是责令说明理由；其次不成立的采取两种处理方式要么不予采纳，要么采纳后训诫、罚款；第三，一方逾期举证是因客观原因造成或对方当事人未提出异议的，视为未逾期；第四，该证据虽为当事人故意或者重大过失逾期提供，但与案件基本事实有关的，应当采纳；第五，逾期提交的证据属于《证据规定》第四十一条规定的“新的证据”的，应当采纳。可见我国对于逾期提交的证据采取的举证期限制度是 “不失权为原则，失权为例外”。杭州互联网法院采取严格适用“诉讼时效”规定 ，追求“法律事实”的价值判断虽符合法律规定，但笔者认为对于案件的审理很难达到息讼服判的效果。也会常常出现当事人在庭审过程中提交新证据没有端口可以上传的尴尬境遇。C市P区法院在流程再造的过程中已经修复该技术漏洞，增加了举证期限届满以后，当事人任何一方补充证据的端口，并且增设了法院审查的步骤，完善了该程序。</p><p>3.庭前网上质证。《杭互法规程》第二十六条 ，对于举证期限届满后转入质证环节通过系统自动跳转或者工作人员人工操作跳转完成；进入质证环节后，当事人可以在线发表质证意见。系统对证据真实性、合法性、关联性直接勾选认可或不认可，并可就其证明力有无、大小等进行在线补充说明。 这一阶段由“系统提示”直接充当了证据交换、质证的主持人。《证据规定》第三十九条第一款：“证据交换应当在审判人员的主持下进行。”可见“系统提示”代替法官主持证据交换的过程，虽然为法官带来了工作上的便利，但是其“主持人”身份的合法性、合理性存疑；此外，系统的自动提示也使得法官对当事人主张、陈述意思不明确、不充分、不恰当的，无法进一步询问、提示和启发，其在这一程序中的“释明权”没有得以充分展现，证据交换的效果也难以实现。</p><p>三、探索与构想：完善证据交换制度在互联网庭审中的运用</p><p>杭州互联网法院将证据交换制度通过系统设置强制性的运用于互联网庭审的实践无疑是成功的。就目前笔者从杭州互联网法院微诉讼平台“阳光司法”项下查看到的100个公开庭审视频平均庭审时长26分钟，平均每个案件开庭1.11 次。可以看出，快速、便捷、高效的处理纠纷是互联网法院追求的目标，以保证互联网庭审的稳定性，避免本文在第一部分中阐述的网络环境、硬件设备、供电等客观因素导致的庭审中断，也同时可以提高庭审的效率。毕竟互联网庭审的庭前准备工作时间较长 ，多次开庭必然导致其快速、便捷、高效的优势不复存在。</p><p>互联网庭审在现代审判意义上是流程再造，是司法创新。 每一个庭审环节的不断打磨都将给互联网法院的进一步发展推波助力，以更好的完善诉讼流程，为当事人和公众提供更优质、高效的司法服务。</p><p>（一）完善思路</p><p>1.立足S省C市具体情形。积极借鉴以英美法系的“证据开示制度”和大陆法系的“证据交换制度”并结合杭州互联网法院设定的证据交换模式制定符合S省C市地域特点和法官习惯的证据交换制度。 这应当是我们在程序设计时必须坚持的指导思想。例如，在我国没有庞大的律师队伍不能像西方国家一样建立一个以当事人或者律师主导的证据交换制度，就应当建立以法官为主导的职权主义模式的证据交换制度。</p><p>2.立足司法实践，遵循审判规律。互联网庭审证据交换制度的意义在于使互联网法院能做好充分的庭前准备工作，整理、明确争点，固定证据，促使当事人达成和解，进一步使互联网庭审变得快速、便捷、高效。当然也可以防止当事人进行证据突袭。证据交换的设置不仅要符合审判公开、公平的要求也要同时满足互联网庭审快速、高效、便捷的特点，最终形成一套科学、有效的制度体系，与庭前调解和开庭程序紧密衔接，避免浪费诉讼资源。</p><p>（二）完善途径</p><p>　　1.证据交换的主体——法官助理。根据2015年最高人民法院《关于完善人民法院司法责任制的若干意见》第十九条规定“法官助理在法官的指导下履行以下职责：1、审查诉讼材料，协助法官组织庭前证据交换… …”2015年党和国家全面推进司法责任改革，不断充实审判辅助力量，形成“1+1+1”审判团队构建模式，即“法官+法官助理+书记员”。法官助理这一角色的定位则是审判辅助人员，其主要职责包括阅卷、主持调解、证据交换、归纳总结案件争点、对疑难案件进行研究并提出法律意见、草拟法律文书等辅助法官的裁判工作。可见庭前证据交换在司法体制改革之后由法官助理进行，更加符合目前司法责任制改革的要求同时减轻法官的办案负担。</p><p>　　2.证据交换的范围——以交换为原则，不交换为例外。通过互联网庭审的案件都应当强制采用证据交换制度，提高庭审效率。即使是简单案件或证据较少的案件，在审理过程中提交证据需要临时上传到诉讼平台，拖延诉讼进程。因此，无论是案情如何，原则上都应当进行庭前证据交换。若存在证据涉密等不适宜进行证据交换或者不适宜在互联网上庭审的情形可灵活转线下审理。</p><p>3.证据交换的方式——线上“交互式异步证据交换”为原则，线下交换为例外。根据互联网庭审的特点，当事人在起诉、应诉时就需要上传证据材料。杭州互联网法院的交换流程是原告上传证据材料——被告上传证据材料（15日）——举证期满后系统自动跳转（或者人工手动跳过转入质证阶段）——质证阶段（时间15日或者由法官手动操作跳过）完成质证—进入庭审排期。 “交互式”是指双方当事人、法官助理三方可以在系统中以如同微信、QQ等即时工具一般进行信息反馈，法官助理可以通过该系统行使法官的释明权。“异步交换”是指在互联网法庭网上诉讼平台上，法官助理与当事人等诉讼参与人在规定期限内，按照各自选择的时间登录平台以非同步方式完成证据交换。 例如：法官助理发出询问，当事人回答时间在举证答辩期内任何时段只要自己方便，上线回答即可。回答可以是文字输入，也可以是语音录入。证据交换随时进行无需固定时间、无需当事人“跑路”。“随时”、“零路程”进行证据交换，既节约了当事人的时间和精力又使得证据交换完整、充分，符合互联网庭审的要求。</p><p>4.证据交换的时间和次数——以人民法院指定为主，适用法定举证期为辅的原则。根据《证据规定》 第三十三条第二款、第三款，举证期限采取“当事人协商、申请—法院决定”模式；指定时间不少于30日。第三十六条，当事人可以申请两次延期举证，是否同意，法院决定。第三十八条，交换证据也可以由采用“当事人协商、申请—法院决定”模式，进一步确定证据交换的时间为“举证期限届满”之时。第四十条，证据交换的次数为2次，有例外。可见举证以及证据交换的时间是以“当事人协商、申请——法院决定”的模式来操作的，并且可以申请延期，对于举证期限的强制性限制就越发薄弱了。就互联网庭审的特点而言，将举证和质证同时进行，在时间上赋予法官充分的自由裁量权，法官可以根据当事人的举证能力、证据的可取得程度、案件的类型、复杂程度等因素综合考量确定合理的举证期限，以保护当事人合法诉讼权利，进一步提高庭审效率。同时，由于证据交换越充分，查清案件事实的概率就越大，纠纷处理也会更加公正、有效。因此，对证据交换的次数不应做严格限制，此处应当由法官酌定具体情形确定开庭时间以结束举证、质证即可。</p><p>（三）完善证据交换的配套制度。</p><p>1.建立逾期举证的制裁措施——以处罚、训诫为主，证据失权为辅的原则。证据失权会使实体正义和程序正义受损，采取训诫和罚款的方式可以有效的保证审判的公正性同时对不遵守证据交换规则的行为予以惩戒。确立证据交换制度后，可能会出现三种妨碍证据交换的状况：第一，在法院指定证据交换期限内未及时进行证据交换；第二，隐藏对对方不利的证据，以实现证据突袭；第三，隐藏对对方有利的证据。对于第一种情形，一般采用训诫、罚款的方式处罚，不宜使用证据失权制度；针对第二种情形的处罚，除非有证据证明该证据符合《证据规定》中“新的证据”的，否则将产生证据失权的效果，这样也才能发挥证据交换的作用。针对第三种情形，人民法院应当给当事人一定的辩解的机会，如形成初步表面可信情形，则可由实施举证妨碍行为的当事人，对该局部提出的证据承担举证负担。</p><p>2.建立强制被告答辩制度。根据《民事诉讼法》第一百一十三条 ，被告应当在收到起诉书副本后十五日内提交答辩意见，被告答辩的不影响案件审理。《民事诉讼法》规定了被告提交答辩状的时间和要求，这项规定也是与“证据随时提出主义”相适应的，但是对于不答辩的否定性后果没有进一步阐述，其中“被告不提出答辩状的不影响人民法院审理”的表述使得被告答辩的强制性大大减弱，甚至没有强制力。为了满足互联网庭审的需要，同时也便于原告在面对被告所提出的答辩主张时能够提供相应证据予以防御或者攻击，强制被告答辩可以使证据交换更加的充分、完整，同时便于法官在庭前总结“争点”。在互联网庭审中，起诉状副本被告在送达中已经收到；庭前证据交换已经完成管辖权异议申请、回避申请并在期间解决其他如查看证据原件、鉴定申请等程序问题，根据《民事诉讼法解释》第一百零三条第二款，法官只需在庭审中说明即可，以此进一步提升庭审效率。</p><p>3.建立可行的证据收集制度。建立可行的当事人证据收集制度是证据交换制度顺利运行的保障。《民事诉讼法》第六十四条第二款 ，当事人因客观原因不能收集或者法院认为应当调查收集的，法院都应当收集、调查。我国采取当事人自行收集为主，法院依职权调取为辅的当事人主义诉讼模式是为满足审判时间提高效率的需要。一方面，为了防止“法院依职权调取”规定的滥用给审判工作带来的负担，我们应当结合审判准备程序建立“强制调查令”制度，为当事人证据的收集提供“隐形”的力量支撑和保障；另一方面，完善国家机关信息公开制度，是当事人获取信息有径可循，与此同时对于获取有关国家秘密、商业秘密、个人隐私的证据材料当事人及其诉讼代理人 应当尽到保密义务。</p><p>结　语</p><p>杭州互联网法院是司法改革的前沿，是互联网技术改变司法的先驱和典范。 C市P区法院紧随其后，积极响应国家智慧法院建设，努力探索互联网+、云计算、大数据、人工智能运用于司法的新方式，在杭州互联网法院的基础上，进一步改进互联网庭审的方式，让庭审程流更加流畅、让当事人更加便利、让司法更加公平、公正、公开。习近平总书记在中国共产党第十九次全国代表大会当中提到“中国特色社会主义进入新时代，我国社会主要矛盾已经转化为人民日益增长的美好生活需要和不平衡不充分的发展之间的矛盾。”司法服务一方面应当强调“公平正义”这是根本，另一方面中国的互联网技术已经可以让当事人的诉讼成本越来越低。这就是司法领域当事人的“美好生活需求”。</p><p>　　　　　　　　　 （作者单位：成都市郫都区人民法院）</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;反思与再造：证据交换制度在互联网庭审中的应用研究&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;科学技术的迅猛发展使得整个世界形成了一个扁平化、虚拟化的信息时代，信息技术推动着这个社会从生产工具到生产关系的巨大变革，渗透、辐射到各个领域。 人们将社会生活的方方面面慢慢从实体转向了虚拟，从线下转向了线上，由此所产生的人们对司法运行模式的多元化、简洁化、精确化的需求日益更甚。2017年8月中国第一家互联网法院的揭牌就是顺应时代的需求、当事人的需求而创造出的成果，由此带来的对民事诉讼制度的挑战不容忽视。目前C市P区人民法院在S省、C市三级法院的大力支持下正在紧锣密鼓的筹备C市P区法院互联网法庭，作者作为本次互联网法庭建设的工作人员，全程参与互联网法庭的建设、测试工作，亲身体验网上诉讼的全部流程，不断改进创新网上诉讼流程，作为初步的研究，本文是对民事诉讼中的证据交换制度在互联网庭审中的运用之探析。&lt;/p&gt;
&lt;p&gt;一、梳理与检视：互联网庭审面临的现实难题&lt;/p&gt;
&lt;p&gt;互联网庭审不同于一般的网络庭审。目前我们所称的网络庭审是指“网络庭审直播”。即，将审理案件的过程通过网络媒介平台同步制作和发布图文、视频信息，是一种便于公众在第一时间了解庭审现状的双向互动直播模式。与新闻媒体片段化的记录、报导不同，“网络庭审直播”呈现出公开性、完整性和及时性的特点。庭审过程的可视化、审判流程公开、裁判文书公开、执行信息公开，让当事人迅速了解案件的进程，使“程序正义”在案件审理中得以真正实现。互联网庭审则是基于互联网法院管辖网络空间发生的各类案件并且审判活动全程在网上实现的庭审过程。具体而言，原、被告双方在不到实体法庭的情况下直接通过网络视频方式开庭的庭审模式，当事人无需踏进法院，便可实现诉讼全程在线化，大大提升了司法质效、为当事人带来了极大的便利，更为重要的是进一步推进网络空间的法治化。&lt;/p&gt;
&lt;p&gt;（一）互联网庭审的快速、便捷、高效与庭审程序法定性、程序正义的冲突&lt;/p&gt;
&lt;p&gt;习惯于“快餐式”网络交易的当事人，希望诉讼也能够尽可能通过简化诉讼程序、优化程序规则、缩短诉讼流程的方式，快速、便捷、高效的得以解决。这就要求互联网庭审程序尽可能简单、快速、流畅，但是庭审程序、规则的法定性以及当事人诉讼权利的保护等问题都是程序正义的必然要求，即使是互联网庭审程序再造，也不能损害当事人的合法权益、违反诉讼法的强制性规定。笔者通过S省法院庭审直播网的100件网络直播庭审案件分析，从审判员宣布开庭到原告宣读起诉状之前的程序处理平均用时7分43秒，证据交换程序平均耗时17分4秒。可见，程序的处理以及证据交换需要花费大量的庭审时间。&lt;/p&gt;
&lt;p&gt;（二）“互联网庭审”以适用简易程序为主的“简单”案件与“证据交换制度”实践中普遍适用于普通程序为主的“重大、疑难、复杂”案件的冲突&lt;/p&gt;
&lt;p&gt;目前互联网庭审主要是适用简易程序，由审判员独任审理，这是《民事诉讼法》的基本要求。《民诉法解释》第259条规定，开庭方式可由当事人申请，法院决定。“视听传输技术”等其他方式开庭的，须经双方当事人许可。互联网法院网上开庭的依据来源于此。笔者从杭州互联网法院微信诉讼平台“阳光司法”项下公开的庭审视频中99.4%适用简易程序审理，笔者随机点击的100个案件的庭审视频的平均开庭时长为26分钟。对于适用普通程序的案件，在技术上还存在部分障碍。例如《民诉法解释》第227 条规定， 诉讼代理人、证人、鉴定人、翻译人员、勘验人是应当到庭参加诉讼的。就目前P区法院互联网法庭的构建情况来看存在部分技术障碍，如电脑、手机或者平板电脑的尺寸使得原告、被告、证人、鉴定人、勘验人、翻译人员等同时开设庭审窗口受到限制，在笔者与技术人员沟通中发现，一个屏幕在保证庭审程序顺利进行的前提下 能够允许开设的视频窗口数量是受到很大限制的。&lt;/p&gt;
&lt;p&gt;根据最高人民法院颁布的《关于民事诉讼证据的若干规定》（以下简称《证据规定》）第三十七条 ，证据交换可以由当事人申请，法院在开庭审理前进行。法院对证据较多或复杂疑难的案件，应当组织当事人在答辩期届满后、开庭审理前交换证据。该条款明确了证据交换的启动包括当事人申请和法院依职权确定两种方式。当事人申请方式对当事人的法律素养、专业能力等要求较高，一般适用于当事人有专业委托代理人的情况下。此外对于当事人的申请，法院是可以而不是应当组织当事人交换证据，对此法院享有审查权和最终决定权。从该条第二款可以看出审查的依据则是证据较多或复杂疑难案件。故而，证据交换制度的适用范围可以确定为：证据较多或复杂、疑难的案件。与互联网庭审主要适用简易程序为主的简单案件相冲突。&lt;/p&gt;
&lt;p&gt;（三）互联网庭审对网络环境、硬件设备的高要求与当事人因主客观因素导致的庭审程序不稳定因素之间的冲突&lt;/p&gt;
    
    </summary>
    
    
      <category term="法律知识" scheme="https://blog.songuo.tech/categories/%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="法院" scheme="https://blog.songuo.tech/tags/%E6%B3%95%E9%99%A2/"/>
    
      <category term="互联网法院" scheme="https://blog.songuo.tech/tags/%E4%BA%92%E8%81%94%E7%BD%91%E6%B3%95%E9%99%A2/"/>
    
  </entry>
  
  <entry>
    <title>Can&#39;t connect to X11 window server using &#39;localhost:10.0&#39; as the value of the DISPLAY variable</title>
    <link href="https://blog.songuo.tech/p/769df2e6.html"/>
    <id>https://blog.songuo.tech/p/769df2e6.html</id>
    <published>2020-11-04T02:30:00.000Z</published>
    <updated>2020-11-04T01:36:17.208Z</updated>
    
    <content type="html"><![CDATA[<p>问题】</p><p>centos上的tomcat报错</p><p>Exception in thread “http-bio-8080-exec-6” java.lang.InternalError: Can’t connect to X11 window server using ‘localhost:10.0’ as the value of the DISPLAY variable</p><p>前台问题是页面的验证码图片加载不出来，而且报500错误</p><p> 【原因】</p><p>因为用到了图形处理，java程序会去寻找linux上的图形界面是否启动</p><p> 【解决办法】</p><p>不让java寻找linux图形界面即可，在java启动时加选项java -Djava.awt.headless=true</p><p>在/usr/local/tomcat/bin/catalina.sh中开头添加如下参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS=-Djava.awt.headless=true</span><br></pre></td></tr></table></figure><p> 【我的tomcat实际效果】</p><p>/usr/local/tomcat/bin/catalina.sh 开头加入</p><p>JAVA_OPTS=”$JAVA_OPTS -XX:PermSize=256m -XX:MaxPermSize=512m -Xms2g -Xmx2g -Djava.awt.headless=true “</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;问题】&lt;/p&gt;
&lt;p&gt;centos上的tomcat报错&lt;/p&gt;
&lt;p&gt;Exception in thread “http-bio-8080-exec-6” java.lang.InternalError: Can’t connect to X11 window server using ‘localhost:10.0’ as the value of the DISPLAY variable&lt;/p&gt;
&lt;p&gt;前台问题是页面的验证码图片加载不出来，而且报500错误&lt;/p&gt;
&lt;p&gt; 【原因】&lt;/p&gt;
&lt;p&gt;因为用到了图形处理，java程序会去寻找linux上的图形界面是否启动&lt;/p&gt;
&lt;p&gt; 【解决办法】&lt;/p&gt;
&lt;p&gt;不让java寻找linux图形界面即可，在java启动时加选项java -Djava.awt.headless=true&lt;/p&gt;
&lt;p&gt;在/usr/local/tomcat/bin/catalina.sh中开头添加如下参数&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;JAVA_OPTS=-Djava.awt.headless=true&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="tomcat" scheme="https://blog.songuo.tech/tags/tomcat/"/>
    
  </entry>
  
  <entry>
    <title>Jeecgboot自定义列使用</title>
    <link href="https://blog.songuo.tech/p/5a77449.html"/>
    <id>https://blog.songuo.tech/p/5a77449.html</id>
    <published>2020-10-23T02:30:00.000Z</published>
    <updated>2020-10-23T07:55:07.020Z</updated>
    
    <content type="html"><![CDATA[<p>直接将代码copy到相应页面即可</p><p><template> 标签添加如下</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20201023/clip_image002.jpg" alt="img"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;span style&#x3D;&quot;float:right&quot;&gt;</span><br><span class="line">          &lt;a @click&#x3D;&quot;loadData()&quot;&gt;&lt;a-icon type&#x3D;&quot;sync&quot; &#x2F;&gt;刷新&lt;&#x2F;a&gt;</span><br><span class="line">          &lt;a-divider type&#x3D;&quot;vertical&quot; &#x2F;&gt;</span><br><span class="line">          &lt;a-popover title&#x3D;&quot;自定义列&quot; trigger&#x3D;&quot;click&quot; placement&#x3D;&quot;leftBottom&quot;&gt;</span><br><span class="line">            &lt;template slot&#x3D;&quot;content&quot;&gt;</span><br><span class="line">              &lt;a-checkbox-group @change&#x3D;&quot;onColSettingsChange&quot; v-model&#x3D;&quot;settingColumns&quot; :defaultValue&#x3D;&quot;settingColumns&quot;&gt;</span><br><span class="line">                &lt;a-row&gt;</span><br><span class="line">                  &lt;template v-for&#x3D;&quot;(item,index) in defColumns&quot;&gt;</span><br><span class="line">                    &lt;template v-if&#x3D;&quot;item.key!&#x3D;&#39;rowIndex&#39;&amp;&amp; item.dataIndex!&#x3D;&#39;action&#39;&quot;&gt;</span><br><span class="line">                      &lt;a-col :span&#x3D;&quot;12&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">                        &lt;a-checkbox :value&#x3D;&quot;item.dataIndex&quot;&gt;</span><br><span class="line">                          &#123;&#123; item.title &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;a-checkbox&gt;</span><br><span class="line">                      &lt;&#x2F;a-col&gt;</span><br><span class="line">                    &lt;&#x2F;template&gt;</span><br><span class="line">                  &lt;&#x2F;template&gt;</span><br><span class="line">                &lt;&#x2F;a-row&gt;</span><br><span class="line">              &lt;&#x2F;a-checkbox-group&gt;</span><br><span class="line">            &lt;&#x2F;template&gt;</span><br><span class="line">            &lt;a&gt;&lt;a-icon type&#x3D;&quot;setting&quot; &#x2F;&gt;自定义列&lt;&#x2F;a&gt;</span><br><span class="line">          &lt;&#x2F;a-popover&gt;</span><br><span class="line">        &lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure><p> data生命周期定义变量</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20201023/clip_image005.png" alt="img"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">columns: [],</span><br><span class="line">settingColumns: [],</span><br><span class="line">defColumns: columns,</span><br></pre></td></tr></table></figure><p>created声明周期调用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">   <span class="keyword">this</span>.initColumns()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p> methods方法定义</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20201023/clip_image007.jpg" alt="img"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">onColSettingsChange (checkedValues) &#123;</span><br><span class="line">        <span class="keyword">var</span> key = <span class="keyword">this</span>.$route.name + <span class="string">':colsettings'</span></span><br><span class="line">        <span class="keyword">this</span>.$ls.set(key, checkedValues, <span class="number">7</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">this</span>.settingColumns = checkedValues</span><br><span class="line">        <span class="keyword">const</span> cols = <span class="keyword">this</span>.defColumns.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (item.key === <span class="string">'rowIndex'</span> || item.dataIndex === <span class="string">'action'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.settingColumns.includes(item.dataIndex)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.columns = cols</span><br><span class="line">      &#125;,</span><br><span class="line">      initColumns() &#123;</span><br><span class="line">        <span class="comment">// 权限过滤（列权限控制时打开，修改第二个参数为授权码前缀）</span></span><br><span class="line">        <span class="comment">// this.defColumns = colAuthFilter(this.defColumns,'testdemo:');</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> key = <span class="keyword">this</span>.$route.name + <span class="string">':colsettings'</span></span><br><span class="line">        <span class="keyword">let</span> colSettings = <span class="keyword">this</span>.$ls.get(key)</span><br><span class="line">        <span class="keyword">if</span> (colSettings == <span class="literal">null</span> || colSettings == <span class="literal">undefined</span>) &#123;</span><br><span class="line">          <span class="keyword">let</span> allSettingColumns = []</span><br><span class="line">          <span class="keyword">this</span>.defColumns.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item, i, array</span>) </span>&#123;</span><br><span class="line">            allSettingColumns.push(item.dataIndex)</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="keyword">this</span>.settingColumns = allSettingColumns</span><br><span class="line">          <span class="keyword">this</span>.columns = <span class="keyword">this</span>.defColumns</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.settingColumns = colSettings</span><br><span class="line">          <span class="keyword">const</span> cols = <span class="keyword">this</span>.defColumns.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.key === <span class="string">'rowIndex'</span> || item.dataIndex === <span class="string">'action'</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (colSettings.includes(item.dataIndex)) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="keyword">this</span>.columns = cols</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;直接将代码copy到相应页面即可&lt;/p&gt;
&lt;p&gt;&lt;template&gt; 标签添加如下&lt;/template&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20201023/clip_image002.jpg&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;span style&amp;#x3D;&amp;quot;float:right&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;lt;a @click&amp;#x3D;&amp;quot;loadData()&amp;quot;&amp;gt;&amp;lt;a-icon type&amp;#x3D;&amp;quot;sync&amp;quot; &amp;#x2F;&amp;gt;刷新&amp;lt;&amp;#x2F;a&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;lt;a-divider type&amp;#x3D;&amp;quot;vertical&amp;quot; &amp;#x2F;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;lt;a-popover title&amp;#x3D;&amp;quot;自定义列&amp;quot; trigger&amp;#x3D;&amp;quot;click&amp;quot; placement&amp;#x3D;&amp;quot;leftBottom&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;lt;template slot&amp;#x3D;&amp;quot;content&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &amp;lt;a-checkbox-group @change&amp;#x3D;&amp;quot;onColSettingsChange&amp;quot; v-model&amp;#x3D;&amp;quot;settingColumns&amp;quot; :defaultValue&amp;#x3D;&amp;quot;settingColumns&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;lt;a-row&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &amp;lt;template v-for&amp;#x3D;&amp;quot;(item,index) in defColumns&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;lt;template v-if&amp;#x3D;&amp;quot;item.key!&amp;#x3D;&amp;#39;rowIndex&amp;#39;&amp;amp;&amp;amp; item.dataIndex!&amp;#x3D;&amp;#39;action&amp;#39;&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &amp;lt;a-col :span&amp;#x3D;&amp;quot;12&amp;quot; :key&amp;#x3D;&amp;quot;index&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &amp;lt;a-checkbox :value&amp;#x3D;&amp;quot;item.dataIndex&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                          &amp;#123;&amp;#123; item.title &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &amp;lt;&amp;#x2F;a-checkbox&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                      &amp;lt;&amp;#x2F;a-col&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;lt;&amp;#x2F;template&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &amp;lt;&amp;#x2F;template&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;lt;&amp;#x2F;a-row&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &amp;lt;&amp;#x2F;a-checkbox-group&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;lt;&amp;#x2F;template&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;lt;a&amp;gt;&amp;lt;a-icon type&amp;#x3D;&amp;quot;setting&amp;quot; &amp;#x2F;&amp;gt;自定义列&amp;lt;&amp;#x2F;a&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;lt;&amp;#x2F;a-popover&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;lt;&amp;#x2F;span&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; data生命周期定义变量&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20201023/clip_image005.png&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;columns: [],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;settingColumns: [],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;defColumns: columns,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;created声明周期调用&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;created() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.initColumns()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; methods方法定义&lt;/p&gt;
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="jeecgboot" scheme="https://blog.songuo.tech/tags/jeecgboot/"/>
    
  </entry>
  
  <entry>
    <title>linux下字体的安装处理</title>
    <link href="https://blog.songuo.tech/p/3b2cd0d3.html"/>
    <id>https://blog.songuo.tech/p/3b2cd0d3.html</id>
    <published>2020-10-20T02:30:00.000Z</published>
    <updated>2020-10-21T14:11:18.330Z</updated>
    
    <content type="html"><![CDATA[<h2 id="linux下字体的安装处理"><a href="#linux下字体的安装处理" class="headerlink" title="linux下字体的安装处理"></a>linux下字体的安装处理</h2><p>linux下itextpdf将html转换为pdf的过程中，需要处理字体<br><code>需要将C:\Windows\Fonts下的字体文件copy到linux/usr/share/fonts目录，并且设置权限为755</code></p><ul><li>参考链接<a href="https://www.cnblogs.com/chengJAVA/p/5292014.html" target="_blank" rel="noopener">centos系统安装中文字体几种方法</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;linux下字体的安装处理&quot;&gt;&lt;a href=&quot;#linux下字体的安装处理&quot; class=&quot;headerlink&quot; title=&quot;linux下字体的安装处理&quot;&gt;&lt;/a&gt;linux下字体的安装处理&lt;/h2&gt;&lt;p&gt;linux下itextpdf将html转换为pdf的过程中，需要处理字体&lt;br&gt;&lt;code&gt;需要将C:\Windows\Fonts下的字体文件copy到linux/usr/share/fonts目录，并且设置权限为755&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;参考链接&lt;a href=&quot;https://www.cnblogs.com/chengJAVA/p/5292014.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;centos系统安装中文字体几种方法&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="linux" scheme="https://blog.songuo.tech/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>立案、审理流程</title>
    <link href="https://blog.songuo.tech/p/c060671e.html"/>
    <id>https://blog.songuo.tech/p/c060671e.html</id>
    <published>2020-09-09T02:14:00.000Z</published>
    <updated>2020-09-11T05:14:32.074Z</updated>
    
    <content type="html"><![CDATA[<p><strong>立案、审理流程</strong></p><p><strong>1</strong> <strong>、案件受理流程：</strong></p><p><strong>递交立案材料</strong>（当事人递交立案材料）→<strong>审查立案</strong>（立案大庭收到立案材料之日7日之内审查立案，发送立案庭长审批）→<strong>生成案号</strong>（立案庭长审批号返回立案大庭生成案号）→<strong>送达诉讼文书</strong>（立案庭向原告送达《受理案件通知书》等文书，告知其缴费）→<strong>预交费用</strong>（当事人收到送达书7日内预交案件受理费和其它费用）→<strong>案件移送（</strong>立案大庭确认缴费后，于办妥立案手续次日内将案件移送业务庭，经业务庭长确认）→<strong>分案</strong>（业务庭长2日内完成分案，移交审判员）。</p><p><strong>2</strong> <strong>、案件审理流程：</strong></p><p><strong>（1）民事：</strong>适用普通程序的，立案之日起六个月内审结，有特殊情况需要延长的，经本院主管院长批准，可以延长六个月，还需要延长的报请上一级人民法院批准。</p><p><strong>（2）行政：</strong>立案之日起三个月审结，有特殊情况需要延长的，由高级人民法院批准。</p><p><strong>（3）刑事：</strong></p><p><strong>公诉案件：</strong>人民法院审理公诉案件，应当在受理后二个月以内宣判，至迟不得超过三个月。</p><p><strong>适用简易程序的案件：</strong>适用简易程序审理案件，人民法院应当在受理后二十日以内审结；对可能判处的有期徒刑超过三年的，可以延长至一个半月。</p><p><strong>（4）申请再审、申诉案件：</strong>民事案件自收到再审申请书之日起三个月内审查完毕，有特殊情况需要延长的报本院院长批准；行政案件立案登记的材料经审查后，在六个月内作出是否予以再审处理；对立案审查的刑事申诉案件，应当在三个月内作出决定，至迟不得超过六个月。</p><p>摘自<a href="http://tsfnfy.hebeicourt.gov.cn/public/detail.php?id=71" target="_blank" rel="noopener"><strong>立案、审理流程</strong></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;立案、审理流程&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; &lt;strong&gt;、案件受理流程：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;递交立案材料&lt;/strong&gt;（当事人递交立案材料）→&lt;strong&gt;审查立案&lt;/strong&gt;（立案大庭收到立案材料之日7日之内审查立案，发送立案庭长审批）→&lt;strong&gt;生成案号&lt;/strong&gt;（立案庭长审批号返回立案大庭生成案号）→&lt;strong&gt;送达诉讼文书&lt;/strong&gt;（立案庭向原告送达《受理案件通知书》等文书，告知其缴费）→&lt;strong&gt;预交费用&lt;/strong&gt;（当事人收到送达书7日内预交案件受理费和其它费用）→&lt;strong&gt;案件移送（&lt;/strong&gt;立案大庭确认缴费后，于办妥立案手续次日内将案件移送业务庭，经业务庭长确认）→&lt;strong&gt;分案&lt;/strong&gt;（业务庭长2日内完成分案，移交审判员）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; &lt;strong&gt;、案件审理流程：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;（1）民事：&lt;/strong&gt;适用普通程序的，立案之日起六个月内审结，有特殊情况需要延长的，经本院主管院长批准，可以延长六个月，还需要延长的报请上一级人民法院批准。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;（2）行政：&lt;/strong&gt;立案之日起三个月审结，有特殊情况需要延长的，由高级人民法院批准。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;（3）刑事：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;公诉案件：&lt;/strong&gt;人民法院审理公诉案件，应当在受理后二个月以内宣判，至迟不得超过三个月。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;适用简易程序的案件：&lt;/strong&gt;适用简易程序审理案件，人民法院应当在受理后二十日以内审结；对可能判处的有期徒刑超过三年的，可以延长至一个半月。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;（4）申请再审、申诉案件：&lt;/strong&gt;民事案件自收到再审申请书之日起三个月内审查完毕，有特殊情况需要延长的报本院院长批准；行政案件立案登记的材料经审查后，在六个月内作出是否予以再审处理；对立案审查的刑事申诉案件，应当在三个月内作出决定，至迟不得超过六个月。&lt;/p&gt;
    
    </summary>
    
    
      <category term="法律知识" scheme="https://blog.songuo.tech/categories/%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="法院" scheme="https://blog.songuo.tech/tags/%E6%B3%95%E9%99%A2/"/>
    
  </entry>
  
  <entry>
    <title>备用sql语句查询</title>
    <link href="https://blog.songuo.tech/p/82b915a.html"/>
    <id>https://blog.songuo.tech/p/82b915a.html</id>
    <published>2020-09-01T02:30:00.000Z</published>
    <updated>2020-09-03T02:59:19.635Z</updated>
    
    <content type="html"><![CDATA[<p>Mysql查询表的最新更新时间</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">update_time,</span><br><span class="line">t.* </span><br><span class="line">FROM</span><br><span class="line">&#96;information_schema&#96;.&#96;TABLES&#96; t </span><br><span class="line">WHERE</span><br><span class="line">1&#x3D;1</span><br><span class="line">-- and table_name LIKE &#39;%log%&#39; </span><br><span class="line">ORDER BY</span><br><span class="line">update_time DESC</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Mysql查询表的最新更新时间&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	update_time,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	t.* &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;FROM&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#96;information_schema&amp;#96;.&amp;#96;TABLES&amp;#96; t &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;WHERE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1&amp;#x3D;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-- and table_name LIKE &amp;#39;%log%&amp;#39; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ORDER BY&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	update_time DESC&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
      <category term="mysql" scheme="https://blog.songuo.tech/categories/mysql/"/>
    
    
      <category term="Mysql" scheme="https://blog.songuo.tech/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>git ignore idea文件</title>
    <link href="https://blog.songuo.tech/p/e3021418.html"/>
    <id>https://blog.songuo.tech/p/e3021418.html</id>
    <published>2020-08-14T10:30:00.000Z</published>
    <updated>2020-09-03T02:59:19.630Z</updated>
    
    <content type="html"><![CDATA[<p>git ignore idea 文件</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached --force -r .idea</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;git ignore idea 文件&lt;/p&gt;
&lt;figure class=&quot;highlight vbscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git rm --cached --force -r .idea&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="idea" scheme="https://blog.songuo.tech/tags/idea/"/>
    
  </entry>
  
  <entry>
    <title>深入理解时间戳</title>
    <link href="https://blog.songuo.tech/p/7950ed77.html"/>
    <id>https://blog.songuo.tech/p/7950ed77.html</id>
    <published>2020-08-14T07:19:53.000Z</published>
    <updated>2020-09-03T02:59:19.648Z</updated>
    
    <content type="html"><![CDATA[<h1 id="深入理解时间戳"><a href="#深入理解时间戳" class="headerlink" title="深入理解时间戳"></a>深入理解时间戳</h1><p>时间戳可谓数字签名的好伙伴，它为数字签名提供了额外的时间上的保证，使得数字签名的可信度大大提高。</p><p>到底什么是时间戳？从PDF签名的角度来看，时间戳会直接表现在签名里：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-785c2ca9fb03c0c42e856a9f951fc5d9_720w.jpg" alt="img"></p><p>在前两篇文章，我分析过PDF里的签名信息，也就是PDF dictionary里的content下的内容，其实是一个CMS对象. 而真正的签名值，也就是对一个哈希内容做的加密结果，其实是存在signerInfo下面的signature字段里。</p><p>PDF签名的时间戳对象，其实就是这个签名值signature.</p><p><strong>时间戳的定义(wiki)</strong>：</p><p><strong>Trusted timestamping</strong> is the process of <a href="https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Computer_security">securely</a> keeping track of the creation and modification time of a document. Security here means that no one—not even the owner of the document—should be able to change it once it has been recorded provided that the timestamper’s integrity is never compromised.</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-095a8e6dacdeae7de3c844c30e30ecfa_720w.jpg" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-b791900eab09c024c9fd872f8283cd22_720w.jpg" alt="img"></p><p><strong>下面通过一个实例来说说整个时间戳请求和响应的过程。</strong></p><p><strong>1.生成TimeStampRequest</strong></p><p>笔者想对字符串”123”做时间戳，首先对原文123做SHA256，得到数据指纹：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hex:a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3</span><br><span class="line">base64:pmWkWSBCL51Bfkhn79xPuKBKHz<span class="comment">//H6B+mY6G9/eieuM=</span></span><br></pre></td></tr></table></figure><p>得到了数据指纹，这里采用Java的第三方安全库bouncycastle来生成一个TimeStampRequest：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">byte[] respBytes &#x3D; null;</span><br><span class="line">&#x2F;&#x2F; Setup the time stamp request</span><br><span class="line">TimeStampRequestGenerator tsqGenerator &#x3D; new TimeStampRequestGenerator();</span><br><span class="line">tsqGenerator.setCertReq(true);</span><br><span class="line">if (tsaReqPolicy !&#x3D; null &amp;&amp; tsaReqPolicy.length() &gt; 0) &#123;</span><br><span class="line">    tsqGenerator.setReqPolicy(new ASN1ObjectIdentifier(tsaReqPolicy));</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; tsqGenerator.setReqPolicy(&quot;1.3.6.1.4.1.601.10.3.1&quot;);</span><br><span class="line">BigInteger nonce &#x3D; BigInteger.valueOf(System.currentTimeMillis());</span><br><span class="line">TimeStampRequest request &#x3D; tsqGenerator.generate(new ASN1ObjectIdentifier(DigestAlgorithms.getAllowedDigests(&quot;SHA256&quot;)), tsImprint, nonce);</span><br><span class="line">byte[] requestBytes &#x3D; request.getEncoded();</span><br></pre></td></tr></table></figure><p>TimeStampRequest的结构定义在RFC3161中：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-7f36f6a799029f5a680ae0608f070c63_720w.jpg" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-bfb712d0cedd49558ff679074e6607df_720w.jpg" alt="img"></p><p>其中messageImprint则是数据指纹，它包含了哈希算法和哈希值：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-679cdafe694cc4cbbe3f1fc856cdcbc5_720w.jpg" alt="img"></p><p>certReq则指示证书是否出现在SignedData的certificate字段中；nonce是一个代表时间的大数，会在response中带回。</p><p><strong>2.向时间戳服务器发送请求</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Call the communications layer</span><br><span class="line">respBytes &#x3D; getTSAResponse(requestBytes);</span><br><span class="line">            </span><br><span class="line">&#x2F;&#x2F; Handle the TSA response</span><br><span class="line">TimeStampResponse response &#x3D; new TimeStampResponse(respBytes);</span><br><span class="line">response.validate(request);</span><br><span class="line">System.out.println(&quot;base64 respBytes:\n&quot; + new String(Base64.encode(respBytes), &quot;UTF-8&quot;));</span><br><span class="line">System.out.println(response.getStatus());</span><br><span class="line">System.out.println(response.getStatusString());</span><br></pre></td></tr></table></figure><p>这里调用TSAClientBouncyCastle类封装好的getTSAResponse函数来得到响应结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">base64 respBytes:</span><br><span class="line">MIIUKTAVAgEAMBAMDk9wZXJhdGlvbiBPa2F5MIIUDgYJKoZIhvcNAQcCoIIT&#x2F;zCCE&#x2F;sCAQMxDzANBglghkgBZQMEAgEFADB6BgsqhkiG9w0BCRABBKBrBGkwZwIBAQYMKwYBBAGBrwgBAgMtMDEwDQYJYIZIAWUDBAIBBQAEIKZlpFkgQi+dQX5IZ+&#x2F;cT7igSh8&#x2F;&#x2F;x+gfpmOhvf3onrjAggpfspxYeeNfxgPMjAxODAzMDgwMjI1NDBaAgYBYgNtoLKgghBgMIIFCjCCA&#x2F;KgAwIBAgIIVAnE5PcrHMcwDQYJKoZIhvcNAQELBQAwbzELMAkGA1UEBhMCQ04xOTA3BgNVBAoMMEdsb2JhbCBEaWdpdGFsIEN5YmVyc2VjdXJpdHkgQXV0aG9yaXR5IENvLiwgTHRkLjElMCMGA1UEAwwcR0RDQSBUcnVzdEFVVEggUjQgR2VuZXJpYyBDQTAeFw0xNzA0MTMwNjQwMDZaFw0yNzA0MTEwNjQwMDZaMIGEMQswCQYDVQQGEwJDTjESMBAGA1UECAwJ5bm&#x2F;5Lic55yBMRIwEAYDVQQHDAnlub&#x2F;lt57luIIxLTArBgNVBAsMJOaVsOWuieaXtuS7o+enkeaKgOiCoeS7veaciemZkOWFrOWPuDEeMBwGA1UEAwwVR0RDQSBUaW1lc3RhbXAgU2lnbmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4wC9fArtnGSuKjGVtJgJ98ou5moCPVnv2dar9nkk0FLZ2105P2jfU6aT1BHcvk1k6cmjOKUyGfz5FBn06eF+e26y&#x2F;l25tzzQn&#x2F;ZRMfAelFWEmRbXNlOn54B5njJAdYNQU7IM&#x2F;ufKYLzBjuqMdZy9de66&#x2F;m5ExuXJThUh7Bf2K6T3aQePnv6XIJ9i6DztCbXwfyGRYf+jHWOrNItVl7QImcwoUR+Afa3x+d+zkc8HZuSCXMDiKm3WrmjzfLdkawzANLV7bxTKzCKfkoIXdVUFJabjZamthk6ksLi33g3N6TMPTNrBHGp&#x2F;y9Yt8bCwPbTwV3byS+BH7kL&#x2F;KNJSTbDjtQIDAQABo4IBkjCCAY4wgYMGCCsGAQUFBwEBBHcwdTBIBggrBgEFBQcwAoY8aHR0cDovL3d3dy5nZGNhLmNvbS5jbi9jZXJ0L0dEQ0FfVHJ1c3RBVVRIX1I0X0dlbmVyaWNfQ0EuZGVyMCkGCCsGAQUFBzABhh1odHRwOi8vb2NzcDIuZ2RjYS5jb20uY24vb2NzcDAdBgNVHQ4EFgQUAn2SnDTJycvFLNlKHleiM9XoioYwCQYDVR0TBAIwADAfBgNVHSMEGDAWgBTT&#x2F;u5hgMCZkFlt1iRV8v&#x2F;A6ycX7DBFBgNVHSAEPjA8MDoGCiqBHIbvLwEBAQIwLDAqBggrBgEFBQcCARYeaHR0cDovL3d3dy5nZGNhLmNvbS5jbi9jcHMvY3BzMEwGA1UdHwRFMEMwQaA&#x2F;oD2GO2h0dHA6Ly9jcmwuZ2RjYS5jb20uY24vY3JsL0dEQ0FfVHJ1c3RBVVRIX1I0X0dlbmVyaWNfQ0EuY3JsMA4GA1UdDwEB&#x2F;wQEAwIHgDAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDANBgkqhkiG9w0BAQsFAAOCAQEAqEWGYzFE58FpByBwPQDnU3KzvWyPdMIhd726SRjiOMIecjBqXpd0fi3KJ3+rq&#x2F;oCT8N8gSIezEzcXVPdJ2oCnHFaBZCUJOndvoOK1GM20oEnNnEYLvG6iilyAy5lDPqjbpmMYC6Hk4h8bnPMhUQNpDqEjpYKyisoN0dQh0viXPwmojahM+1CsYOlirC4NwTJVhcNA8ssB1Z74fGrNx+cSH7scA1IqTzVygtYUJ7MqQ5atXQw&#x2F;ji0Ofu4m4yRR+3fnjG3l23zmXH&#x2F;WehlzY4kuilhHBhD39N4WV7+a99JUoiqj8Ao&#x2F;hTjz7rVdOX9M1Zj4Tj1zWE1QDN02eNdwEql+zCCBYgwggNwoAMCAQICCH0Jl&#x2F;7wR+p6MA0GCSqGSIb3DQEBCwUAMGIxCzAJBgNVBAYTAkNOMTIwMAYDVQQKDClHVUFORyBET05HIENFUlRJRklDQVRFIEFVVEhPUklUWSBDTy4sTFRELjEfMB0GA1UEAwwWR0RDQSBUcnVzdEFVVEggUjUgUk9PVDAeFw0xNDExMjYwNTEzMTVaFw00MDEyMzExNTU5NTlaMGIxCzAJBgNVBAYTAkNOMTIwMAYDVQQKDClHVUFORyBET05HIENFUlRJRklDQVRFIEFVVEhPUklUWSBDTy4sTFRELjEfMB0GA1UEAwwWR0RDQSBUcnVzdEFVVEggUjUgUk9PVDCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBANmjFvDIdHR3m+8zDTsGflX8tWCPdoYSQn1WZj6Igu1yYw6ei900LAJRUcMZ&#x2F;VlUhMnxa7NMsOnoRl04xqKnLhFXuoIVopyPbbCZSgry64lwY055xLdbvaJdsfJBAiutqTqj7HkK7F864&#x2F;3vgDytNJsaq4gme1aigoYf6zWJg39frilOPbZu7K7B8CebruP07O+uf&#x2F;eGPXJ666X7WU6n65WMIjl54S0Ij8y8kbhB9xTBI6nDrZpFRLOy1yzNxiniUBCuXMuCjhcYNn2X5oiasE00CfQsuVpmKrAXm54edp1KZjFB3z&#x2F;7xQbvG7Z+GkY292RjO+M5GCPnZ3UU1XVXkje9vmobJlDyNiYGkMVwAWRtdmbhkdtuB8BhgC6yLi+McKfROzyzkeRutsQ7cPJskpcJzUd9GMDzu54P1ouuB7ZaD84LDEen5T64vX3HmzWgYZc6QXUXzCuWdyqSIR7ZlXYgZ2jPDb3f1h8JaprizHNxpC99EoC3UzBGXktUmQ9nyaXI8iDBguydEd&#x2F;CAvsaO9HtIJrvZWSSEA0q4t5w8Rhngoxh3ri80S+c+w&#x2F;QK+0bdrnkOVX4+KEduKqAAEyC57J&#x2F;Cbi8MKAvDfVSno73krMKAB0AVJcG4LEH2ccPXGV9PG1ZV+TtpY3pQFOfFUugcfYaIePacAYhWBSHhXd5qoJ5AgMBAAGjQjBAMB0GA1UdDgQWBBTiyUCfTc7omqF8zw4&#x2F;ZcUpiGoZUTAPBgNVHRMBAf8EBTADAQH&#x2F;MA4GA1UdDwEB&#x2F;wQEAwIBhjANBgkqhkiG9w0BAQsFAAOCAgEA0UlX4KfMaFi6AQ8rGc2NsGFFrBHtY1Bp+B9&#x2F;vhaP&#x2F;Z3rC6oyR3bSZyTtvXwzMpcqxwWGZg0XfRQVG9Tr&#x2F;R+a9l6XabcaJaQKs5E&#x2F;Xzasi+xXqD7ngYoYVzmFdBpCx+lbE1+P+QjpknSN9UfSqzvW+3hmTjZ9+emS6QTe&#x2F;Ulj&#x2F;G37FHGTZy9HSre5&#x2F;x4qc3BGML9a8i95peGNDNn5smM3jDdlhXBqXFsJcrmtYzyx3fj8Mr83huS7jpgnfrofFuFwEfID3yViMicmGDKEn&#x2F;8AOhO6mk30T7gUcCKxyiuQzinBcPQvnX&#x2F;ykB7WWt+3RvzmhvrL4CB2erqmy&#x2F;V83mKlsYvu3oJmik46MB8&#x2F;gMutJ7oMXtfQsVbKd3GytXWhUKlAQxfCKNnPUotbyGPUQj6gM3pGLvcKIEZUfmpPMfGBfkJ0OGVzJ+7GfLiO16U615ihnIwQVdPbS+xAkPLNblfSYg58V5Oxp23NnYO7KufltjtxWK390UW8WpHuUxVv00UJdW66kF0eBM833x6oZrGM5iBq7&#x2F;xITnSYQq8pby5qx&#x2F;t90WYxIsyGAH5mgwxC9L00ksMa6k&#x2F;KfnJNC3CMpki7pqEU9vtYRJkUrqoLk2mgKSVKpcsr3YpmBxZ4FVdxG+z1R4TznjE3etV&#x2F;JK3kvP39zG6D6Ayot0FsB929PIaXL9IwggXCMIIDqqADAgECAggoNWqccLRVeDANBgkqhkiG9w0BAQsFADBiMQswCQYDVQQGEwJDTjEyMDAGA1UECgwpR1VBTkcgRE9ORyBDRVJUSUZJQ0FURSBBVVRIT1JJVFkgQ08uLExURC4xHzAdBgNVBAMMFkdEQ0EgVHJ1c3RBVVRIIFI1IFJPT1QwHhcNMTYwNDA3MDk1ODQ0WhcNMzAxMjMwMTYwMDAwWjBvMQswCQYDVQQGEwJDTjE5MDcGA1UECgwwR2xvYmFsIERpZ2l0YWwgQ3liZXJzZWN1cml0eSBBdXRob3JpdHkgQ28uLCBMdGQuMSUwIwYDVQQDDBxHRENBIFRydXN0QVVUSCBSNCBHZW5lcmljIENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtju9uNmiLU9Ml&#x2F;m96XBPIQ9wMVaoZakOC28YZ6LQtn7+HlGw4llKByEbhqIjAS&#x2F;jvN7rlUYrh9KMEdusbyjQoajCCFI13VHtq7G9DKV5PgrvrSYZv2u7o+qmbNeYIknJt+rj7wnePzCl7q61QNKdT4qbHfe6bGMkiDOzqCu8c6uBkt6OT4AYRfjVuY1KjAJHykbedMY5udecJRXVfl83PIEb&#x2F;P+KZzFeacPxUrkVOk+BB3XtOeM2ShN9tdWzo+yFJAkLqgPieVEBNd3FHi8ePpEgs6Sq6NLXwUJIrF+CAxTLxsdOZUTPrW5hU16jPwzrFaVmxNwOoCjjqU93lzg5dwIDAQABo4IBbTCCAWkwfQYIKwYBBQUHAQEEcTBvMEIGCCsGAQUFBzAChjZodHRwOi8vd3d3LmdkY2EuY29tLmNuL2NlcnQvR0RDQV9UcnVzdEFVVEhfUjVfUk9PVC5kZXIwKQYIKwYBBQUHMAGGHWh0dHA6Ly9vY3NwMi5nZGNhLmNvbS5jbi9vY3NwMB0GA1UdDgQWBBTT&#x2F;u5hgMCZkFlt1iRV8v&#x2F;A6ycX7DAPBgNVHRMBAf8EBTADAQH&#x2F;MB8GA1UdIwQYMBaAFOLJQJ9NzuiaoXzPDj9lxSmIahlRMD8GA1UdIAQ4MDYwNAYEVR0gADAsMCoGCCsGAQUFBwIBFh5odHRwOi8vd3d3LmdkY2EuY29tLmNuL2Nwcy9jcHMwRgYDVR0fBD8wPTA7oDmgN4Y1aHR0cDovL2NybC5nZGNhLmNvbS5jbi9jcmwvR0RDQV9UcnVzdEFVVEhfUjVfUk9PVC5jcmwwDgYDVR0PAQH&#x2F;BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4ICAQCYCiHSNpsktHsGH+ZW&#x2F;gftV&#x2F;fKl14Vui9Eu1jb3XNEdz6gbh0Fz&#x2F;uRKJ468kmzcQpHD0pAHr5belKGyGb9OXUeNxZoscSd7AJqRO6NMnBD07CC1EyiQF5z9McqnnvpPc0wiDQ6CsIL3yaEZbFuEvPwhTTr3vyFnUk4gE52pMAIwO8IM51G9oe4UG98nqtMhDBiFJl1nUGajjHdY4eKKiDCI6WSoyOLIsTcGWiPjtd5+XWGYlrOgj2xrmGQK+KayF9k6j9mTGKmvunUpQWWIuw4yxYFT5gK9m10OcVo+Q++P46dQECznARIcz6bQuINS5FdmGqhBrHbXOlBwQ3Rw9Alstmn3BqTbWm7FV2K7U6lbpj&#x2F;DyxmG0927e5DkGJjjDMFELBHTuo34vv3OEjcaHcS&#x2F;fy9EuprXlYCe6atklBZj3jvJMD7jtmPxs4McshYN72wnzqWLVXibg&#x2F;mefi7kJEpy5DaOxwKIayxiH3XIW38TtVltc2d+MgYqIesCZO8QpoF&#x2F;M2o8aslAMhOIAOm4gAbqBdq&#x2F;115bVaIoJsCBe3TgrXqXyvX3nybU1K3vipkEyRKdFIqBTowbfChkJYZtBW7MNK42IWwQMr4egLjfTlf85Pveu2hrZqSikmPSalQo+SVQXTc&#x2F;lQG0Nlt1Jjr7DxXQRH3bUB4LQs+uOIqX46EmjGCAwMwggL&#x2F;AgEBMHswbzELMAkGA1UEBhMCQ04xOTA3BgNVBAoMMEdsb2JhbCBEaWdpdGFsIEN5YmVyc2VjdXJpdHkgQXV0aG9yaXR5IENvLiwgTHRkLjElMCMGA1UEAwwcR0RDQSBUcnVzdEFVVEggUjQgR2VuZXJpYyBDQQIIVAnE5PcrHMcwDQYJYIZIAWUDBAIBBQCgggFZMBoGCSqGSIb3DQEJAzENBgsqhkiG9w0BCRABBDAcBgkqhkiG9w0BCQUxDxcNMTgwMzA4MDIyNTQwWjAtBgkqhkiG9w0BCTQxIDAeMA0GCWCGSAFlAwQCAQUAoQ0GCSqGSIb3DQEBAQUAMC8GCSqGSIb3DQEJBDEiBCCVz3dtzV2yITPFPnbMuZoyH2UlgUJ+4edLBVzrVDJdOjCBvAYLKoZIhvcNAQkQAi8xgawwgakwgaYwgaMEIHMjXwMdZT6yhN2ec18IL0ZCr8eD2ya7PK8h24mvExJ0MH8wc6RxMG8xCzAJBgNVBAYTAkNOMTkwNwYDVQQKDDBHbG9iYWwgRGlnaXRhbCBDeWJlcnNlY3VyaXR5IEF1dGhvcml0eSBDby4sIEx0ZC4xJTAjBgNVBAMMHEdEQ0EgVHJ1c3RBVVRIIFI0IEdlbmVyaWMgQ0ECCFQJxOT3KxzHMA0GCSqGSIb3DQEBAQUABIIBAI9fYsYM1bAIPiAH0XX730qW5KuexYU+qA8h8EsCQId6Dy3XzTh2sJFaA8uSndPA33KVkCOzbKsKmd003Pqh6p40FonALCXe8hze6yfVuj2P1AdXXYGdX+&#x2F;GS+kfIunsGVjkdoeMNogVy7rzpb3dUEOluArSC8WRE&#x2F;DKA0vOOtJZ+gFSov5wyI8+U+Jsm77&#x2F;ZC86cUrlSG&#x2F;vdwKzd2rlYnrlRWJDZxdLdNf7Ds197eb7UQdxzq7R7tWx+c1lp5UJJ&#x2F;NnUs&#x2F;SNt5YjljuaXSNzbDNSoEC8leHrfmBXLkH7falGrsUIkgh&#x2F;QgXPMlMyCt2nqVNQum9Q57FLDPFy+5+1pg&#x3D;</span><br><span class="line">0</span><br><span class="line">Operation Okay</span><br></pre></td></tr></table></figure><p><strong>3.解析TimeStampResponse</strong></p><p>然后对TimeStampResponse进行解析。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-0c9b1fb4055ea3a924d43882e0c1ed33_720w.jpg" alt="img"></p><p>如上图，RFC3161中定义的TimeStampResp的结构中包含一个status,指示结果的状态码，本例中状态码返回为0，表示成功。另一个是TimeStampToken结构：</p><p><img src="images/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E6%97%B6%E9%97%B4%E6%88%B3/v2-f96da0e252a9823e4dcec6ac6e557122_720w.jpg" alt="img"></p><p>TimeStampToken是SignedData类型的ContentInfo，看过前几篇文章的同学肯定记得，PDF签名也是一个SignedData类型。</p><p>我们从Response里把TimeStampToken解析出来：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TimeStampToken tst &#x3D; response.getTimeStampToken();</span><br></pre></td></tr></table></figure><p>TimeStampToken的结构定义可以参考系列文章之二. SignedData结构中包含的eContent其实是原始数据。对于PDF数字签名来说，eContent一般为空，则代表detached signature，也就是表示被签名的原始数据在“签名”之外。对于TimeStampToken来说，eContent里是一个TSTInfo类型数据：</p><p><img src="images/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E6%97%B6%E9%97%B4%E6%88%B3/v2-37f76d707a2a28f00dfecb5ba2c3be82_720w.jpg" alt="img"></p><p>我们可以看见与时间戳有关的信息都在这些字段里，包括原始的数据指纹messageImprint，时间戳产生时间genTime，流水号SerialNumber,透传参数nonce,精度accuracy等等。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TimeStampTokenInfo tsti &#x3D; tst.getTimeStampInfo();</span><br><span class="line">Date data &#x3D; tsti.getGenTime();</span><br><span class="line">System.out.println(data.toString());</span><br><span class="line">System.out.println(&quot;tsti:hex\n&quot; + org.apache.commons.codec.binary.Hex.encodeHexString(tsti.getEncoded()));</span><br><span class="line">MessageDigest digest2 &#x3D; MessageDigest.getInstance(&quot;SHA-256&quot;);</span><br><span class="line">byte[] encodedhash2 &#x3D; digest2.digest(tsti.getEncoded());</span><br><span class="line">System.out.println(&quot;hash of tsti:hex\n&quot; + org.apache.commons.codec.binary.Hex.encodeHexString(encodedhash2));</span><br></pre></td></tr></table></figure><p>我们把TSTInfo对象解析出来，打印时间戳时间，并且把TSTInfo对象的原始二进制打印出来：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thu Mar 08 10:25:40 CST 2018</span><br><span class="line">tsti:hex</span><br><span class="line">3067020101060c2b0601040181af080102032d3031300d060960864801650304020105000420a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae30208297eca7161e78d7f180f32303138303330383032323534305a02060162036da0b2</span><br><span class="line">hash of tsti:hex</span><br><span class="line">95cf776dcd5db22133c53e76ccb99a321f652581427ee1e74b055ceb54325d3a</span><br></pre></td></tr></table></figure><p>因为后面会用到，我们在这里把TSTInfo的哈希值算出来了。</p><p><strong>下面来分析一下时间戳服务器的签名。</strong></p><p>在前面我们讲到PDF真正的签名值在SignedData下SignerInfo的Signature里，那么TimeStampToken也不例外，因为它也是一个SignedData类型。</p><p>与PDF签名一致，TimeStampToken也只允许一个签名值，也就是只存在一个SignerInfo，签名者是时间戳服务器。我们可以把时间戳服务器的签名证书解析出来：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Store store &#x3D; tst.getCertificates();</span><br><span class="line">SignerId sid &#x3D; tst.getSID();</span><br><span class="line">X509CertificateHolder cert &#x3D; (X509CertificateHolder)store.getMatches(sid).iterator().next();</span><br><span class="line">byte[] array &#x3D; cert1.getEncoded();</span><br><span class="line">System.out.println(&quot;cert: &quot; + new String(Base64.encode(array), &quot;UTF-8&quot;));</span><br></pre></td></tr></table></figure><p>从TimeStampInfo里得到证书列表，然后根据SignerInfo里的CertID找到该证书</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cert: MIIFCjCCA&#x2F;KgAwIBAgIIVAnE5PcrHMcwDQYJKoZIhvcNAQELBQAwbzELMAkGA1UEBhMCQ04xOTA3BgNVBAoMMEdsb2JhbCBEaWdpdGFsIEN5YmVyc2VjdXJpdHkgQXV0aG9yaXR5IENvLiwgTHRkLjElMCMGA1UEAwwcR0RDQSBUcnVzdEFVVEggUjQgR2VuZXJpYyBDQTAeFw0xNzA0MTMwNjQwMDZaFw0yNzA0MTEwNjQwMDZaMIGEMQswCQYDVQQGEwJDTjESMBAGA1UECAwJ5bm&#x2F;5Lic55yBMRIwEAYDVQQHDAnlub&#x2F;lt57luIIxLTArBgNVBAsMJOaVsOWuieaXtuS7o+enkeaKgOiCoeS7veaciemZkOWFrOWPuDEeMBwGA1UEAwwVR0RDQSBUaW1lc3RhbXAgU2lnbmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4wC9fArtnGSuKjGVtJgJ98ou5moCPVnv2dar9nkk0FLZ2105P2jfU6aT1BHcvk1k6cmjOKUyGfz5FBn06eF+e26y&#x2F;l25tzzQn&#x2F;ZRMfAelFWEmRbXNlOn54B5njJAdYNQU7IM&#x2F;ufKYLzBjuqMdZy9de66&#x2F;m5ExuXJThUh7Bf2K6T3aQePnv6XIJ9i6DztCbXwfyGRYf+jHWOrNItVl7QImcwoUR+Afa3x+d+zkc8HZuSCXMDiKm3WrmjzfLdkawzANLV7bxTKzCKfkoIXdVUFJabjZamthk6ksLi33g3N6TMPTNrBHGp&#x2F;y9Yt8bCwPbTwV3byS+BH7kL&#x2F;KNJSTbDjtQIDAQABo4IBkjCCAY4wgYMGCCsGAQUFBwEBBHcwdTBIBggrBgEFBQcwAoY8aHR0cDovL3d3dy5nZGNhLmNvbS5jbi9jZXJ0L0dEQ0FfVHJ1c3RBVVRIX1I0X0dlbmVyaWNfQ0EuZGVyMCkGCCsGAQUFBzABhh1odHRwOi8vb2NzcDIuZ2RjYS5jb20uY24vb2NzcDAdBgNVHQ4EFgQUAn2SnDTJycvFLNlKHleiM9XoioYwCQYDVR0TBAIwADAfBgNVHSMEGDAWgBTT&#x2F;u5hgMCZkFlt1iRV8v&#x2F;A6ycX7DBFBgNVHSAEPjA8MDoGCiqBHIbvLwEBAQIwLDAqBggrBgEFBQcCARYeaHR0cDovL3d3dy5nZGNhLmNvbS5jbi9jcHMvY3BzMEwGA1UdHwRFMEMwQaA&#x2F;oD2GO2h0dHA6Ly9jcmwuZ2RjYS5jb20uY24vY3JsL0dEQ0FfVHJ1c3RBVVRIX1I0X0dlbmVyaWNfQ0EuY3JsMA4GA1UdDwEB&#x2F;wQEAwIHgDAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDANBgkqhkiG9w0BAQsFAAOCAQEAqEWGYzFE58FpByBwPQDnU3KzvWyPdMIhd726SRjiOMIecjBqXpd0fi3KJ3+rq&#x2F;oCT8N8gSIezEzcXVPdJ2oCnHFaBZCUJOndvoOK1GM20oEnNnEYLvG6iilyAy5lDPqjbpmMYC6Hk4h8bnPMhUQNpDqEjpYKyisoN0dQh0viXPwmojahM+1CsYOlirC4NwTJVhcNA8ssB1Z74fGrNx+cSH7scA1IqTzVygtYUJ7MqQ5atXQw&#x2F;ji0Ofu4m4yRR+3fnjG3l23zmXH&#x2F;WehlzY4kuilhHBhD39N4WV7+a99JUoiqj8Ao&#x2F;hTjz7rVdOX9M1Zj4Tj1zWE1QDN02eNdwEql+w&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>得到证书的base64 code我们就可以解析证书信息了，这里不展开说明。</p><p>系列文章二说过，对于SignedData类型而言，真正的签名对象，其实是SignerInfo里的SignedAttributes, 对于TimeStampToken, 我们也来解析一下SignedAttributes里的信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">AttributeTable at &#x3D; tst.getSignedAttributes();</span><br><span class="line">        System.out.println(at.size());</span><br><span class="line">        Attributes attri &#x3D; at.toASN1Structure();</span><br><span class="line">        Attribute[] attris &#x3D; attri.getAttributes();</span><br><span class="line">        System.out.println(attris.length);</span><br><span class="line">        ASN1ObjectIdentifier asn1oid &#x3D; attris[0].getAttrType();</span><br><span class="line">        System.out.println(asn1oid.getId());</span><br><span class="line">        ASN1Set asn1sets &#x3D; attris[0].getAttrValues();</span><br><span class="line">        System.out.println(asn1sets.toString());</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1.2.840.113549.1.9.4</span><br><span class="line">[#95cf776dcd5db22133c53e76ccb99a321f652581427ee1e74b055ceb54325d3a]</span><br><span class="line">1.2.840.113549.1.9.3</span><br><span class="line">[1.2.840.113549.1.9.16.1.4]</span><br><span class="line">1.2.840.113549.1.9.52</span><br><span class="line">[[[2.16.840.1.101.3.4.2.1, NULL], [1][1.2.840.113549.1.1.1, NULL]]]</span><br><span class="line">1.2.840.113549.1.9.16.2.47</span><br><span class="line">[[[[#73235f031d653eb284dd9e735f082f4642afc783db26bb3caf21db89af131274, [[[4][[[2.5.4.6, CN]], [[2.5.4.10, Global Digital Cybersecurity Authority Co., Ltd.]], [[2.5.4.3, GDCA TrustAUTH R4 Generic CA]]]], 6055587661654727879]]]]]</span><br><span class="line">1.2.840.113549.1.9.5</span><br><span class="line">[180308022540Z]</span><br></pre></td></tr></table></figure><p>SignedAttributes里包含五个属性，第一个是MessageDigest, 我们打印出来的结果与上文中tsti的哈希值相同，说明这里的哈希值原文就是TSTInfo数据。另外的属性有证书信息，时间信息，算法信息，类型信息。对这些信息进行签名，得到了SignerInfo里的签名值Signature.</p><p>我们可以取得SignerInfo里SignedAttributes的二进制值和Signature的值，然后使用之前得到的证书进行公钥验证，验证结果正确。</p><p>签名原文：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">byte[] encodedSignedAttri &#x3D; signer.getEncodedSignedAttributes();</span><br><span class="line">System.out.println(&quot;encodedSignedAttri in signer infobase64:\n&quot; + new String(Base64.encode(encodedSignedAttri), &quot;UTF-8&quot;));</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">encodedSignedAttri in signer infobase64:</span><br><span class="line">MYIBWTAaBgkqhkiG9w0BCQMxDQYLKoZIhvcNAQkQAQQwHAYJKoZIhvcNAQkFMQ8XDTE4MDMwODAyMjU0MFowLQYJKoZIhvcNAQk0MSAwHjANBglghkgBZQMEAgEFAKENBgkqhkiG9w0BAQEFADAvBgkqhkiG9w0BCQQxIgQglc93bc1dsiEzxT52zLmaMh9lJYFCfuHnSwVc61QyXTowgbwGCyqGSIb3DQEJEAIvMYGsMIGpMIGmMIGjBCBzI18DHWU+soTdnnNfCC9GQq&#x2F;Hg9smuzyvIduJrxMSdDB&#x2F;MHOkcTBvMQswCQYDVQQGEwJDTjE5MDcGA1UECgwwR2xvYmFsIERpZ2l0YWwgQ3liZXJzZWN1cml0eSBBdXRob3JpdHkgQ28uLCBMdGQuMSUwIwYDVQQDDBxHRENBIFRydXN0QVVUSCBSNCBHZW5lcmljIENBAghUCcTk9yscxw&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>签名值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">byte[] signature &#x3D; signer.getSignature();</span><br><span class="line">System.out.println(&quot;signature in signer info:\n&quot; + new String(Base64.encode(signature), &quot;UTF-8&quot;));</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">signature in signer info:</span><br><span class="line">j19ixgzVsAg+IAfRdfvfSpbkq57FhT6oDyHwSwJAh3oPLdfNOHawkVoDy5Kd08DfcpWQI7NsqwqZ3TTc+qHqnjQWicAsJd7yHN7rJ9W6PY&#x2F;UB1ddgZ1f78ZL6R8i6ewZWOR2h4w2iBXLuvOlvd1QQ6W4CtILxZET8MoDS8460ln6AVKi&#x2F;nDIjz5T4mybvv9kLzpxSuVIb+93ArN3auVieuVFYkNnF0t01&#x2F;sOzX3t5vtRB3HOrtHu1bH5zWWnlQkn82dSz9I23liOWO5pdI3NsM1KgQLyV4et+YFcuQft9qUauxQiSCH9CBc8yUzIK3aepU1C6b1DnsUsM8XL7n7WmA&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>验证过程就不详述，笔者验证通过。</p><p>实验到这里就结束了。因为工作需要，笔者对数字签名和时间戳做了很底层很深入的研究，这个课题现在越来越普及了，但是网上讲得清楚且通俗的资料却很少，笔者记录下自己的一些研究发现，为将来做一个笔记备份，也为正在入门数字签名开发的伙伴提供一些参考。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;深入理解时间戳&quot;&gt;&lt;a href=&quot;#深入理解时间戳&quot; class=&quot;headerlink&quot; title=&quot;深入理解时间戳&quot;&gt;&lt;/a&gt;深入理解时间戳&lt;/h1&gt;&lt;p&gt;时间戳可谓数字签名的好伙伴，它为数字签名提供了额外的时间上的保证，使得数字签名的可信度大大提高。&lt;/p&gt;
&lt;p&gt;到底什么是时间戳？从PDF签名的角度来看，时间戳会直接表现在签名里：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-785c2ca9fb03c0c42e856a9f951fc5d9_720w.jpg&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
&lt;p&gt;在前两篇文章，我分析过PDF里的签名信息，也就是PDF dictionary里的content下的内容，其实是一个CMS对象. 而真正的签名值，也就是对一个哈希内容做的加密结果，其实是存在signerInfo下面的signature字段里。&lt;/p&gt;
&lt;p&gt;PDF签名的时间戳对象，其实就是这个签名值signature.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;时间戳的定义(wiki)&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Trusted timestamping&lt;/strong&gt; is the process of &lt;a href=&quot;https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Computer_security&quot;&gt;securely&lt;/a&gt; keeping track of the creation and modification time of a document. Security here means that no one—not even the owner of the document—should be able to change it once it has been recorded provided that the timestamper’s integrity is never compromised.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-095a8e6dacdeae7de3c844c30e30ecfa_720w.jpg&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200814/v2-b791900eab09c024c9fd872f8283cd22_720w.jpg&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="时间戳" scheme="https://blog.songuo.tech/categories/%E6%97%B6%E9%97%B4%E6%88%B3/"/>
    
    
      <category term="时间戳服务器" scheme="https://blog.songuo.tech/tags/%E6%97%B6%E9%97%B4%E6%88%B3%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>IDEA自动格式化代码</title>
    <link href="https://blog.songuo.tech/p/ef3d5f33.html"/>
    <id>https://blog.songuo.tech/p/ef3d5f33.html</id>
    <published>2020-07-30T03:19:53.000Z</published>
    <updated>2020-07-31T03:49:29.788Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1、settings-gt-plugins-选择-Browse-repositories…"><a href="#1、settings-gt-plugins-选择-Browse-repositories…" class="headerlink" title="1、settings -&gt; plugins 选择 Browse repositories…"></a>1、settings -&gt; plugins 选择 Browse repositories…</h3><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223937714280.png" alt="技术分享图片"></p><h3 id="2、搜索google-java-format-和-Save-Actions，安装"><a href="#2、搜索google-java-format-和-Save-Actions，安装" class="headerlink" title="2、搜索google-java-format 和 Save Actions，安装"></a>2、搜索google-java-format 和 Save Actions，安装</h3><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223937892022.png" alt="技术分享图片"></p><h3 id="3、重启IDE，启用google-java-format"><a href="#3、重启IDE，启用google-java-format" class="headerlink" title="3、重启IDE，启用google-java-format"></a>3、重启IDE，启用google-java-format</h3><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223938049254.png" alt="技术分享图片"></p><h3 id="4、-启用Save-Actions"><a href="#4、-启用Save-Actions" class="headerlink" title="4、 启用Save Actions"></a>4、 启用Save Actions</h3><p>保存时自动格式化 ，将没用的import 语句删除</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223938160587.png" alt="技术分享图片"></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;1、settings-gt-plugins-选择-Browse-repositories…&quot;&gt;&lt;a href=&quot;#1、settings-gt-plugins-选择-Browse-repositories…&quot; class=&quot;headerlink&quot; title=&quot;1、settings -&amp;gt; plugins 选择 Browse repositories…&quot;&gt;&lt;/a&gt;1、settings -&amp;gt; plugins 选择 Browse repositories…&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223937714280.png&quot; alt=&quot;技术分享图片&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;2、搜索google-java-format-和-Save-Actions，安装&quot;&gt;&lt;a href=&quot;#2、搜索google-java-format-和-Save-Actions，安装&quot; class=&quot;headerlink&quot; title=&quot;2、搜索google-java-format 和 Save Actions，安装&quot;&gt;&lt;/a&gt;2、搜索google-java-format 和 Save Actions，安装&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223937892022.png&quot; alt=&quot;技术分享图片&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;3、重启IDE，启用google-java-format&quot;&gt;&lt;a href=&quot;#3、重启IDE，启用google-java-format&quot; class=&quot;headerlink&quot; title=&quot;3、重启IDE，启用google-java-format&quot;&gt;&lt;/a&gt;3、重启IDE，启用google-java-format&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223938049254.png&quot; alt=&quot;技术分享图片&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;4、-启用Save-Actions&quot;&gt;&lt;a href=&quot;#4、-启用Save-Actions&quot; class=&quot;headerlink&quot; title=&quot;4、 启用Save Actions&quot;&gt;&lt;/a&gt;4、 启用Save Actions&lt;/h3&gt;&lt;p&gt;保存时自动格式化 ，将没用的import 语句删除&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/20180731223938160587.png&quot; alt=&quot;技术分享图片&quot;&gt;&lt;/p&gt;

    
    </summary>
    
    
      <category term="idea" scheme="https://blog.songuo.tech/categories/idea/"/>
    
    
      <category term="idea" scheme="https://blog.songuo.tech/tags/idea/"/>
    
  </entry>
  
  <entry>
    <title>IDEA自动导包设置</title>
    <link href="https://blog.songuo.tech/p/7e18c401.html"/>
    <id>https://blog.songuo.tech/p/7e18c401.html</id>
    <published>2020-07-30T01:19:53.000Z</published>
    <updated>2020-07-31T03:49:29.761Z</updated>
    
    <content type="html"><![CDATA[<p><strong>1、配置</strong></p><p>进入file-setting</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/905646-20190916093225567-2095910444.png" alt="img"></p><h2 id="2、说明"><a href="#2、说明" class="headerlink" title="2、说明"></a>2、说明</h2><ul><li>勾选标注第1个选项，IDEA 自动帮我们导入需要用到的包。但是对于那些同名的包，还是需要手动 Alt + Enter 进行导入的</li><li>勾选标注第2个选项，IDEA自动帮我们优化导入的包，比如自动去掉一些没有用到的包。</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;1、配置&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;进入file-setting&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/jooejooe/images/image/20200731/905646-20190916093225567-2095910444.png&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;2、说明&quot;&gt;&lt;a href=&quot;#2、说明&quot; class=&quot;headerlink&quot; title=&quot;2、说明&quot;&gt;&lt;/a&gt;2、说明&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;勾选标注第1个选项，IDEA 自动帮我们导入需要用到的包。但是对于那些同名的包，还是需要手动 Alt + Enter 进行导入的&lt;/li&gt;
&lt;li&gt;勾选标注第2个选项，IDEA自动帮我们优化导入的包，比如自动去掉一些没有用到的包。&lt;/li&gt;
&lt;/ul&gt;

    
    </summary>
    
    
      <category term="idea" scheme="https://blog.songuo.tech/categories/idea/"/>
    
    
      <category term="idea" scheme="https://blog.songuo.tech/tags/idea/"/>
    
  </entry>
  
  <entry>
    <title>ES版本对应jdk</title>
    <link href="https://blog.songuo.tech/p/eff808.html"/>
    <id>https://blog.songuo.tech/p/eff808.html</id>
    <published>2020-07-24T01:19:53.000Z</published>
    <updated>2020-07-24T00:47:54.055Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.elastic.co/cn/support/matrix#matrix_jvm" target="_blank" rel="noopener">Elasticsearch and JVM</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.elastic.co/cn/support/matrix#matrix_jvm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Elasticsearch and JVM&lt;/a&gt;&lt;/p&gt;

    
    </summary>
    
    
      <category term="ES" scheme="https://blog.songuo.tech/categories/ES/"/>
    
    
      <category term="ES" scheme="https://blog.songuo.tech/tags/ES/"/>
    
  </entry>
  
  <entry>
    <title>诉源治理规范化建设的现实解决路径</title>
    <link href="https://blog.songuo.tech/p/b8d2e867.html"/>
    <id>https://blog.songuo.tech/p/b8d2e867.html</id>
    <published>2020-07-12T07:19:53.000Z</published>
    <updated>2020-07-24T00:47:54.161Z</updated>
    
    <content type="html"><![CDATA[<p>《最高人民法院关于深化人民法院司法体制综合配套改革的意见 ——人民法院第五个五年改革纲要(2019—2023)》简称“五五改革纲要”，首次提出“诉源治理”这一概念。何为“诉源治理”？“五五改革纲要”并未给予进一步的解释。笔者经搜索国内各文献，鲜有人对“诉源治理”这一概念进行解析，仅在四川省成都市中级人民法院院长郭彦撰写的文章中搜索到：“<strong>‘诉源治理’是指社会个体及各种机构对纠纷的预防及化解所采取的各项措施、方式和方法，使潜在纠纷和已出现纠纷的当事人的相关利益和冲突得以调和，并且采取联合行动所持续的过程。</strong>”笔者认为，“诉源治理”重在强调“源”，纠纷性质为“诉”，手段为“治理”，可理解为对诉讼纠纷的源头化解及处理机制。最高院提出强化诉源治理，即是从法院视角下，要求全国各级法院推动从源头上减少诉讼增量而采取引领、分流等各项举措。</p><a id="more"></a><p>一、法院在诉源治理实质化过程中角色定位的优劣分析</p><p>1.法院在诉源治理中的优势价值分析。从职能定位角度来讲，法院是化解社会纠纷和保障公民权利的国家机关，是维护社会公平、正义的最后一道防线。我国宪法和法律赋予人民法院行使审判权的职能，司法解决是当今社会化解纠纷最权威的方式。从专业化角度来讲，法院作为专门化解纠纷的司法机关，无论是庭室设置或者法官适用法律化解纠纷的能力都是专业的。从效率角度来讲，法院调解可以跳过诉讼中纷繁复杂的程序限制，仅就纠纷的矛盾点直接进行讨论和评判，节约了时间成本、人力成本，也极大的节约了司法资源，也提高了当事人解决纠纷的效率。</p><p>2.法院在诉源治理中的局限分析。从社会治理效果而言，法院并非是基层治理的领导者和直接责任人，在很多纠纷化解工作中不足以起到立竿见影的效果。熟人社会里，刚硬的法条有的时候不如熟人的几句规劝来得更让当事人心服，司法解决并非是化解纠纷最好的方式。有些前期未处理好的纠纷最终进入司法程序，法院调解无果后依法裁判，但效果并不理想，甚至在后期执行中引发群体性事件。有些涉及群体众多、社会覆盖面大的案件，党委、政府在大调解工作中的组织力量更具优势。治理效果更彻底，这也是在党委、政府还是人民调解组织的调解工作中得以达成调解协议的案件很少到法院申请司法确认的原因。</p><p>基于上述分析，诉源治理应当是构建由党委政府主导、多方协调、统筹发展、合力加强调解技能培训的组织格局。法院在诉源治理过程中有其局限性——司法功能的有限延伸，法院应当是提供指导服务、构建诉讼与非诉讼的衔接机制、助推调解队伍专业化发展、行使终局司法裁决职能的角色定位。</p><p>二、法院视角下当前诉源治理中存在的问题</p><p>1.参与社会治理的各方主体存在的问题。就目前现状而言，主要表现在：诉源治理过程中行业主管部门主动参与度不够，未能充分发挥行业的能动性与专业性；诉源治理过程中调解能力不强，覆盖面虽广，但业务精度不够；诉源治理过程中民调组织专项运行经费不足，缺乏提升调解员技能的长效培训机制等。</p><p>2.替代性纠纷解决机制及其他专业资源未能充分利用。我国社会多元化的利益冲突和复杂的纠纷类型迫切要求纠纷解决机制的多元化，诉讼并非唯一的解决纠纷手段。仲裁机制的参与度不够；公证机构参与社会治理的广度和深度有待加强；律师专业化队伍未能充分利用。</p><p>3.其他方面的问题。如诉源治理过程中配套程序衔接不畅，当前大部分调解机制的运行仍属各自为政。当事人社会心理的变化与“程序选择权”的相关性，在熟人社会背景下，当事人基于乡风、民约和道德约束，认为打官司是一件“丢脸”的事，进而产生“厌讼”心理，当事人倾向于通过相对平和的调解模式解决问题。伴随着城市化进程和人员的频繁流动，熟人社会逐渐转换为陌生人社会，当事人社会心理逐渐产生变化，陌生人的社会环境中，一方面当事人不再耽于他人“指摘”，另一方面双方当事人活动区域跨市甚至跨省，基层调解组织在化解矛盾时也会存在用不上力的情况。</p><p>三、诉源治理的规范化建设的现实解决路径</p><p>1.多方联动构建系统化诉源治理力量。充分发挥党委、政府的政治优势，广泛动员各部门、各行业的力量，有效整合各种社会资源。同时发挥法院作为定纷止争的权力机关的权威性和技术性，对诉源治理中其他调解主体进行业务上的培训与指导，形成党委政府主导、法院指导服务、多方协调、统筹发展的组织格局。</p><p>2.理顺诉调对接衔接。一方面，加强与各调解组织的沟通联络。引导调解员进驻法院，作为法院与各调解组织的联络员，随时接受法院法官的指导，并对到法院准备立案的当事人给予及时的引导，引导当事人选择相应的调解组织先行调解。另一方面，强化法院的指导、监督作用。各调解组织可联系法院对特别复杂案件进行全程指导调解，包括对法律法规的适用、调解的方法与技巧等。同时法院也可以及时询问相关组织在调解过程中争议的焦点，方便法院的裁判。调解组织可以参与到法院的庭审和调解的过程中，让其熟悉诉讼流程，并进一步学习调解方法和技巧，提高业务能力。同时对调解员进行定期或不定期的业务培训和实务指导。最后，法院要加大对纠纷非诉解决方式的监督，确保其公平和正义，防止纠纷解决的随意性，提高非诉调解的社会公信力。</p><p>3.加强调解技能培训，助推调解队伍专业化发展。成立规模化、专门化的调解技能培训班，邀请经验丰富的资深调解员对各调解机制中的调解员分类进行指导培训。以经验交流、情景模拟的方式传授调解技巧，以老带新，以促进全县调解员的整体业务水平的提高，帮助新进调解员尽快适应调解工作。</p><p>4.数据互联与价值挖掘。数据采集和分析是提升诉源治理的重要因素，诉源治理工作中容易出现各自为战的情况，各方在诉源治理方面中化解多少案件、问题集中于哪些方面、需要补强何种力量、需要查摆哪些漏洞，法院需要基层组织或其他替代性纠纷解决机制在何种环节介入，通通存在信息不对称的情况，数据不通，各方的优势价值无法得以挖掘，劣势无法补足。加强信息化建设，搭建统一信息平台，实现信息对称，将有利于诉源治理的数据得到深挖。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;《最高人民法院关于深化人民法院司法体制综合配套改革的意见 ——人民法院第五个五年改革纲要(2019—2023)》简称“五五改革纲要”，首次提出“诉源治理”这一概念。何为“诉源治理”？“五五改革纲要”并未给予进一步的解释。笔者经搜索国内各文献，鲜有人对“诉源治理”这一概念进行解析，仅在四川省成都市中级人民法院院长郭彦撰写的文章中搜索到：“&lt;strong&gt;‘诉源治理’是指社会个体及各种机构对纠纷的预防及化解所采取的各项措施、方式和方法，使潜在纠纷和已出现纠纷的当事人的相关利益和冲突得以调和，并且采取联合行动所持续的过程。&lt;/strong&gt;”笔者认为，“诉源治理”重在强调“源”，纠纷性质为“诉”，手段为“治理”，可理解为对诉讼纠纷的源头化解及处理机制。最高院提出强化诉源治理，即是从法院视角下，要求全国各级法院推动从源头上减少诉讼增量而采取引领、分流等各项举措。&lt;/p&gt;
    
    </summary>
    
    
      <category term="法律知识" scheme="https://blog.songuo.tech/categories/%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="诉源治理" scheme="https://blog.songuo.tech/tags/%E8%AF%89%E6%BA%90%E6%B2%BB%E7%90%86/"/>
    
  </entry>
  
</feed>
