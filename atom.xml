<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>松果小站</title>
  
  <subtitle>松果小站博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.songuo.tech/"/>
  <updated>2021-08-09T07:37:26.019Z</updated>
  <id>https://blog.songuo.tech/</id>
  
  <author>
    <name>松鼠</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux定时删除文件</title>
    <link href="https://blog.songuo.tech/p/e76f239a.html"/>
    <id>https://blog.songuo.tech/p/e76f239a.html</id>
    <published>2021-08-09T02:30:00.000Z</published>
    <updated>2021-08-09T07:37:26.019Z</updated>
    
    <content type="html"><![CDATA[<ol><li>创建shellauto-del-files.sh</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch /home/suzhuichang/auto-del-files.sh</span><br><span class="line"></span><br><span class="line">chmod +x auto-del-files.sh</span><br></pre></td></tr></table></figure><p>新建一个可执行文件auto-del-files.sh，并分配可运行权限<a id="more"></a></p><p>2.编辑shell脚本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi auto-del-files.sh</span><br></pre></td></tr></table></figure><p>编辑auto-del-files.sh文件如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line">find /home/suzhuichang/importZipDes -mtime +10 -name "*" -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><p>ok，保存退出(:wq)</p><p>3.计划任务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>将auto-del-files.sh执行脚本加入到系统计划任务，到点自动执行.输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10 0 * * * /home/suzhuichang/auto-del-files.sh</span><br></pre></td></tr></table></figure><p>这里的设置是每天凌晨0点10分执行auto-del-files.sh文件进行数据清理任务了。</p><p>4.错误 -bash: xxx: /bin/sh^M: bad interpreter: No such file or directory</p><p>使用notepad++打开sh文件，将文件转为Unix(LF) UTF-8格式保存，上传即可。</p><p>参考资料：</p><p><a href="http://c.biancheng.net/view/1092.html" target="_blank" rel="noopener">http://c.biancheng.net/view/1092.html</a></p><p><a href="https://tool.lu/crontab/" target="_blank" rel="noopener">https://tool.lu/crontab/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;创建shellauto-del-files.sh&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;touch /home/suzhuichang/auto-del-files.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chmod +x auto-del-files.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;新建一个可执行文件auto-del-files.sh，并分配可运行权限
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="linux" scheme="https://blog.songuo.tech/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>office在线预览以及在线编辑1</title>
    <link href="https://blog.songuo.tech/p/4c4ebf52.html"/>
    <id>https://blog.songuo.tech/p/4c4ebf52.html</id>
    <published>2021-07-01T03:31:00.000Z</published>
    <updated>2021-07-01T03:27:55.213Z</updated>
    
    <content type="html"><![CDATA[<p>做OA或者工作流程的网站中，常常能够看到一些在线Word编辑进行文档处理的功能，这里我开发了一个在线Word编辑插件并且以此为例。<a id="more"></a></p><p><strong>1．NTKO Word在线编辑器介绍：</strong></p><p>NTKO的官方网站：<a href="http://www.ntko.com/" target="_blank" rel="noopener">http://www.ntko.com/</a><br> NTKO OFFICE文档控件是拥有完全自主知识产权的ActiveX控件。使用NTKO Office文档控件，能够在浏览器中直接编辑Word,Excel等Office文档，或者WPS，金山电子表等文档并保存到web服务器。实现文档和电子表格的统一管理。NTKO OFFICE文档控件具有在线编辑，痕迹保留，手写签名，模板套红，安全电子印章[企业版提供]，全屏批注，保存为HTML,MHT,PDF文件等办公自动化系统必备的功能。可以运行在PHP，ASP，JSP，C#，VB.NET，DOMINO等各种web编程语言和服务器。</p><p><strong>2．列出完整的jQuery插件的代码清单：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br></pre></td><td class="code"><pre><span class="line">jquery.ntko.js</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  @author: Leepy</span></span><br><span class="line"><span class="comment"> *  @date:  2010-12</span></span><br><span class="line"><span class="comment"> *  @descript:  ntko word编辑器JQ插件</span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">        $.ntko = $.ntko || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        $.fn.extend(</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//文件类型</span></span><br><span class="line">            fileType: &#123;</span><br><span class="line">                Word: <span class="string">"Word.Document"</span>,</span><br><span class="line">                Excel: <span class="string">"Excel.Sheet"</span>,</span><br><span class="line">                PowerPoint: <span class="string">"PowerPoint.Show"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//弹出窗类型</span></span><br><span class="line">            showDialogType: &#123;</span><br><span class="line">                New: <span class="number">0</span>,</span><br><span class="line">                Open: <span class="number">1</span>,</span><br><span class="line">                Save: <span class="number">2</span>,</span><br><span class="line">                SaveCopy: <span class="number">3</span>,</span><br><span class="line">                Print: <span class="number">4</span>,</span><br><span class="line">                PageSetup: <span class="number">5</span>,</span><br><span class="line">                Properties: <span class="number">6</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//Word信息内容</span></span><br><span class="line">            wordInfo: &#123;</span><br><span class="line">                Start: <span class="number">0</span>,</span><br><span class="line">                End: <span class="number">0</span>,</span><br><span class="line">                Text: <span class="string">"NDOFramer"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//表单设置</span></span><br><span class="line">            formSettings: &#123;</span><br><span class="line">                UploadFileId: <span class="string">"EDITFILE"</span>,</span><br><span class="line">                Data: <span class="string">"savetype=1&amp;fileType="</span>,</span><br><span class="line">                FileName: <span class="string">"demo.doc"</span>,</span><br><span class="line">                FormId: <span class="number">0</span></span><br><span class="line">            &#125;,</span><br><span class="line">            _doc: <span class="literal">null</span>,</span><br><span class="line">            _selection: <span class="literal">null</span>,</span><br><span class="line">            _range: <span class="literal">null</span>,</span><br><span class="line">            <span class="comment">//初始化插件</span></span><br><span class="line">            ntko: <span class="function"><span class="keyword">function</span>(<span class="params">parameters</span>) </span>&#123;</span><br><span class="line">                parameters = parameters || &#123;&#125;;</span><br><span class="line">                <span class="keyword">var</span> ndObj = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">                    ndObj = $.ntko.init(<span class="keyword">this</span>, parameters);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span> ndObj;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//关闭插件</span></span><br><span class="line">            close: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].close();</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//打开文档</span></span><br><span class="line">            open: <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].BeginOpenFromURL(url);   <span class="comment">//第二个参数为只读设置</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//新建Word文档</span></span><br><span class="line">            newWord: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].CreateNew(<span class="keyword">this</span>.fileType.Word);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//新建Excel文档</span></span><br><span class="line">            newExcel: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].CreateNew(<span class="keyword">this</span>.fileType.Excel);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//新建PowerPoint文档</span></span><br><span class="line">            newPowerPoint: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].CreateNew(<span class="keyword">this</span>.fileType.PowerPoint);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//打开本地文档</span></span><br><span class="line">            openLocalFile: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].showdialog(<span class="keyword">this</span>.showDialogType.Open);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//保存到本地</span></span><br><span class="line">            saveLocalFile: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument.Application.Dialogs(<span class="number">83</span>).Show()</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//保存文档，返回是否保存成功</span></span><br><span class="line">            save: <span class="function"><span class="keyword">function</span>(<span class="params">url, parameters</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.formId) !== <span class="string">"undefined"</span>)</span><br><span class="line">                    <span class="keyword">this</span>.formSettings.FormId = parameters.formId;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.data) !== <span class="string">"undefined"</span>)</span><br><span class="line">                    <span class="keyword">this</span>.formSettings.Data = parameters.data;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> retHTML = <span class="keyword">this</span>[<span class="number">0</span>].saveToURL(url,    <span class="comment">//提交到的url地址</span></span><br><span class="line">                    <span class="keyword">this</span>.formSettings.UploadFileId,     <span class="comment">//文件域的id，类似&lt;input type=file id=upLoadFile 中的id</span></span><br><span class="line">                    <span class="keyword">this</span>.formSettings.Data,             <span class="comment">//与控件一起提交的参数,savetype参数为要保存的文件格式office,html,pdf。filetype参数保存文件类型</span></span><br><span class="line">                    <span class="keyword">this</span>.formSettings.FileName,         <span class="comment">//上传文件的名称，类似&lt;input type=file 的value</span></span><br><span class="line">                    <span class="keyword">this</span>.formSettings.FormId            <span class="comment">//与控件一起提交的表单id，也可以是form的序列号，这里应该是0.</span></span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">return</span> retHTML;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//下载远程文件</span></span><br><span class="line">            downloadFile: <span class="function"><span class="keyword">function</span>(<span class="params">url, localPath</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].DownloadFile(url, localPath);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//插入本地文档</span></span><br><span class="line">            insertLocalFile: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument.Application.Dialogs(<span class="number">164</span>).Show();</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//插入文档</span></span><br><span class="line">            insertFile: <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>._doc = <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument;</span><br><span class="line">                <span class="keyword">this</span>._doc.Activate();</span><br><span class="line">                <span class="comment">//                this._doc.Select();</span></span><br><span class="line">                <span class="comment">//                this._doc.Application.Selection.Select();</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].AddTemplateFromURL(url);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//插入本地图片</span></span><br><span class="line">            insertLocalImage: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument.Application.Dialogs(<span class="number">163</span>).Show();</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//插入图片</span></span><br><span class="line">            insertImage: <span class="function"><span class="keyword">function</span>(<span class="params">url, type</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].InsertFile(url, type + <span class="number">8</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//插入文本</span></span><br><span class="line">            insertText: <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>._doc = <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument;</span><br><span class="line">                <span class="keyword">this</span>._doc.Activate();</span><br><span class="line">                <span class="keyword">this</span>._doc.Application.Selection.InsertAfter(text);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//页面设置</span></span><br><span class="line">            setPageSetup: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].showdialog(<span class="keyword">this</span>.showDialogType.PageSetup);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//文档属性设置</span></span><br><span class="line">            setProperty: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].showdialog(<span class="keyword">this</span>.showDialogType.Properties);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//打印</span></span><br><span class="line">            print: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">//                this[0].PrintOut();</span></span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].showdialog(<span class="keyword">this</span>.showDialogType.Print);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//打印预览</span></span><br><span class="line">            printPreview: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].PrintPreview();</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//关闭打印预览</span></span><br><span class="line">            printExit: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].PrintPreviewExit();</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//隐藏工具栏</span></span><br><span class="line">            hideToolbar: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Activate(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Toolbars = <span class="literal">false</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//显示工具栏</span></span><br><span class="line">            showToolbar: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Activate(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Toolbars = <span class="literal">true</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//隐藏菜单栏</span></span><br><span class="line">            hideMenubar: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Activate(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Menubar = <span class="literal">false</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//显示菜单栏</span></span><br><span class="line">            showMenubar: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Activate(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Menubar = <span class="literal">true</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//获取或设置窗口高度</span></span><br><span class="line">            height: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> (arg) !== <span class="string">"undefined"</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.css(<span class="string">"height"</span>,arg);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.css(<span class="string">"height"</span>); ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//获取或设置窗口宽度</span></span><br><span class="line">            width: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> (arg) !== <span class="string">"undefined"</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.css(<span class="string">"width"</span>, arg);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.css(<span class="string">"width"</span>); ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//删除本地路径，如c:\\1.doc</span></span><br><span class="line">            deleteLocalFile: <span class="function"><span class="keyword">function</span>(<span class="params">localPath</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].DeleteLocalFile(localPath);</span><br><span class="line">            &#125;,</span><br><span class="line">            showView: <span class="function"><span class="keyword">function</span>(<span class="params">showViewType</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].Activate(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument.ActiveWindow.View = showViewType;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//添加本地附加文件</span></span><br><span class="line">            <span class="comment">//            addLocalFile: function(fileID,locaPath) &#123;</span></span><br><span class="line">            <span class="comment">//                this[0].HttpAddPostFile(fileID, locaPath);</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//            hostName: function() &#123;</span></span><br><span class="line">            <span class="comment">//                return this[0].HostName;</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//            documentFullName: function() &#123;</span></span><br><span class="line">            <span class="comment">//                return this[0].DocumentFullName;</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//            caption: function() &#123;</span></span><br><span class="line">            <span class="comment">//                return this[0].Caption;</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//            track: function() &#123;</span></span><br><span class="line">            <span class="comment">//                this[0].SetCurrUserName("liping");</span></span><br><span class="line">            <span class="comment">//                this[0].SetTrackRevisions(1);</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//            showTrack: function() &#123;</span></span><br><span class="line">            <span class="comment">//                this[0].ShowRevisions(1);</span></span><br><span class="line">            <span class="comment">//                this[0].ShowView(0);</span></span><br><span class="line">            <span class="comment">//            &#125;,</span></span><br><span class="line">            <span class="comment">//是否只读</span></span><br><span class="line">            isReadOnly: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>[<span class="number">0</span>].IsReadOnly;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//文档是否已做修改</span></span><br><span class="line">            isDirty: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> !<span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument.Saved;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//获取文档所有内容，返回该Word文档内容Json</span></span><br><span class="line">            range: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>._doc = <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument;</span><br><span class="line">                <span class="keyword">this</span>._doc.Activate();</span><br><span class="line">                <span class="keyword">this</span>._range = <span class="keyword">this</span>._doc.Range();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">this</span>.wordInfo.Start = <span class="keyword">this</span>._range.Start;</span><br><span class="line">                <span class="keyword">this</span>.wordInfo.End = <span class="keyword">this</span>._range.End;</span><br><span class="line">                <span class="keyword">this</span>.wordInfo.Text = <span class="keyword">this</span>._doc.Range(<span class="keyword">this</span>._range.Start, <span class="keyword">this</span>._range.End).Text;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.wordInfo;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//选中文档所有内容，返回该Word文档内容Json</span></span><br><span class="line">            select: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">this</span>._doc = <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument;</span><br><span class="line">                <span class="keyword">this</span>._doc.Activate();</span><br><span class="line">                <span class="keyword">this</span>._doc.Select();</span><br><span class="line">                <span class="keyword">this</span>._selection = <span class="keyword">this</span>._doc.Application.Selection;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">this</span>.wordInfo.Start = <span class="keyword">this</span>._selection.Start;</span><br><span class="line">                <span class="keyword">this</span>.wordInfo.End = <span class="keyword">this</span>._selection.End;</span><br><span class="line">                <span class="keyword">this</span>.wordInfo.Text = <span class="keyword">this</span>._doc.Range(<span class="keyword">this</span>._selection.Start, <span class="keyword">this</span>._selection.End).Text;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.wordInfo;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//取消选中内容</span></span><br><span class="line">            unselect: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>._selection != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">this</span>._selection.Start = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">this</span>._selection.End = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">this</span>._selection = <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            replace: <span class="function"><span class="keyword">function</span>(<span class="params">text, start, end</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//                alert(this._doc.Range(start,end).Text);</span></span><br><span class="line">                <span class="keyword">this</span>._doc.Range(start, end).Text = text;</span><br><span class="line">                <span class="comment">//                alert(this._doc.range(this.wordInfo.Starti,this.wordInfo.End).Text);</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//清除文本</span></span><br><span class="line">            clear: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> wordDoc = <span class="keyword">this</span>[<span class="number">0</span>].ActiveDocument;</span><br><span class="line">                wordDoc.Activate();</span><br><span class="line">                wordDoc.Select();</span><br><span class="line">                <span class="keyword">var</span> wordSelection = wordDoc.Application.Selection;</span><br><span class="line">                wordDoc.Range(wordSelection.Start, wordSelection.End).Text = <span class="string">""</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        $.extend($.ntko,</span><br><span class="line">            &#123;</span><br><span class="line">                settings:</span><br><span class="line">                &#123;</span><br><span class="line">                    folder: <span class="string">""</span>,</span><br><span class="line">                    width: <span class="string">"700px"</span>,</span><br><span class="line">                    height: <span class="string">"500px"</span>,</span><br><span class="line">                    id: <span class="string">"OFRAMER_"</span> + <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(),</span><br><span class="line">                    isToolbar: <span class="literal">true</span>,</span><br><span class="line">                    isMenubar: <span class="literal">true</span>,</span><br><span class="line">                    failed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                init: <span class="function"><span class="keyword">function</span>(<span class="params">obj, parameters</span>) </span>&#123;</span><br><span class="line">                    <span class="comment">//赋值参数</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.folder) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.folder = parameters.folder;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.width) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.width = parameters.width;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.height) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.height = parameters.height;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.id) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.id = parameters.id;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.isToolbar) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.isToolbar = parameters.isToolbar;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.isMenubar) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.isMenubar = parameters.isMenubar;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> (parameters.failed) !== <span class="string">"undefined"</span>)</span><br><span class="line">                        <span class="keyword">this</span>.settings.failed = parameters.failed || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//构造插件Html</span></span><br><span class="line">                    <span class="keyword">this</span>._createHTML(obj);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> acxId = <span class="keyword">this</span>.settings.id;</span><br><span class="line">                    <span class="keyword">var</span> acxJQjery = <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">var</span> failed = <span class="keyword">this</span>.settings.failed;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//判断是否安装了word编辑器插件</span></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="built_in">document</span>.getElementById(acxId).Close();</span><br><span class="line">                        acxJQjery = $(<span class="string">"#"</span> + acxId);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                        failed(e);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> acxJQjery;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//构造插件Html</span></span><br><span class="line">                _createHTML: <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">                    $(obj).html(</span><br><span class="line">                        <span class="keyword">this</span>._stringFormat(<span class="string">"&lt;object classid=\"clsid:A39F1330-3322-4a1d-9BF0-0BA2BB90E970\" codebase=\"&#123;0&#125;/officecontrol.cab#version=5,0,0,6\""</span> +</span><br><span class="line">                        <span class="string">"id=\"&#123;1&#125;\" width=\"&#123;2&#125;\" height=\"&#123;3&#125;\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"wmode\" value=\"transparent\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"_ExtentX\" value=\"16960\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"_ExtentY\" value=\"13600\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"BorderColor\" value=\"-2147483632\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"BackColor\" value=\"-2147483643\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"ForeColor\" value=\"-2147483640\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"TitlebarColor\" value=\"-2147483635\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"TitlebarTextColor\" value=\"-2147483634\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"BorderStyle\" value=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"Titlebar\" value=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"Statusbar\" value=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"Toolbars\" value=\"&#123;4&#125;\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"Menubar\" value=\"&#123;5&#125;\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"_ExtentX\" VALUE=\"18071\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"_ExtentY\" VALUE=\"20981\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsShowToolMenu\" VALUE=\"1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsNoCopy\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsHiddenOpenURL\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"MaxUploadSize\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileNew\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileOpen\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileClose\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileSave\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileSaveAs\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FilePrint\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FilePrintPreview\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FilePageSetup\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"FileProperties\" VALUE=\"-1\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsStrictNoCopy\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsUseUTF8URL\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"MenubarColor\" VALUE=\"-2147483643\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsUseControlAgent\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsUseUTF8Data\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsSaveDocExtention\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsDirectConnect\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"SignCursorType\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsResetToolbarsOnOpen\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;param name=\"IsSaveDataIfHasVDS\" VALUE=\"0\"&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;/object&gt;"</span>,</span><br><span class="line">                        <span class="keyword">this</span>.settings.folder,</span><br><span class="line">                        <span class="keyword">this</span>.settings.id,</span><br><span class="line">                        <span class="keyword">this</span>.settings.width,</span><br><span class="line">                        <span class="keyword">this</span>.settings.height,</span><br><span class="line">                        <span class="keyword">this</span>.settings.isToolbar + <span class="string">""</span> == <span class="string">"true"</span> ? <span class="string">"1"</span> : <span class="string">"0"</span>,</span><br><span class="line">                        <span class="keyword">this</span>.settings.isMenubar + <span class="string">""</span> == <span class="string">"true"</span> ? <span class="string">"1"</span> : <span class="string">"0"</span></span><br><span class="line">                        ));</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//string格式化构造器</span></span><br><span class="line">                _stringFormat: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">                    <span class="keyword">return</span> str.replace(<span class="regexp">/\&#123;(\d+)\&#125;/g</span>,</span><br><span class="line">                        <span class="function"><span class="keyword">function</span>(<span class="params">m, i</span>) </span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> args[<span class="built_in">parseInt</span>(i) + <span class="number">1</span>];</span><br><span class="line">                        &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">)(jQuery);</span><br></pre></td></tr></table></figure><p><strong>3**</strong>．这里要注意几个问题，**首先在保存文档到远程服务器的时候，可以使用aspx页面或者ashx页面去处理。</p><p>具体调用的代码：jqObj.save(“process.aspx?action=test&amp;data=demo”, { formId: “formeditor” });<br>可以发现我这里有个formId的参数，这个是因为我必须把Word插件必须放在Form标签中，这样在POST数据，也就是文件流的时候有用。<br> 而在process.aspx页面中，的具体代码实现为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">    &#123;</span><br><span class="line">        Response.ContentEncoding &#x3D; Encoding.GetEncoding(&quot;GB2312&quot;);</span><br><span class="line">        string action &#x3D; Request.QueryString[&quot;action&quot;] ?? &quot;&quot;;</span><br><span class="line">        switch (action)</span><br><span class="line">        &#123;</span><br><span class="line">            case &quot;test&quot;:</span><br><span class="line">                Test();     &#x2F;&#x2F;测试保存数据</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void Test()</span><br><span class="line">    &#123;</span><br><span class="line">        string data &#x3D; Request.QueryString[&quot;data&quot;] ?? &quot;&quot;;</span><br><span class="line">        HttpFileCollection files &#x3D; Request.Files;</span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">            if (files.Count &gt; 0)</span><br><span class="line">            &#123;</span><br><span class="line">                HttpPostedFile file &#x3D; files[0];</span><br><span class="line"></span><br><span class="line">                string fileName &#x3D; Server.MapPath(String.Format(&quot;~&#x2F;output&#x2F;&#123;0&#125;_&#123;1&#125;.doc&quot;, data, Guid.NewGuid()));</span><br><span class="line"></span><br><span class="line">                file.SaveAs(fileName);</span><br><span class="line"></span><br><span class="line">                Response.Write(String.Format(&quot;保存附件“&#123;0&#125;”成功！\r\n返回测试数据：&#123;1&#125;&quot;, fileName, data));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch</span><br><span class="line">        &#123;</span><br><span class="line">            Response.Write(&quot;有异常&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>其中，一定要记得写Response.ContentEncoding = Encoding.GetEncoding(“GB2312”);这段代码，如果没有写，返回的中文会出现乱码的情况。我们通过HttpFileCollection files = Request.Files;方式可以取得一个POST文件流。</p><p>在第一次使用该插件的时候，首先必须进行安装，您可以通过下载一个Word编辑器插件安装包.rar包，来安装插件，包里面包含相关的批处理操作，大家自己可以试试。</p><p>[下载地址]:</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;做OA或者工作流程的网站中，常常能够看到一些在线Word编辑进行文档处理的功能，这里我开发了一个在线Word编辑插件并且以此为例。
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="onlineoffice" scheme="https://blog.songuo.tech/tags/onlineoffice/"/>
    
  </entry>
  
  <entry>
    <title>office在线预览以及在线编辑</title>
    <link href="https://blog.songuo.tech/p/28c57c36.html"/>
    <id>https://blog.songuo.tech/p/28c57c36.html</id>
    <published>2021-07-01T03:30:00.000Z</published>
    <updated>2021-07-01T03:22:35.856Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://gitee.com/freshways/dsoframer" target="_blank" rel="noopener">https://gitee.com/freshways/dsoframer</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://gitee.com/freshways/dsoframer&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://gitee.com/freshways/dsoframer&lt;/a&gt;&lt;/p&gt;

    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="onlineoffice" scheme="https://blog.songuo.tech/tags/onlineoffice/"/>
    
  </entry>
  
  <entry>
    <title>使用IEXPress.exe工具制作CAB包</title>
    <link href="https://blog.songuo.tech/p/55d5d9b.html"/>
    <id>https://blog.songuo.tech/p/55d5d9b.html</id>
    <published>2021-07-01T02:30:00.000Z</published>
    <updated>2021-07-01T03:22:35.878Z</updated>
    
    <content type="html"><![CDATA[<p>Internet软件分发单位是“软件包”，它由包含.INF文件或软件分发.OSD文件（或两者都包括）的.CAB文件所组成。一个分发单位也可以包含软件组件，如ActiveX控件，DLL文件等。在制作CAB文件时，可以使用Windows自带的工具IEXPress.exe，该工具位于（C：\windows\system32）目录下。<a id="more"></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Internet软件分发单位是“软件包”，它由包含.INF文件或软件分发.OSD文件（或两者都包括）的.CAB文件所组成。一个分发单位也可以包含软件组件，如ActiveX控件，DLL文件等。在制作CAB文件时，可以使用Windows自带的工具IEXPress.exe，该工具位于（C：\windows\system32）目录下。
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="onlineoffice" scheme="https://blog.songuo.tech/tags/onlineoffice/"/>
    
  </entry>
  
  <entry>
    <title>selenium执行js的注意事项</title>
    <link href="https://blog.songuo.tech/p/15a3b02e.html"/>
    <id>https://blog.songuo.tech/p/15a3b02e.html</id>
    <published>2021-07-01T01:00:00.000Z</published>
    <updated>2021-07-01T01:05:48.789Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-传参注意事项"><a href="#1-传参注意事项" class="headerlink" title="1.传参注意事项"></a>1.传参注意事项</h2><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String js = <span class="string">"var attachments = arguments[0];\n"</span> +</span><br><span class="line">    <span class="string">"var fjlx = arguments[1];\n"</span> +</span><br><span class="line">    <span class="string">"var data = arguments[2];\n"</span> +</span><br><span class="line">    <span class="string">"function addFileByjs(attachments,fjlx,data)&#123;\n"</span> +</span><br><span class="line">    <span class="string">"console.log(attachments);"</span> +</span><br><span class="line">    <span class="string">"&#125;\n"</span> +</span><br><span class="line">    <span class="string">"addFileByjs(attachments,fjlx,data);"</span>;</span><br><span class="line">((JavascriptExecutor) browser).executeScript(js,attachments,fjlx,data);</span><br></pre></td></tr></table></figure><p>​    executeScript(String var1, Object… var2)支持传参，参数在js中使用arguments[i]进行接收。arguments[i]必须放置在最外层，放置在函数中会无法赋值。</p><h2 id="2-调用本地js文件执行js函数的示例"><a href="#2-调用本地js文件执行js函数的示例" class="headerlink" title="2.调用本地js文件执行js函数的示例"></a>2.调用本地js文件执行js函数的示例</h2><p>我们要在Java中执行JavaScriptMethods.js中的execute(s1,s2)方法，JavaScriptMethods.js文件内容如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params">s1, s2</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> s1 + s2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先需要定义一个接口，这个接口中给出与要执行的JavaScript方法一样的方法签名，我们定义接口Methods，它的内容如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 接口中的方法签名必须与要执行的JavaScript方法一致</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Methods</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">(String s1,String s2)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后，就可以用脚本引擎执行JavaScriptMethods.js中execute(s1,s2)方法了，具体内容写在下面的ExecuteScript类中的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> javax.script.Invocable;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngine;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngineManager;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExecuteScript</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ScriptEngineManager manager = <span class="keyword">new</span> ScriptEngineManager();</span><br><span class="line">    ScriptEngine engine = manager.getEngineByName(<span class="string">"js"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      String path = ExecuteScript.class.getResource("").getPath();</span><br><span class="line">      System.out.println(path);</span><br><span class="line">      <span class="comment">// FileReader的参数为所要执行的js文件的路径</span></span><br><span class="line">      engine.eval(<span class="keyword">new</span> FileReader(path + <span class="string">"JavaScriptMethods.js"</span>));</span><br><span class="line">      <span class="keyword">if</span> (engine <span class="keyword">instanceof</span> Invocable) &#123;</span><br><span class="line">        Invocable invocable = (Invocable) engine;</span><br><span class="line">        Methods executeMethod = invocable.getInterface(Methods<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(executeMethod.execute(<span class="string">"hello"</span>, <span class="string">" world"</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-传参注意事项&quot;&gt;&lt;a href=&quot;#1-传参注意事项&quot; class=&quot;headerlink&quot; title=&quot;1.传参注意事项&quot;&gt;&lt;/a&gt;1.传参注意事项&lt;/h2&gt;
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium与http结合实现附件上传</title>
    <link href="https://blog.songuo.tech/p/976dcb4a.html"/>
    <id>https://blog.songuo.tech/p/976dcb4a.html</id>
    <published>2021-07-01T00:42:00.000Z</published>
    <updated>2021-07-01T01:05:48.782Z</updated>
    
    <content type="html"><![CDATA[<p>背景：</p><p>​    项目中需要进行多个多附件上传，且需要保证每个附件都进行上传，缺少一个附件也不能进行提交操作。这样通过sendkey的方式无法判断上传完成的时机，进行附件上传成功与否的判断就比较复杂。在此情况下，想到了通过selenium和http结合的方式进行附件处理，保证表单所有附件都正确上传后再进行表单提交。</p><p>思路：</p><p>1.获取附件上传链接</p><p>2.获取附件上传所需要的cookie以及参数</p><p>3.进行附件上传</p><p>4.查看上传成功后的处理，执行js进行处理</p><a id="more"></a><p>代码如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取cookies</span></span><br><span class="line">Set&lt;Cookie&gt; cookieSet = browser.manage().getCookies();</span><br><span class="line">HttpCookie[] cookies = <span class="keyword">new</span> HttpCookie[cookieSet.size()];</span><br><span class="line">StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"><span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(Cookie cookie:cookieSet)&#123;</span><br><span class="line">    cookies[index]=<span class="keyword">new</span> HttpCookie(cookie.getName(),cookie.getValue());</span><br><span class="line">    stringBuilder.append(cookie.getName())</span><br><span class="line">        .append(<span class="string">"="</span>)</span><br><span class="line">        .append(cookie.getValue())</span><br><span class="line">        .append(<span class="string">";"</span>)</span><br><span class="line">        ;</span><br><span class="line">    index++;</span><br><span class="line">&#125;</span><br><span class="line">String cookiesStr = stringBuilder.substring(<span class="number">0</span>,stringBuilder.length()-<span class="number">1</span>);</span><br><span class="line"><span class="comment">//调用http接口进行附件上传</span></span><br><span class="line">String result = HttpUtil.createPost(<span class="string">""</span>)</span><br><span class="line">    .cookie(cookies)</span><br><span class="line">    .header(Header.COOKIE,cookiesStr)</span><br><span class="line">    .header(Header.HOST,<span class="string">"ssfw.gdcourts.gov.cn"</span>)</span><br><span class="line">    .form(<span class="string">"file"</span>,<span class="keyword">new</span> File(<span class="string">""</span>))</span><br><span class="line">    .execute()</span><br><span class="line">    .body();</span><br><span class="line"><span class="comment">//获取执行结果</span></span><br><span class="line">JSONObject data = JSON.parseObject(result);</span><br><span class="line"><span class="comment">//判断上传是否成功并进行处理</span></span><br><span class="line"><span class="keyword">if</span> (!data.getBoolean(<span class="string">"success"</span>))&#123;</span><br><span class="line">log.info(<span class="string">"上传失败"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//判断是否成功</span></span><br><span class="line">    <span class="comment">//进行js处理</span></span><br><span class="line">    String attachments = <span class="string">""</span>;</span><br><span class="line">    String fjlx = <span class="string">""</span>;</span><br><span class="line">    String js = <span class="string">"var attachments = arguments[0];\n"</span> +</span><br><span class="line">    <span class="string">"var fjlx = arguments[1];\n"</span> +</span><br><span class="line">    <span class="string">"var data = arguments[2];\n"</span> +</span><br><span class="line">    <span class="string">"function addFileByjs()&#123;\n"</span> +</span><br><span class="line">    <span class="string">"\tif($.trim(data.fjList)!='')&#123;\n"</span> +</span><br><span class="line">    <span class="string">"\t\tvar fjpdf = \"1\";\n"</span> +</span><br><span class="line">    <span class="string">"\t\tfor(var i=0;i&lt;data.fjList.length;i++)&#123;\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar fj = data.fjList[i];\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar suffix = fj.fjmc.substring(fj.fjmc.lastIndexOf('.')+1);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tif(suffix == 'pdf')&#123;\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t\tfjpdf = '2';\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t&#125;\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar len = $('#'+attachments).find(\".attachment_cls\").length+1;\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar mc = W21Json[fjlx];\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t//替换特殊字符\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar fjmcTmp = filterSpecialChar(fj.fjmc);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar zjmc = mc+\"_\"+len+\"(\"+fjmcTmp+\")\";\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tvar clone = $(\"#attachment_div\").clone(true);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.removeAttr(\"id\");\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.find(\".zjxxs_fjmc\").attr(&#123;\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t\t\"href\":\t\"javascript:void(0);\",\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t\t\"onclick\":\"funClxxUpload_wzh(this,'\"+fjm+\"');\",\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t\t\"htitle\": zjmc,\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t\t\"fjmc\":fjmcTmp\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\t&#125;).append(zjmc);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.find(\"input[name='zjxxs.fjid']\").val(fj.fjid);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.find(\"input[name='zjxxs.lx']\").val(fjlx);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.find(\"input[name='zjxxs.zjmc']\").val(zjmc);\n"</span> +</span><br><span class="line">    <span class="string">"\t\t\tclone.appendTo(\"#\"+attachments);\n"</span> +</span><br><span class="line">                    <span class="string">"\t\t&#125;\n"</span> +</span><br><span class="line">                    <span class="string">"\t&#125;\n"</span> +</span><br><span class="line">                    <span class="string">"&#125;\n"</span> +</span><br><span class="line">                    <span class="string">"addFileByjs();"</span>;</span><br><span class="line">((JavascriptExecutor) browser).executeScript(js,attachments,fjlx,data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>executeScript调用js的注意事项见下节内容</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;背景：&lt;/p&gt;
&lt;p&gt;​    项目中需要进行多个多附件上传，且需要保证每个附件都进行上传，缺少一个附件也不能进行提交操作。这样通过sendkey的方式无法判断上传完成的时机，进行附件上传成功与否的判断就比较复杂。在此情况下，想到了通过selenium和http结合的方式进行附件处理，保证表单所有附件都正确上传后再进行表单提交。&lt;/p&gt;
&lt;p&gt;思路：&lt;/p&gt;
&lt;p&gt;1.获取附件上传链接&lt;/p&gt;
&lt;p&gt;2.获取附件上传所需要的cookie以及参数&lt;/p&gt;
&lt;p&gt;3.进行附件上传&lt;/p&gt;
&lt;p&gt;4.查看上传成功后的处理，执行js进行处理&lt;/p&gt;
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>使用Maven将Jar包打到本地仓库</title>
    <link href="https://blog.songuo.tech/p/baceea9c.html"/>
    <id>https://blog.songuo.tech/p/baceea9c.html</id>
    <published>2021-06-23T06:30:00.000Z</published>
    <updated>2021-06-23T06:36:45.464Z</updated>
    
    <content type="html"><![CDATA[<p>Maven 执行命令</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Dfile：JAR 包的路径</span></span><br><span class="line"><span class="comment">#DgroupId：groupId(随便填)</span></span><br><span class="line"><span class="comment">#DartifactId：artifactId(随便填)</span></span><br><span class="line"><span class="comment">#Dversion：版本号(随便填)</span></span><br><span class="line"></span><br><span class="line">mvn install:<span class="built_in">install-file</span> <span class="literal">-Dfile</span>=C:\lib\jasperreports<span class="literal">-fonts</span><span class="literal">-5</span>.<span class="number">6.0</span>.jar <span class="literal">-DgroupId</span>=org.ireport <span class="literal">-DartifactId</span>=jasperreports<span class="literal">-fonts</span> <span class="literal">-Dversion</span>=<span class="number">5.6</span>.<span class="number">0</span> <span class="literal">-Dpackaging</span>=jar</span><br></pre></td></tr></table></figure><p>Pom.xml  对应上方你填写的名称</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.xxxxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxxxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>xxxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Maven 执行命令&lt;/p&gt;
&lt;figure class=&quot;highlight powershell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#Dfile：JAR 包的路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#DgroupId：groupId(随便填)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#DartifactId：artifactId(随便填)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#Dversion：版本号(随便填)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mvn install:&lt;span class=&quot;built_in&quot;&gt;install-file&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;-Dfile&lt;/span&gt;=C:\lib\jasperreports&lt;span class=&quot;literal&quot;&gt;-fonts&lt;/span&gt;&lt;span class=&quot;literal&quot;&gt;-5&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;6.0&lt;/span&gt;.jar &lt;span class=&quot;literal&quot;&gt;-DgroupId&lt;/span&gt;=org.ireport &lt;span class=&quot;literal&quot;&gt;-DartifactId&lt;/span&gt;=jasperreports&lt;span class=&quot;literal&quot;&gt;-fonts&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;-Dversion&lt;/span&gt;=&lt;span class=&quot;number&quot;&gt;5.6&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;-Dpackaging&lt;/span&gt;=jar&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Pom.xml  对应上方你填写的名称&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.xxxxx&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;xxxxxx&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;xxxx&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="maven" scheme="https://blog.songuo.tech/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>Word如何调整文字宽度</title>
    <link href="https://blog.songuo.tech/p/420f92f6.html"/>
    <id>https://blog.songuo.tech/p/420f92f6.html</id>
    <published>2021-06-18T06:12:00.000Z</published>
    <updated>2021-06-21T01:54:46.251Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>打开文档，我们发现内容参差不齐：<a id="more"></a></p><p><img src="https://exp-picture.cdn.bcebos.com/fdb4f00d3aceaad75de0a151eee7340f6578b822.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fquality%2Cq_80" alt="Word如何调整文字宽度"></p></li><li><p>选取需要排版的文字，找到“开始”下方“调整宽度”</p><p><img src="https://exp-picture.cdn.bcebos.com/2083a5d6e1d06de8a1ea2b96ca93cee8b104ac22.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fquality%2Cq_80" alt="Word如何调整文字宽度"></p></li><li><p>进入设置界面，一般按照你最大的文字宽度设置字符距离：</p><p><img src="https://exp-picture.cdn.bcebos.com/16d8f72abab8424023756ea77ac595ee40c19e22.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fquality%2Cq_80" alt="Word如何调整文字宽度"></p></li><li><p>达到预期的排版效果：</p><p><img src="https://exp-picture.cdn.bcebos.com/07c98f2ca5cadce8c4c3ad4ffcf7980e5e209522.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fquality%2Cq_80" alt="Word如何调整文字宽度"></p></li><li><p>有些朋友在操作时会出现图示状况，原因是选取设置的内容时，需要按住CTRL键选择不连续文本，而不能直接选取整个内容。</p><p><img src="https://exp-picture.cdn.bcebos.com/76b6860e5f20437105509b93323acd8921c58f22.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fquality%2Cq_80" alt="Word如何调整文字宽度"></p></li><li><p>你可以将其他部分单个选取设置宽度，也可以按住CTRL键选取后全部设置，达到预期效果。</p><p><img src="images/Untitled/274e9635dd8a59de268c25b2b370d5413b8c8422.jpg" alt="Word如何调整文字宽度"></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;&lt;p&gt;打开文档，我们发现内容参差不齐：
    
    </summary>
    
    
      <category term="office" scheme="https://blog.songuo.tech/categories/office/"/>
    
    
      <category term="office" scheme="https://blog.songuo.tech/tags/office/"/>
    
  </entry>
  
  <entry>
    <title>WEB套打程序开发 (lodop使用)</title>
    <link href="https://blog.songuo.tech/p/27db05d5.html"/>
    <id>https://blog.songuo.tech/p/27db05d5.html</id>
    <published>2021-05-12T07:30:00.000Z</published>
    <updated>2021-05-12T08:46:42.546Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.diewufeiyang.com/post/1210.html" target="_blank" rel="noopener">WEB套打程序开发 (lodop使用)</a></p><p>WEB套打可选方案不多，理想的更少，利用免费控件Lodop+JavaScript实现精确套打，算是较为经典的选择。这种方案其实比较简单，利用一个htm文件就可以实现模板设计过程，几乎是“空手套”式的开发，但理解这几个步骤还是需要点时间，下面一步步详细演示说明：<a id="more"></a></p><p>第一步：建立一个空白的模板设计文件</p><p>把以下超文本代码复制到一个本地htm文件中:</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-1.jpg" alt="img"></p><p>本文模拟EMS特快专递单的程序开发，文件起名为printEMS.htm，权且称它为模板设计文件。</p><p>第二步：用浏览器打开该文件</p><p>在本地文件夹中双击该文件就可以打开，但在进入设计之前，你的机器需要安装Lodop，如果还没安装过，</p><p>请在如下地址下载安装文件(解压rar后运行那个exe文件，Lodop是一个1M左右的小文件)：</p><p><a href="http://www.lodop.net/download.html" target="_blank" rel="noopener">http://www.lodop.net/download.html</a></p><p>第三步：准备设计</p><p>成功安装Lodop之后再次打开模板设计文件printEMS.htm，点击其中“模板设计”链接，就弹出如下空白的打印设计窗口：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-2.jpg" alt="img"></p><p>为了尽快定位模板中的数据位置，你需要做一张票据扫描图作为背景，当然没有扫描图也能完成，只是需要多摸索几次，费点时间而已。</p><p>下面是我做的EMS扫描图，你把该图另存成一个jpg文件，以便我们一起完成后面的演示步骤。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-3.jpg" alt="img"></p><p>第四步：装载背景图并调整图片大小</p><p>在打印设计窗口，点下图所示的“装载背景图…”菜单，调入以上保存的EMS图片文件。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-4.jpg" alt="img"></p><p>装载背景图后，点上图所示的“调整背景图…”菜单，弹出下图“背景图调整”窗口，设定其中的图片宽度为209mm,高度113mm会自动变化。</p><p>这个宽度值是我测量实际票据得来的。如果扫描图是按1:1比例获得的，那么调整背景图这一步就免了，当然要做点这点很难，所以最好还是在这里直接设置具体尺寸反倒简单。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-5.jpg" alt="img"></p><p>第五步：添加数据内容，开始打印测试</p><p>点下图所示“插入文本项”菜单，添加打印内容，内容项可以拖拉或精细调整，基本对准之后，点击“预览”按钮（注意旁边的“打印”按钮是收费功能，纸上会有水印，而“预览时的打印”按钮是完全免费的，我们用后者）。</p><p>把内容打印到薄一点的白纸上，然后在阳光下与真实票据透亮对比，以最左最上的某个内容为基准，其它内容远近调整，如此反复测试直到所有内容相互位置都对准。</p><p>这一步先做到内容之间的相互位置对准，等下一步处理整体位置。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-6.jpg" alt="img"></p><p>第六步：整体对准</p><p>由于打印机左边距或上边距不一定是零或票据边缘有误差，所以尽管第五步打印出来的内容相互之间位置是准确的，但打印到真实票据上仍会整体偏离一些，需要进行整体位置调整。</p><p>点击下图红圈所示的“纸钉”按钮，“纸钉”弹起后，整个设计版面就可以上下左右调整了，然后按上一步的办法打印测试，直到整体对准成功。为了避免浪费票据，打印时仍可用薄白纸测试，注意此时透光对照时，纸张的左边沿和上边沿要与票据对齐，通过观察内容的位置来判断是否整体对准。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-7.jpg" alt="img"></p><p>第七步：生成打印模板的程序代码</p><p>套打测试成功后，点击第五步图中所示的“生成程序代码”菜单，出现下图结果，这些代码就是我们需要的模板程序代码，把他们复制出来，准备融合到你的页面程序中使用。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-8.jpg" alt="img"></p><p>第八步：完成打印模板设计文件</p><p>想不想知道WEB套打有啥感觉？好，我们先做一个静态WEB页面爽一下：把第七步生成的程序代码，</p><p>插入替换第一步的空白设计文件CreatePrintPage函数内，变成如下内容:</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-9.jpg" alt="img"></p><p>把以上内容复制到另外一个htm文件printEMS_OK.htm中，双击打开它，点其中的打印预览，就可以实现简单的WEB套打了。</p><p>以上八步基本完成了模板设计，并实现静态页面套打，但要把模板代码融合到实际的WEB程序中，还需要做些工作。</p><p>第九步：模板程序代码的使用</p><p>把以上CreatePrintPage函数进行简单改造，原函数如下：</p><p>Java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">CreatePrintPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     LODOP.PRINT_INITA(<span class="number">14</span>,<span class="number">11</span>,<span class="number">800</span>,<span class="number">600</span>,<span class="string">"套打EMS的模板"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">95</span>,<span class="number">95</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"寄件人姓名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">123</span>,<span class="number">148</span>,<span class="number">194</span>,<span class="number">20</span>,<span class="string">"寄件人单位名称"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">158</span>,<span class="number">101</span>,<span class="number">238</span>,<span class="number">35</span>,<span class="string">"寄件人的详细地址"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">446</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"收件人姓名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">122</span>,<span class="number">496</span>,<span class="number">208</span>,<span class="number">20</span>,<span class="string">"收件人单位名称"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">160</span>,<span class="number">460</span>,<span class="number">244</span>,<span class="number">35</span>,<span class="string">"收件人详细地址"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">289</span>,<span class="number">47</span>,<span class="number">178</span>,<span class="number">22</span>,<span class="string">"内件品名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">290</span>,<span class="number">258</span>,<span class="number">100</span>,<span class="number">20</span>,<span class="string">"内件数量"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">245</span>,<span class="number">100</span>,<span class="number">20</span>,<span class="string">"寄件人电话"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">90</span>,<span class="number">608</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"收件人电话"</span>);</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><p>把其中的打印内容提出来做为变量参数，函数改成如下样式：</p><p>Java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">CreatePrintPage</span><span class="params">(strPName,strJJRXM,strJJRDW,strJJRDZ,strSJRXM,strSJRDW,strSJRDZ,strNJPM,strNJSL,strJJRDH,strSJRDH)</span> </span>&#123;</span><br><span class="line">    LODOP.PRINT_INITA(<span class="number">14</span>,<span class="number">11</span>,<span class="number">800</span>,<span class="number">600</span>,strPName);        <span class="comment">//打印任务名</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">95</span>,<span class="number">95</span>,<span class="number">75</span>,<span class="number">20</span>,strJJRXM);       <span class="comment">//寄件人姓名</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">123</span>,<span class="number">148</span>,<span class="number">194</span>,<span class="number">20</span>,strJJRDW);    <span class="comment">//寄件人单位名称</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">158</span>,<span class="number">101</span>,<span class="number">238</span>,<span class="number">35</span>,strJJRDZ);    <span class="comment">//寄件人的详细地址</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">446</span>,<span class="number">75</span>,<span class="number">20</span>,strSJRXM);      <span class="comment">//收件人姓名</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">122</span>,<span class="number">496</span>,<span class="number">208</span>,<span class="number">20</span>,strSJRDW);    <span class="comment">//收件人单位名称</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">160</span>,<span class="number">460</span>,<span class="number">244</span>,<span class="number">35</span>,strSJRDZ);    <span class="comment">//收件人详细地址</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">289</span>,<span class="number">47</span>,<span class="number">178</span>,<span class="number">22</span>,strNJPM);      <span class="comment">//内件品名</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">290</span>,<span class="number">258</span>,<span class="number">100</span>,<span class="number">20</span>,strNJSL);     <span class="comment">//内件数量</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">245</span>,<span class="number">100</span>,<span class="number">20</span>,strJJRDH);     <span class="comment">//寄件人电话</span></span><br><span class="line">    LODOP.ADD_PRINT_TEXT(<span class="number">90</span>,<span class="number">608</span>,<span class="number">75</span>,<span class="number">20</span>,strSJRDH);      <span class="comment">//收件人电话</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这个改造后的JS函数还是很好理解的，无论写入js文件还是直接嵌在页面内都简单易用。</p><p>如果你改变了内容的字体、大小、粗斜体等格式，代码还会多一些，但总体来说比较简洁。</p><p>第十步：设置纸张高度，实现连续套打</p><p>多数套打业务的票据是连续纸，需要精确地分页，从而保证连续多页打印不偏移，</p><p>为此以上代码还要在PRINT_INITA之后加一行SET_PRINT_PAGESIZE语句：</p><p>Java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">CreatePrintPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     LODOP.PRINT_INITA(<span class="number">14</span>,<span class="number">11</span>,<span class="number">800</span>,<span class="number">600</span>,<span class="string">"套打EMS的模板"</span>);</span><br><span class="line">     LODOP.SET_PRINT_PAGESIZE(<span class="number">1</span>,<span class="string">"209mm"</span>,<span class="string">"113mm"</span>,<span class="string">""</span>);<span class="comment">//设置纸张高度</span></span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">95</span>,<span class="number">95</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"寄件人姓名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">123</span>,<span class="number">148</span>,<span class="number">194</span>,<span class="number">20</span>,<span class="string">"寄件人单位名称"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">158</span>,<span class="number">101</span>,<span class="number">238</span>,<span class="number">35</span>,<span class="string">"寄件人的详细地址"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">446</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"收件人姓名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">122</span>,<span class="number">496</span>,<span class="number">208</span>,<span class="number">20</span>,<span class="string">"收件人单位名称"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">160</span>,<span class="number">460</span>,<span class="number">244</span>,<span class="number">35</span>,<span class="string">"收件人详细地址"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">289</span>,<span class="number">47</span>,<span class="number">178</span>,<span class="number">22</span>,<span class="string">"内件品名"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">290</span>,<span class="number">258</span>,<span class="number">100</span>,<span class="number">20</span>,<span class="string">"内件数量"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">92</span>,<span class="number">245</span>,<span class="number">100</span>,<span class="number">20</span>,<span class="string">"寄件人电话"</span>);</span><br><span class="line">     LODOP.ADD_PRINT_TEXT(<span class="number">90</span>,<span class="number">608</span>,<span class="number">75</span>,<span class="number">20</span>,<span class="string">"收件人电话"</span>);</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><p>其中209mm这个纸宽参数意义不大，主要是113mm这个高度参数，它决定了每页的走纸距离，对连续打印影响很大。这个值是我测量实际票据高度得来的，包含纸张之间的撕孔间隙。理想的测量方式，是若干页连起来一起测量取其平均高。</p><p>加入纸高控制后的打印预览如下，你可以连续打印两页内容到同一张长一点的白纸上，测试对照一下看看。把以上加入SET_PRINT_PAGESIZE语句的代码复制进第三个htm文件printEMS_OKM.htm试试。假如从第二页开始，内容向下偏移，说明纸张高度设置比实际票据大，就减小113mm这个参数值，否则增大它，这个参数可以精确到0.1mm。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-10.jpg" alt="img"></p><p>第十一步：让操作者自己调整位置</p><p>以上十步实现的套打可以很精确，但都是以当前打印机为前提。如果你的打印程序要面对许多种类型的打印机，甚至一些未知的打印机类型，那么“打印维护”功能会很有用处。你可以根据情况在程序中把该功能授权给最终操作者或现场技术维护人员，让使用者自己来调整打印位置，以适应各种类型的打印机。</p><p>打印维护的指令语句是PRINT_SETUP，进入包含该功能的在线文件PrintEMS_OKMSetup.htm,先在打印维护中调整一下打印内容或整体位置，点“应用”按钮。关闭浏览器后重新打开，进入“打印预览”，看看是否有关联变化。下图是打印维护界面，其中能看到“应用”按钮和“恢复整体缺省”按钮的位置。</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-11.jpg" alt="img"></p><p>注意： 如果你在电脑对打印纸张已经进行了设置，就不需要在程序中设置纸张大小，如下面两句:LODOP.PRINT_INITA(14,11,800,600,”套打EMS的模板”);LODOP.SET_PRINT_PAGESIZE(1,”209mm”,”113mm”,””);//设置纸张高度；如果你两边都进行设置就会出现打印纸张不符合的问题，打印机会出现检查错误，从而打印不了，具体设置根据你测试情况而定</p><p>本文参考如下资料：</p><p><a href="http://www.lodop.net/demo.html" target="_blank" rel="noopener">http://www.lodop.net/demo.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.diewufeiyang.com/post/1210.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;WEB套打程序开发 (lodop使用)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;WEB套打可选方案不多，理想的更少，利用免费控件Lodop+JavaScript实现精确套打，算是较为经典的选择。这种方案其实比较简单，利用一个htm文件就可以实现模板设计过程，几乎是“空手套”式的开发，但理解这几个步骤还是需要点时间，下面一步步详细演示说明：
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="lodop" scheme="https://blog.songuo.tech/tags/lodop/"/>
    
  </entry>
  
  <entry>
    <title>java利用Freemarker模板生成docx格式的word文档</title>
    <link href="https://blog.songuo.tech/p/3c425087.html"/>
    <id>https://blog.songuo.tech/p/3c425087.html</id>
    <published>2021-05-07T08:30:00.000Z</published>
    <updated>2021-05-07T09:49:29.611Z</updated>
    
    <content type="html"><![CDATA[<p>利用Freemarker模板生成docx<a id="more"></a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>1.把docx文档修改为ZIP格式（修改.docx后缀名为.zip）<br>2.获取zip里的document.xml文档以及_rels文件夹下的document.xml.rels文档<br>3.把内容填充到document.xml里<br>4.在输入docx文档的时候把填充过内容的的 document.xml用流的方式写入zip（详见下面代码）。<br>5.输出docx文档<br>docx模板修改成zip格式后的信息如下（因为word文档本身就是ZIP格式实现的）</p><ul><li>document.xml里存放主要数据</li></ul><h2 id="处理流程"><a href="#处理流程" class="headerlink" title="处理流程"></a>处理流程</h2><p>1.准备好docx模板</p><p>2.把docx文档修改为ZIP格式（修改.docx后缀名为.zip）</p><p>3.获取zip文件里的word文件夹下的document.xml文件作为模板。</p><p>4.填充模板信息。</p><p>5.输出word测试</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.io.FileUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.io.IoUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.extra.template.Template;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.extra.template.TemplateConfig;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.extra.template.TemplateEngine;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.extra.template.TemplateUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.text.WordUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipFile;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DocUtils</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        OutputStream outputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            outputStream= <span class="keyword">new</span> FileOutputStream(<span class="string">"e:/test.docx"</span>);</span><br><span class="line">            Map dataMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">            dataMap.put(<span class="string">"ah"</span>,<span class="string">"1231231"</span>);</span><br><span class="line">            dataMap.put(<span class="string">"dsrmc"</span>,<span class="string">"456"</span>);</span><br><span class="line">            createDocx(dataMap,outputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//outputStream 输出流可以自己定义 浏览器或者文件输出流</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createDocx</span><span class="params">(Map dataMap, OutputStream outputStream)</span> </span>&#123;</span><br><span class="line">        ZipOutputStream zipout = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//内容模板</span></span><br><span class="line">            ByteArrayInputStream documentInput = getFreemarkerContentInputStream(dataMap);</span><br><span class="line">            <span class="comment">//最初设计的模板</span></span><br><span class="line">            File docxFile = <span class="keyword">new</span> File(<span class="string">"E:\\template.docx"</span>);</span><br><span class="line">            <span class="keyword">if</span> (!docxFile.exists()) &#123;</span><br><span class="line">                docxFile.createNewFile();</span><br><span class="line">            &#125;</span><br><span class="line">            ZipFile zipFile = <span class="keyword">new</span> ZipFile(docxFile);</span><br><span class="line">            Enumeration&lt;? extends ZipEntry&gt; zipEntrys = zipFile.entries();</span><br><span class="line">            zipout = <span class="keyword">new</span> ZipOutputStream(outputStream);</span><br><span class="line">            <span class="comment">//开始覆盖文档------------------</span></span><br><span class="line">            <span class="keyword">int</span> len = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">while</span> (zipEntrys.hasMoreElements()) &#123;</span><br><span class="line">                ZipEntry next = zipEntrys.nextElement();</span><br><span class="line">                InputStream is = zipFile.getInputStream(next);</span><br><span class="line">                <span class="keyword">if</span> (next.toString().indexOf(<span class="string">"media"</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    zipout.putNextEntry(<span class="keyword">new</span> ZipEntry(next.getName()));</span><br><span class="line">                    <span class="comment">//如果是word/document.xml由我们输入</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="string">"word/document.xml"</span>.equals(next.getName())) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (documentInput != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            <span class="keyword">while</span> ((len = documentInput.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                                zipout.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">                            &#125;</span><br><span class="line">                            documentInput.close();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">while</span> ((len = is.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                            zipout.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">                        &#125;</span><br><span class="line">                        is.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"word导出失败:"</span>,e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(zipout!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    zipout.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">"io异常"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(outputStream!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    outputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    log.error(<span class="string">"io异常"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取模板字符串输入流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataMap   参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ByteArrayInputStream <span class="title">getFreemarkerContentInputStream</span><span class="params">(Map dataMap)</span> </span>&#123;</span><br><span class="line">        ByteArrayInputStream in = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TemplateEngine engine = TemplateUtil.createEngine(<span class="keyword">new</span> TemplateConfig());</span><br><span class="line">            String templateStr= FileUtil.readString(<span class="keyword">new</span> File(<span class="string">"E:\\document.xml"</span>),<span class="string">"utf-8"</span>);</span><br><span class="line">            Template template = engine.getTemplate(templateStr);</span><br><span class="line">            String result = template.render(dataMap);</span><br><span class="line">            <span class="comment">//这里一定要设置utf-8编码 否则导出的word中中文会是乱码</span></span><br><span class="line">            in = <span class="keyword">new</span> ByteArrayInputStream(result.getBytes(<span class="string">"utf-8"</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">"模板生成错误！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> in;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;利用Freemarker模板生成docx
    
    </summary>
    
    
      <category term="开发经验" scheme="https://blog.songuo.tech/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="word" scheme="https://blog.songuo.tech/tags/word/"/>
    
  </entry>
  
  <entry>
    <title>使用selenium 接管 已打开的浏览器</title>
    <link href="https://blog.songuo.tech/p/e522fa11.html"/>
    <id>https://blog.songuo.tech/p/e522fa11.html</id>
    <published>2021-04-12T05:22:00.000Z</published>
    <updated>2021-04-12T01:28:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>在使用selenium进行自动化测试中我们有时会遇到这样的情况：</p><p>​    我们需要手动打开浏览器，进入到所需的页面，执行一些手动任务，如输入表单、输入验证码，登陆成功后，然后再开始运行自动化脚本。<a id="more"></a></p><p>这种情况下如何使用selenium来接管先前已打开的浏览器呢？</p><p>这里给出Google Chrome浏览器的解决方案。</p><p>我们可以利用Chrome DevTools协议。它允许客户检查和调试Chrome浏览器。</p><p>打开cmd，在命令行中输入命令：</p><p>chrome.exe —remote-debugging-port=9222 —user-data-dir=”C:\selenum\AutomationProfile”</p><p>   对于-remote-debugging-port值，可以指定任何打开的端口。</p><p>   对于-user-data-dir标记，指定创建新Chrome配置文件的目录。它是为了确保在单独的配置文件中启动chrome，不会污染你的默认配置文件。</p><p>   还有，不要忘了在环境变量中PATH里将chrome的路径添加进去。</p><p>此时会打开一个浏览器页面，我们输入百度网址，我们把它当成一个已存在的浏览器：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvMTAwMTc1My8yMDE4MTAvMTAwMTc1My0yMDE4MTAxODIwNTIwMDgxNi0xNjQyMjYyOTY3LnBuZw.png" alt="img"></p><p>现在，我们需要接管上面的浏览器。新建一个python文件，运行以下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line">chrome_options = Options()</span><br><span class="line">chrome_options.add_experimental_option(<span class="string">"debuggerAddress"</span>, <span class="string">"127.0.0.1:9222"</span>)</span><br><span class="line">chrome_driver = <span class="string">"C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe"</span></span><br><span class="line">driver = webdriver.Chrome(chrome_driver, chrome_options=chrome_options)</span><br><span class="line">print(driver.title)</span><br></pre></td></tr></table></figure><p> 会发现打印出了 “百度一下，你就知道” 的网页标题。这样我们就实现了对一个已打开的浏览器的控制。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.tomcat.util.http.fileupload.IOUtils;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeOptions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.edge.EdgeDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.ie.InternetExplorerDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.interactions.Actions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.ExpectedCondition;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.ExpectedConditions;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.WebDriverWait;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMoveVerificationCode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String baseUrl = <span class="string">"http://tiaojie.court.gov.cn/fayuan"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        int port = NetUtils.getAvailablePort();</span></span><br><span class="line">        <span class="keyword">int</span> port = <span class="number">9224</span>;</span><br><span class="line">        System.out.println(<span class="string">"端口："</span>+port);</span><br><span class="line">        <span class="comment">//用户数据文件夹</span></span><br><span class="line">        String userDataDir=<span class="string">"C:\\selenum\\"</span>+port;</span><br><span class="line">        File dataDir = <span class="keyword">new</span> File(userDataDir);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//设置环境变量，将chrome.exe所在的文件夹C:\Program Files (x86)\Google\Chrome\Application\添加到path中</span></span><br><span class="line">            <span class="comment">// C:\Program Files (x86)\Google\Chrome\Application\chrome.exe --remote-debugging-port=9222 --user-data-dir="C:\selenum\AutomationProfile"</span></span><br><span class="line">            String cmd =<span class="string">"cmd /c start /MAX chrome.exe --remote-debugging-port="</span>+port+<span class="string">" --user-data-dir=\""</span>+userDataDir+<span class="string">"\""</span>;</span><br><span class="line">            Process process = Runtime.getRuntime().exec(cmd);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"浏览器已打开……"</span>);</span><br><span class="line"></span><br><span class="line">        System.setProperty(<span class="string">"webdriver.chrome.driver"</span>,<span class="string">"C:\\windows\\chromedriver.exe"</span>);</span><br><span class="line"></span><br><span class="line">        ChromeOptions options = <span class="keyword">new</span> ChromeOptions();</span><br><span class="line">        options.setExperimentalOption(<span class="string">"debuggerAddress"</span>, <span class="string">"127.0.0.1:"</span>+port);</span><br><span class="line"></span><br><span class="line">        WebDriver driver = <span class="keyword">new</span> ChromeDriver(options);</span><br><span class="line"></span><br><span class="line">        driver.get(baseUrl);</span><br><span class="line">        <span class="comment">//等待滑动验证码加载完成</span></span><br><span class="line">        <span class="keyword">new</span> WebDriverWait(driver, <span class="number">10</span>).until(ExpectedConditions.invisibilityOfElementLocated(By.xpath(<span class="string">"//span[contains(.,'加载中')]"</span>)));</span><br><span class="line">        <span class="comment">//等待元素出现</span></span><br><span class="line">        WebElement draggable = (<span class="keyword">new</span> WebDriverWait( driver, <span class="number">10</span>)).until(<span class="keyword">new</span> ExpectedCondition&lt;WebElement&gt;()&#123;</span><br><span class="line">                                                                        <span class="meta">@Override</span></span><br><span class="line">                                                                        <span class="function"><span class="keyword">public</span> WebElement <span class="title">apply</span><span class="params">(WebDriver d)</span></span>&#123;</span><br><span class="line">                                                                            <span class="keyword">return</span> d.findElement(By.className(<span class="string">"btn_slide"</span>));</span><br><span class="line">                                                                        &#125;</span><br><span class="line">                                                                    &#125;</span><br><span class="line">        );</span><br><span class="line">        WebElement userName = driver.findElement(By.id(<span class="string">"userName"</span>));</span><br><span class="line">        userName.sendKeys(<span class="string">"1111111"</span>);</span><br><span class="line">        WebElement password = driver.findElement(By.id(<span class="string">"password"</span>));</span><br><span class="line">        password.sendKeys(<span class="string">"12222"</span>);</span><br><span class="line"><span class="comment">//        WebElement draggable = driver.findElement(By.className("btn_slide"));</span></span><br><span class="line">        <span class="comment">// 声明action对象</span></span><br><span class="line">        Actions action = <span class="keyword">new</span> Actions(driver);</span><br><span class="line">        <span class="comment">// clickAndHold鼠标左键按下draggable元素不放</span></span><br><span class="line">        action.clickAndHold(draggable).build().perform();</span><br><span class="line">        <span class="comment">//确保每次拖动的像素不同，故而使用随机数。防止反爬虫拦截</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            action.moveByOffset((<span class="keyword">int</span>)(Math.random()*<span class="number">200</span>)+<span class="number">80</span>, <span class="number">0</span>);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            action.moveByOffset((<span class="keyword">int</span>)(Math.random()*<span class="number">200</span>)+<span class="number">80</span>, <span class="number">0</span>);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            action.moveByOffset((<span class="keyword">int</span>)(Math.random()*<span class="number">200</span>)+<span class="number">80</span>, <span class="number">0</span>);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            action.moveByOffset((<span class="keyword">int</span>)(Math.random()*<span class="number">200</span>)+<span class="number">80</span>, <span class="number">0</span>);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        action.moveByOffset(<span class="number">280</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">//释放</span></span><br><span class="line">        action.release();</span><br><span class="line">        <span class="comment">//执行</span></span><br><span class="line">        action.perform();</span><br><span class="line">        <span class="comment">//等待元素消失</span></span><br><span class="line"><span class="comment">//        new WebDriverWait(driver, 10).until(ExpectedConditions.invisibilityOfElementLocated(By.xpath("//span[contains(.,'加载中')]")));</span></span><br><span class="line">        WebElement loginBtn = driver.findElement(By.id(<span class="string">"loginBtn"</span>));</span><br><span class="line">        loginBtn.click();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NetUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试本机端口是否被使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> port</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isLocalPortUsing</span><span class="params">(<span class="keyword">int</span> port)</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//如果该端口还在使用则返回true,否则返回false,127.0.0.1代表本机</span></span><br><span class="line">            flag = isPortUsing(<span class="string">"127.0.0.1"</span>, port);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * 测试主机Host的port端口是否被使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> host</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> port</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPortUsing</span><span class="params">(String host,<span class="keyword">int</span> port)</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InetAddress Address = InetAddress.getByName(host);</span><br><span class="line">            <span class="comment">//建立一个Socket连接</span></span><br><span class="line">            Socket socket = <span class="keyword">new</span> Socket(Address,port);</span><br><span class="line">            flag = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">//log.info(e.getMessage(),e);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 由于本机上安装了mysql，采用3306端口去验证</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> testPost =<span class="number">3306</span>;</span><br><span class="line">        <span class="keyword">if</span>(isLocalPortUsing(testPost))&#123;</span><br><span class="line">            System.out.println(<span class="string">"端口 "</span>+testPost+<span class="string">" 已被使用"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"端口 "</span>+testPost+<span class="string">"未使用"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取可用端口</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getAvailablePort</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">65535</span>;</span><br><span class="line">        <span class="keyword">int</span> min = <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> port = random.nextInt(max)%(max-min +<span class="number">1</span>) + min;</span><br><span class="line">        <span class="keyword">boolean</span> using = NetUtils.isLocalPortUsing(port);</span><br><span class="line">        <span class="keyword">if</span>(using)&#123;</span><br><span class="line">            <span class="keyword">return</span>  getAvailablePort();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span>  port;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在使用selenium进行自动化测试中我们有时会遇到这样的情况：&lt;/p&gt;
&lt;p&gt;​    我们需要手动打开浏览器，进入到所需的页面，执行一些手动任务，如输入表单、输入验证码，登陆成功后，然后再开始运行自动化脚本。
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>教你一招，让 Selenium 在 Linux 中以有头模式运行</title>
    <link href="https://blog.songuo.tech/p/48af776f.html"/>
    <id>https://blog.songuo.tech/p/48af776f.html</id>
    <published>2021-04-12T02:22:00.000Z</published>
    <updated>2021-04-12T01:23:25.093Z</updated>
    
    <content type="html"><![CDATA[<p>经常使用 Selenium 或者 Puppeteer 的同学都知道，启动的 Chrome 浏览器分为有头模式和无头模式</p><p>如果是有头模式，则会弹出一个 Chrome 浏览器窗口，然后你能看到这个浏览器里面在自动操作；而无头模式则不会弹出任何窗口，只有产生一个进程<a id="more"></a></p><p>下面这篇文章中，我们介绍了一个探测模拟浏览器特征的网站</p><p><a href="http://mp.weixin.qq.com/s?__biz=MzU1OTI0NjI1NQ==&amp;mid=2247487094&amp;idx=1&amp;sn=87a2e7e52b07f909a1e72aa1b91a3717&amp;chksm=fc1b70b6cb6cf9a0b88c90ebe62934b0fdccd8de8b50308bbcbb870fc1dec522b60db4770288&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">别去送死了！爬虫使用 Selenium 与 Puppeteer 能被网站探测的几十个特征</a></p><p>通过他我们可以发现，在不做任何设置的情况下，Selenium 或者 Puppeteer 启动的浏览器有几十个特征能够被目标网站识别为爬虫，并且无头模式的特征比有头模式的特征多得多</p><p>也就是说，即使你不使用任何隐藏特征的技术，仅仅使用有头模式，你都会安全很多；如果网站不是非常严格的反爬虫，很多情况下，使用无头模式更容易被发现，但使用有头模式，更难被发现</p><p>下图为使用 <strong>有头模式</strong>，不使用任何隐藏特征的技术访问检测网站：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/96cdb561e80d4c1461af117caf62aabe.webp" alt="img"></p><p>下图为使用 <strong>无头模式</strong>，不使用任何隐藏特征的技术访问检测网站：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/c78866a23b2fa8084385ac71dac09563.webp" alt="img">万里河山一片红</p><p>所以，一般情况下，你应该多使用有头模式</p><p>但问题在于，当我们要在 Linux 服务器上面使用 Selenium 或者 Puppeteer 运行爬虫的时候，就会发现有头模式始终会报错</p><p>这是因为，有头模式需要系统提供图形界面支持，才能绘制浏览器窗口，但是 Linux 服务器一般来说是没有图形界面的，所以有头模式一定会失败</p><p>在这种情况下，为了能够使用模拟浏览器的有头模式，我们需要搞一个假的图形界面出来，从而欺骗浏览器，让它的有头模式能够正常使用</p><p>为了达到这个目的，我们可以使用一个叫做 <code>Xvfb</code>的东西，这个东西在<strong>维基百科上面的介绍</strong>[1]如下：</p><blockquote><p>Xvfb or X virtual framebuffer is a display server implementing the X11 display server protocol. In contrast to other display servers, Xvfb performs all graphical operations in virtual memory without showing any screen output.</p></blockquote><p>Xvfb 在一个没有图像设备的机器上实现了 X11显示服务的协议，它实现了其他图形界面都有的各种接口，但并没有真正的图形界面</p><p>所以当一个程序在 Xvfb 中调用图形界面相关的操作时，这些操作都会在虚拟内存里面运行，只不过你什么都看不到而已</p><p>使用 Xvfb，我们就可以欺骗 Selenium 或者 Puppeteer，让它以为自己运行在一个有图形界面的系统里面，这样一来就能够正常使用有头模式了</p><p>要安装 Xvfb 非常简单，以 Ubuntu 为例，只需要执行下面两行命令就可以了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install xvfb</span><br></pre></td></tr></table></figure><p>现在，我们来写一段非常简单的 Selenium 操作 Chrome 的代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">from selenium.webdriver import Chrome</span><br><span class="line">driver &#x3D; Chrome(&#39;.&#x2F;chromedriver&#39;)</span><br><span class="line">driver.get(&#39;https:&#x2F;&#x2F;bot.sannysoft.com&#x2F;&#39;)</span><br><span class="line">time.sleep(5)</span><br><span class="line">driver.save_screenshot(&#39;screenshot.png&#39;)</span><br><span class="line">driver.close()</span><br><span class="line">print(&#39;运行完成&#39;)</span><br></pre></td></tr></table></figure><p>如果直接在服务器上运行，效果如下图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/3af1ffa5df2ca95749019ae507fc28ad.webp" alt="img"></p><p>由于 Linux 服务器原本没有图形界面，所以程序必定会报错</p><p>现在，我们只需要在运行这段代码的命令前面加上<code>xvfb-run</code>，再来看看运行效果：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/3477ba8196dc91380fdfdb2ca54791d1.webp" alt="img"></p><p>代码成功运行，没有报错</p><p>现在我们从服务器上把这个生成的<code>screenshot.png</code>文件拉下来，打开以后可以看到内容如下：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/46d70727e1108e70ae88481e3cb1a77e.webp" alt="img"></p><p>可以看到，虽然窗口比较小，但确实是有头模式下面的检测结果</p><p>当然，我们也可以调整一下窗口大小，增加参数：<code>xvfb-run python3 test.py -s -screen 0 1920x1080x16</code>就能假装在一个分辨率为 1920x1280 的显示器上运行程序了</p><p>然后修改 Selenium 的代码，设置浏览器窗口的大小：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/c724d8b10a293a9ea1fc614767053e73.webp" alt="img"></p><p>运行效果如下图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210412/da15650d8e689291a6051275a9284bc4.webp" alt="img"></p><p>本文演示仅仅使用的是 Python操作 Selenium，同样你也可以试一试使用 Puppeteer，只需要把启动命令改为<code>xvfb-run node index.js</code> 即可！</p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p>[1]维基百科上面的介绍: <em><a href="https://en.wikipedia.org/wiki/Xvfb" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Xvfb</a></em></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;经常使用 Selenium 或者 Puppeteer 的同学都知道，启动的 Chrome 浏览器分为有头模式和无头模式&lt;/p&gt;
&lt;p&gt;如果是有头模式，则会弹出一个 Chrome 浏览器窗口，然后你能看到这个浏览器里面在自动操作；而无头模式则不会弹出任何窗口，只有产生一个进程
    
    </summary>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/categories/selenium/"/>
    
    
      <category term="selenium" scheme="https://blog.songuo.tech/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>图画书幼儿观察能力的年龄特点与指导策略（5—6岁）</title>
    <link href="https://blog.songuo.tech/p/a92bd79b.html"/>
    <id>https://blog.songuo.tech/p/a92bd79b.html</id>
    <published>2021-04-08T13:13:00.000Z</published>
    <updated>2021-04-09T02:54:57.049Z</updated>
    
    <content type="html"><![CDATA[<p>（一）5～6岁幼儿图画观察能力的基本特点是：</p><ol><li><p>能很好地把握单页图画中各个事物之间的关系，也能在一定程度上把握页与页之间的内容联系，观察的有序性、细致性、概括性、坚持性等已发展到一定水平。</p><p>绝大部分幼儿能按顺序完整讲述单页图画的内容，大部分幼儿能完整讲述多页图画所呈现的内容，部分幼儿能够完整讲述整本书的图画内容。</p></li></ol><p>​    2. 能够对画面信息进行较为深入的分析、解释，作出某种推断。</p><p>   幼儿不仅能比较细致地观察、描述图画内容，还能对图画中隐藏的人物心理、因果关系等进行一定程度的探究，也能根据画面提供的信息对图画内容进行预测和推断。</p><p>​    3. 在理解图画内容的基础上，能在教师有针对性的引导下理解图画书的表现方式，即基本结构。</p><p>(二)5～6岁幼儿图画观察能力发展的指导策略：</p><p>   教师对5～6岁幼儿图画观察能力的指导可重在对多页图画内容的连续观察上，从而引导幼儿由关注单页图画的内容向分析、推断多页图画内在的联系乃至主题内容、逻辑关系等过渡，培养幼儿对于图画内在信息的分析、推理能力，帮助幼儿逐渐了解图画书的基本结构。具体可运用以下指导策略：</p><p>​    1．根据图画书的结构引导幼儿连续观察多页画面，从整体上把握图画书的基本内容。</p><p>图画书的图画总是以一定的结构呈现的，有的是连续性的情节结构，比如说我们前面提到的《古利和古拉》，有的是句式重复的结构，比如说《逃家小兔》。我们可以帮助幼儿发现其中的内在规律，根据图画书内容将其划分为多个完整意义单元，请幼儿观察一个完整意义单元后，再对这个完整意义单元的图画进行表述。</p><p>比如故事《逃家小兔》，便是句式重复的结构，妈妈和小兔以“如果你变成……我就变成……”的句式展开对话来编构故事情节。我们也会发现它是由两个页面构成的完整意义单元，例如小兔说：“如果你变成大树，我就变成小帆船，漂得远远的，远远的。”妈妈说：“如果你变成小帆船，我就变成风，把你吹到你想去的地方。”我们可以让幼儿先观察这两个画面，一幅是海面上飘着一只小帆船，这只小帆船和我们平时看见的不一样，它长着长长的兔子耳朵，让幼儿想象这个小帆船便是小兔子变得。另一幅图画和前一幅的区别就在于，图妈妈出现在远处，大口大口地吹着凤，兔妈妈变成了一阵阵地风，把小帆船吹得远远的。这样的画面能引起幼儿无尽的想象。</p><p>这个故事中每两个页面构成一个完整意义单元，整个故事有九个这样的意义单元，每个意义单元之间也是密切联系，不管小兔子变成什么，总“逃”不脱妈妈的爱，如此循环，最后回到起点。在指导幼儿阅读的过程中，我们可以先让其观察完一个意义单元，再引导幼儿按句式看图画进行完整表述。在这个过程中，幼儿不仅学会了观察多个页面构成的意义单元并进行表述，也能分析推断出多个页面之间的关系和整个故事的逻辑结构，更便于从整体上把握图画书的内容。</p><p>​    2．多采用整体性的、深层次的提问。</p><p>   我们在引导幼儿连续、完整地观察某部分或某几部分图画内容之前，通常需要先抛出一系列整体性的、深层次的问题，让幼儿带着问题观察具体的图画。</p><p>   还是以《逃家小兔》为例，在幼儿阅读之前，我们可以问“小兔子接二连三地变成了什么？”“兔妈妈又是怎么做的？”让幼儿带着这些问题观察每一幅图画，通过观察，幼儿不难找到这个问题的答案。然后我们可以再问“为什么兔妈妈要跟着小兔子变来变去？”这个问题的重点就在于，让幼儿去分析兔妈妈变的和小兔子变的有什么关系，从而让其明白兔妈妈是因为爱小兔子，想要保护小兔子才会跟着小兔子变来变去，体会其中浓浓的母爱。</p><p>   这就需要我们根据图画书的内容和结构，设置整体性的、深层次的问题，引导幼儿通过观察，思考页面之间的逻辑关系，并能对图画书的内容进行相对深入的分析、解释和推断。</p><p>   3．在幼儿观察整本书的图画之后，教师要引导幼儿梳理图画内容，帮助幼儿了解图画书所呈现出来的结构。</p><p>   幼儿阅读完一本图画书之后，我们可以再一次翻开大图书，用“开始”“然后”“接着”“最后”等引导语带领幼儿梳理图画书内容发展的顺序及基本结构，也可以用图表的方式加以引导。图表的填写可以用图画加文字的方式来填写。</p><p>   总体来看，大班幼儿观察图画的有序性、细致性、概括性、坚持性都有一定的发展，我们的指导应重在引导其通过观察分析、推断多页图画的内在联系，培养对图画内在信息的分析和推理能力。在平时的阅读中，我们要弄清楚图画书的内在结构，将图画书划分成几个完整的意义单元，让幼儿观察每个单元的图画，在此基础上把握整体内容，同时还要注意通过深层次的提问引导幼儿观察图画内容，并进行深入的分析和推断，</p>]]></content>
    
    <summary type="html">
    
      图画书幼儿观察能力的年龄特点与指导策略（5—6岁）
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>图画书幼儿观察能力的年龄特点与指导策略（4—5岁）</title>
    <link href="https://blog.songuo.tech/p/594d12c6.html"/>
    <id>https://blog.songuo.tech/p/594d12c6.html</id>
    <published>2021-04-08T13:12:00.000Z</published>
    <updated>2021-04-09T02:54:57.039Z</updated>
    
    <content type="html"><![CDATA[<p>（一）4～5岁幼儿图画观察能力的基本特点是：</p><p>​    1. 观察的有序性增强。</p><p>   通过前期的引导，我们发现这一时期幼儿能逐渐按照从主到次、从左到右、从上到下等基本顺序观察图画，开始意识到单页图画中各事物之间的联系，也能够用自己的话简单概括出单页图画的基本内容，但对连续观察多页图画并概括其内容有较大困难。</p><p>​    2. 高度关注细节，尝试赋予每个细节以意义。</p><p>   中班幼儿对图画的某些细节有着特别的观察兴趣，并喜欢由此展开想象。如图画书《爷爷一定有办法》中，有一个细节就是图画的下方有“小老鼠一家”，这让幼儿特别感兴趣，其实这个细节在故事中并没有什么特殊的意义，但幼儿会特别关注，而且对每一页小老鼠的活动都非常感兴趣。</p><p>​    3. 能发现关键线索，但还不能贯穿观察的始终。</p><p>   如在《爷爷一定有办法》中，图画的关键线索是旧毯子做成的东西越来越小，从最开始的外套到后来的背心、领带、纽扣。可能经我们引导，幼儿在刚开始阅读时可能会发现这条关键线索，但随着阅读活动的延续，很多幼儿会“忘记”利用该线索来预测故事情节。</p><p>(二)4～5岁幼儿图画观察能力发展的指导策略：</p><p>   教师对4～5岁幼儿图画观察能力的指导应先重在帮助幼儿整体观察单页图画，然后逐渐过渡到对两页以至多页图画的连续观察，重在提高幼儿对多页图画观察的概括性，帮助幼儿理解画页间的联系。具体可运用以下指导策略：</p><p>​    1．初次阅读时，引导幼儿把握故事主要线索，忽略无关细节。</p><p>   刚刚我们谈到过，这一时期幼儿对某些细节部分格外感兴趣，并喜欢展开想象。所以在初次阅读的过程中，教师不要主动提及无关细节让幼儿观察，即便有幼儿关注，我们也尽量采用“忽略”策略，以防幼儿将关注点投向寻找细节和赋予细节意义上，或者展开过多的想象，影响对图画主要内容的观察和理解。</p><p>   如在《爷爷一定有办法》中，教师在初次引导幼儿观察图画时应该先以“约瑟一家”这条线索为主，让幼儿跟随故事画面，从毯子到外套，再到背心，领带……随着故事的进展，在爷爷说出：“这块料子还够做……”时，引导幼儿发挥想象，接下来还可以做什么呢？</p><p>   在初次观察的时候，“小老鼠一家”这条辅助线索可暂时不观察。不过，关于这个细节，我们也可以想一想，为什么这个图画书中会有小老鼠一家这个细节呢？因为约瑟爷爷剪下来的那些碎毯子，最后都掉到了小老鼠一家中，成了它们布置房间的好材料，包括最后的那一粒让约瑟怎么都找不到的纽扣。在理解了故事之后，我们再来看小老鼠一家，会发现随着旧毯子做成的东西越来越小，裁下来的碎片让小老鼠的家也是布置得越来越漂亮了。这时，我们会觉得这个故事的内容更加丰满了。</p><p>   我们发现，在图画书的画面上某个不那么引人注目的地方，常常隐藏着许多作者在经意或不经意之间留下的细节。它们有的与作品的主题无关，只不过是增加一点小噱头或是出自于作者个人的癖好，但也有的与主题息息相关，甚至可以说，缺少了这样一个细节，整个作品就缺少了很多乐趣，少了很多色彩。</p><p>   正是这样的一些独具匠心的细节，往往是孩子们最容易注意到的，更能吸引幼儿一次又一次地阅读。需要注意的是，在初次观察的时候不能被细节耗费太多的时间，容易造成幼儿的注意力过于集中在细节方面，影响了对主要内容的理解。在把握了故事内容之后，再来观察细节，才能更好地感受到细节的力量,彰显故事趣味。</p><p>​    2．运用重点观察法把握书中图画的关键线索。</p><p>   一本图画书通常有几十页画面，这些画面一幅幅连贯起来，一个故事就被叙述出来了。问题是，这一幅幅画面是怎样被连贯起来的呢？其实，图画书的画面与画面之间都是被一根关键线索串联起来的，通过重点观察，我们可以把握这条关键线索。</p><p>   比如《爷爷一定有办法》这个故事的关键线索是什么呢？——这条奇妙的毯子发生的变化，我们可以用“重点观察法”，引导幼儿重点观察每一幅画面中这条毯子变成了什么，外套——背心——领带——手帕——纽扣，在这个过程中幼儿不难发现，这条旧毯子做成的东西越来越小。与此同时，我们也可以引导幼儿重点观察一下“小老鼠一家”的变化，从最开始一个空空的洞穴，到后来安上了窗帘，铺上了桌布，小老鼠们都穿上了衣服，这条毯子裁剪剩下的碎布也让小老鼠的一家变得越来越漂亮了。</p><p>   通过重点观察图画书的“关键线索”，并由此展开分析和讨论，以此能让幼儿抓住故事发展的脉络，从而有效加深对图画、故事内容的理解。</p><p>​    3．运用回溯法帮助幼儿了解页与页之间的关系。</p><p>   我们指导幼儿看懂一本图画书，要经历这样的一个过程：先看懂每一页的内容，并在此基础上建立每页与每页的联系，从而整体把握图画书的内容。对中班幼儿，我们的指导要从整体观察单页图画逐渐过渡到对两页以至多页图画的连续观察，那么我们该如何引导幼儿把握页与页之间的关系呢？</p><p>   还是以《爷爷一定有办法》为例，在观察图画的过程中，奇妙的毯子变成了外套、背心……我们发现奇妙毯子的每一次变化都有这样一个过程：妈妈说约瑟看看你的……真该把它丢了——爷爷拿起……翻过来又翻过去——爷爷拿起剪刀……再用针缝——最后做成了……</p><p>   这样，每四个页面构成一个完整的意义单元。在阅读每个单元的过程中，每当问题出现的时候，孩子们都会想到“爷爷一定有办法”，随着“爷爷把这块料子翻过了，又翻过去”，孩子们会欢快地“咯吱”“咯吱”地模仿爷爷剪子的声音。 在幼儿阅读每个单元后，我们可引导幼儿回顾本意义单元各页的内容，以引导幼儿了解该意义单元各页之间的内在关联。</p><p>   在幼儿明白页与页之间联系的基础上，我们还要适时引导幼儿对前面几个页面的内容进行回顾，从而帮其更好地梳理故事脉络，理解故事的结构，为深入阅读打下基础。</p><p>   总体来看，中班幼儿大都能按一定的顺序来观察一幅图画，但是对于连续观察多页图画，概括多页图画的内容还有一定的困难，所以我们在引导幼儿观察画面时，要引导幼儿注意到前一页图画和后一页图画的联系在哪里，帮助建立页与页之间的联系，从而整体把握图画书的内容，并鼓励幼儿用自己的语言来连贯地讲出故事。</p>]]></content>
    
    <summary type="html">
    
      图画书幼儿观察能力的年龄特点与指导策略（4—5岁）
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>图画书幼儿观察能力的年龄特点与指导策略（3—4岁）</title>
    <link href="https://blog.songuo.tech/p/d6010cf1.html"/>
    <id>https://blog.songuo.tech/p/d6010cf1.html</id>
    <published>2021-04-08T13:11:00.000Z</published>
    <updated>2021-04-09T02:54:57.036Z</updated>
    
    <content type="html"><![CDATA[<p>   总体来看，小班幼儿在观察图画的时候，最突出特点就是喜欢关注单个、零散的事物，不能按顺序观察，具体有以下表现：</p><p>(一)3～4岁幼儿图画观察能力的基本特点：</p><p>​    1. 能指认图画中的单个事物并命名。</p><p>   我们发现，幼儿在这一时期已经能辨认生活中的很多具体事物，只要图画中出现的事物处于幼儿经验范围之内，他们就能说出单个事物是什么，而且还非常乐意指着图画中自己认识的事物说个不停。</p><p>​    2. 容易注意到零散、个别的现象或事物，尤其是与其兴趣直接相关的事物，但很难把握图画中各事物之间、事物与整体环境之间的关系。</p><p>   比如说《小田鼠的背带裤》这个故事中，看第一幅图画，幼儿就会被画面上众多的小动物所吸引，可能会指着小老鼠、兔子、猪、河马说着它们的名字，而丝毫不关注小田鼠身上的那件颜色鲜亮的背带裤，小田鼠穿上这件背带裤时得意的神情，和其它小动物看到小田鼠这件背带裤时羡慕的眼神，也不会想到围绕这件让大家都羡慕不已的背带裤，接下来会发生些什么事情。</p><p>   基于以上特点，容易产生的问题就是幼儿会格外关注图画中单个具体的事物，不能很好地抓住单页图画中的关键信息，也无法从整体上把握单页图画描述的主题，很难对一幅完整的图画进行概括性的表述。</p><p>​    3. 观察的无序性突出，坚持性较差。</p><p>   幼儿基本上不知道应该按什么顺序观察一幅图画，他们往往喜欢总从自身的经验或者是自己的兴趣出发跳跃着观察，注意力往往集中在自己熟悉、喜欢的事物上，持续观察时间也不长。</p><p>   针对以上特点，我们对3～4岁幼儿图画观察能力的指导应重在培养幼儿细致、有序地观察单页图画，抓住单页图画中的重点细节进行观察，逐步发现单页中各事物之间的联系，并能概括单页图画内容的能力。具体可运用以下指导策略：</p><p>(二)3～4岁幼儿图画观察能力发展的指导策略：</p><p>​    1．提出明确、具体的观察任务。</p><p>   前面我们在“幼儿观察目的性发展”这一部分提到过，这一时期幼儿不能达到有目的地观察，有时候只看一处，有时候随意乱指。如何解决这个问题呢？我们可以用明确、具体的观察任务来加以引导。</p><p>具体来说，我们可以将观察任务化解成具体的问题来引导幼儿有针对性地观察，获取关键信息。在这里，提什么样的问题也很关键 。</p><p>   【提问】比如说，小田鼠的背带裤第一页，我们要给幼儿的观察任务就是请幼儿观察小田鼠的穿着和其他小动物有什么不同，从而让幼儿将注意力集中在小田鼠的这条背带裤上。针对这个任务，我们该如何提问呢？</p><p>如果我们问幼儿“画面上有什么呀？”幼儿可能说有兔子、小田鼠……到最后都不会关注到背带裤上。而如果我们问“小田鼠身上穿着什么呀？”“小田鼠的背带裤好看吗？”这样的问题，就可以将幼儿的注意力集中在小田鼠的这条漂亮的背带裤上。我们还可以引导他们想一想，“这么漂亮的背带裤，其他小动物看到了会怎么样呢？”</p><p>   这个问题也是和幼儿的生活经验相贴近的，在生活中，当幼儿看到其他小伙伴有了新奇的玩具的时候，自然也想玩一下。通过这样的提问，能引导幼儿将这种心理迁移到故事画面中，自然就会关注小田鼠穿上背带裤的得意神情，和其他动物充满羡慕的眼神。</p><p>   通过明确的提问，具体的任务引导幼儿去观察每一幅图画，可以让幼儿有效地获取图画中的关键信息，为理解故事内容打好基础。另外，在幼儿阅读单页图画后，我们还要及时帮幼儿梳理、概括该页图画的基本内容，看完《小田鼠的背带裤》第一幅图画后，我们可以说“小田鼠今天穿了一条这么漂亮的背带裤，非常高兴，其它小动物看到了也非常喜欢，想穿一穿，它们接下来会怎么做呢？”一方面引导幼儿关注单页图画中各事物之间的联系，借此帮助幼儿形成对于单页图画内容的概括能力，另一方面通过设悬，启发幼儿想象后面的图画内容，借此帮助幼儿形成前后图画之间的联系。</p><p>​    2．运用遮挡法引导幼儿有序观察。</p><p>前面我们在讲幼儿观察特点的时候提到过，3~4岁的幼儿基本不知道该按什么顺序来观察一幅图，从而导致观察很随意。如何解决这个问题呢？</p><p>   为了让幼儿养成按顺序观察的习惯，在幼儿观察每幅图画时，我们可以把需要幼儿稍后观察的事物先遮挡起来，然后逐步去掉遮挡，借此暗示图画观察的顺序。最终引导幼儿养成从上到下，从左到右，从主到次的观察顺序。</p><p>   比如《小田鼠的背带裤》第一幅图画，我们可以先把旁边的兔子、小猪、河马这些动物遮挡起来，让幼儿着重观察小田鼠。观察它的穿着，观察它的表情，同时设想它的心情，在了解这些主体信息的基础上再让幼儿观察一旁的其他小动物。</p><p>   需要注意的是，我们在运用遮挡法引导幼儿观察的同时，提问也需要具有针对性，围绕需要幼儿观察的部分进行提问。</p><p>​    3．运用动作、表情或实物引导幼儿观察。</p><p>   有时，图画中难免会出现幼儿生活经验之外的事物，造成幼儿理解上存在难度。为了扫清障碍，我们引导幼儿观察图画的时候需要运用动作、表情来增加这些事物的形象性，如果有必要我们还要准备相关实物来引导幼儿观察，帮助幼儿理解图画。</p><p>   在这里有一点需要提醒大家的是，我们借助动作、表情或实物，往往能吸引幼儿的注意，增强幼儿观察图画的兴趣，但切不可喧宾夺主，影响幼儿对图画本身的观察。</p><p>   总的来看，小班幼儿在观察图画书画面时由于目的性不够明确，导致观察很随意，往往碰到什么就观看什么，顺序紊乱，坚持性也较差，而且受情绪的影响很大。在阅读图画书的过程中，我们要多引导，比如说通过提问，明确观察的目的，促进他们主动，有效的观察。在平时的教学中，我们也可以通过一些游戏活动，比如“找别扭”“配对对”等，激发幼儿的观察兴趣，教会幼儿观察的方法。养成按从上到下、从左到右、由整体到局部的顺序来观察的习惯。</p>]]></content>
    
    <summary type="html">
    
      图画书幼儿观察能力的年龄特点与指导策略（3—4岁）
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>图画书幼儿观察能力发展特点</title>
    <link href="https://blog.songuo.tech/p/67817741.html"/>
    <id>https://blog.songuo.tech/p/67817741.html</id>
    <published>2021-04-08T13:11:00.000Z</published>
    <updated>2021-04-09T02:54:57.034Z</updated>
    
    <content type="html"><![CDATA[<p>   幼儿期是观察力发展的萌芽阶段。3岁以前幼儿的观察多是随意的，无目的性的。比如说，这一时期的幼儿在小区玩耍的时候，无意中会被鸟儿的喳喳声，汽车的喇叭声，还有开得正艳的花朵等各种事物所吸引，有时候还会盯着自己感兴趣的事物看上好一阵子。这时他们的知觉是被动的，是无意的知觉，简单地说，这些知觉都是由外界刺激物引起的。</p><p>   而当幼儿渐渐成长，我们带着他到户外去感受春天，观察春天的树叶、花朵，分辨它们不同的颜色，感觉不同的气味，感受春天的阳光、微风时，这时的观察才是视觉、听觉、触觉、嗅觉等多种感知觉综合的结果，这个过程中包含着理解、思考，有一定的目的性和计划性。</p><p>   我们发现，幼儿早期的观察基本上是被动的、无意识的观察，这一时期的观察需要成人的引导，否则很容易被外界其他事物所吸引，分散注意力。随着年龄的增长，在我们正确的教育和引导下，幼儿的观察能力逐渐由先前的无意知觉转变为有目的、有组织的多重感知觉综合的“思维的知觉”，形成初步的有目的、有方向、自觉的观察能力。</p><p>   但就整个发展来说，幼儿观察力的发展还是不够的，他们观察的目的性、持续性、理解性、条理性等都还不强。具体表现在以下几个方面：</p><p>一、观察的目的性发展 </p><p>   刚刚我们谈到，幼儿早期的观察是随意的，无目的性的。这一时期的观察需要成人的引导，否则很容易被其他事物所吸引。到了中后期，幼儿观察的目的性增强，开始排除干扰，主动进行观察。在—项关于幼儿观察的研究中，研究者将幼儿观察的目的性分成了三级水平。</p><p>   一级：能根据任务有目的地观察，遇到困难和干扰也能坚持细致观察；</p><p>   二级：能够有目的地观察，但遇到困难和干扰不能克服，不愿坚持；</p><p>   三级：不能根据任务有目的地观察，东张西望，或只看一处，或随意乱指。</p><p> 二、观察的持续性发展 </p><p>​    我们都知道，幼儿自我控制力较差，容易受外界的干扰，所以他们无法像成人一样坚持长时间观察。另外，幼儿的情绪、兴趣、爱好等也会影响观察的时间。不过在教育和引导下，幼儿可以逐渐学会持续地观察事物。</p><p>   在上述的测查实验中，各年龄幼儿观察图画的平均持续时间随年龄增长而延长。3—4岁幼儿的观察时间平均为6分8秒； 5岁时为7分6秒； 6岁为12分3秒。从6岁开始，观察的持续时间显著增加。这表明大班学生是观察持续性发展的快速期。</p><p>三、观察的理解性的发展 </p><p>   所谓观察的理解性就是指在观察过程中，善于发现某种事物的特征，能透过事物的表面现象，发现事物之间的联系。一般来说，小班幼儿由于思维发展水平的限制，观察处于无意识、零碎、孤立的阶段，这时幼儿只能观察到事物的表面特征和现象，无法把所观察到的事物有机地联系起来，观察的概括能力很低。</p><p>   例如，图片上画着一棵苹果树和一个小女孩，苹果树上结满了红苹果。小班幼儿看见这幅图片可能只会注意图片上的苹果了，往往注意不到图片上的小女孩，也不会建立小女孩和苹果树之间的联系，想象“小女孩想要摘苹果”这一主题。这个时候他们处在只是理解图画中个别对象或者个别细节的阶段。而少部分中班幼儿开始能概括出图画之间的一些简单的联系。这主要是因为幼儿思维能力发展的影响导致的。 </p><p>四、观察的顺序性和条理性的发展 </p><p>   一般地说，小班、中班幼儿的观察缺乏顺序性和条理性，往往是随便看，翻到哪里是哪里，或者是凭兴趣想看哪里是哪里，并且常常是边用手指，边看，嘴里还常常自言自语。大班幼儿开始掌握初步的观察的方法。但是也仍然处于萌芽阶段。</p>]]></content>
    
    <summary type="html">
    
      图画书幼儿观察能力发展特点
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>亲子共读的指导策略</title>
    <link href="https://blog.songuo.tech/p/e81f7c45.html"/>
    <id>https://blog.songuo.tech/p/e81f7c45.html</id>
    <published>2021-04-08T13:10:00.000Z</published>
    <updated>2021-04-09T02:54:57.025Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、亲子共读的类型"><a href="#一、亲子共读的类型" class="headerlink" title="一、亲子共读的类型"></a>一、亲子共读的类型</h2><h3 id="（一）平行式亲子阅读"><a href="#（一）平行式亲子阅读" class="headerlink" title="（一）平行式亲子阅读"></a>（一）平行式亲子阅读</h3><p>特点：母亲与孩子一起阅读的时候,基本不谈论或者很少谈论图画书的内容。</p><p>总结：平行式亲子阅读关系没有发挥帮助幼儿,支持幼儿持续阅读的作用。</p><h3 id="（二）偏离式亲子阅读"><a href="#（二）偏离式亲子阅读" class="headerlink" title="（二）偏离式亲子阅读"></a>（二）偏离式亲子阅读</h3><p>特点: １.无视或者忽略书中文字的作用。</p><p>2.误读画面内容,过度注意细枝末节。</p><p>3.随意,过多地无意联想。</p><p>4.表面上是围绕故事书在交流,实际上已经游离于故事情景之外。</p><p>总结:偏离式阅读是水平较低的一种阅读行为,母亲的阅读”指导”无形中会让幼儿对图画故事产生错觉,认为故事无趣,没有任何挑战性。</p><h3 id="（三）合作式亲子阅读"><a href="#（三）合作式亲子阅读" class="headerlink" title="（三）合作式亲子阅读"></a>（三）合作式亲子阅读</h3><p>特点：母亲与孩子围绕图画书故事展开有效交流的一种亲子阅读形式。</p><p>总结:在合作式亲子阅读中,母亲适宜的指导,对幼儿良好习惯的形成,阅读兴趣的激发,基本阅读能力和元认知能力的培养均会起到促进作用。</p><h2 id="二、指导家长进行家庭早期阅读的策略"><a href="#二、指导家长进行家庭早期阅读的策略" class="headerlink" title="二、指导家长进行家庭早期阅读的策略"></a>二、指导家长进行家庭早期阅读的策略</h2><h3 id="（一）指导家长为幼儿创设阅读环境"><a href="#（一）指导家长为幼儿创设阅读环境" class="headerlink" title="（一）指导家长为幼儿创设阅读环境"></a>（一）指导家长为幼儿创设阅读环境</h3><p>家长在家里也应为孩子创设一个自由读书的空间,让孩子随手可以拿到自己喜爱的书，并给家庭中的物品做一些名称标记,如“妈妈的房间”,“宝宝的玩具狗”“电视机”等。家长还可以通过指导幼儿观察不同的印刷品来帮助幼儿了解文字的功能和重要意义,如查看账单、信件、报纸或购物单等。从不同的活动中不断丰富阅读内容,也进一步培养幼儿阅读能力。</p><p>我们要充分利用家访和接送幼儿的机会，与家长交流，使家长明白，良好的阅读习惯和能力对幼儿想象力、创造力、语言表达能力的提高有着密切的关系。鼓励家长在家中也为孩子创设良好的阅读环境，每天抽出时间为孩子朗读故事，和孩子共同看画面，帮助孩子理解内容等等。</p><h3 id="（二）指导家长利用社区资源进行早期阅读"><a href="#（二）指导家长利用社区资源进行早期阅读" class="headerlink" title="（二）指导家长利用社区资源进行早期阅读"></a>（二）指导家长利用社区资源进行早期阅读</h3><p>幼儿与家庭有意为孩子创设的是一个固定的环境,自然和社会则是一个千变万化的大环境,是幼儿更容易获取阅读信息的大课堂。公路的名称,交通标志,商店的名称,广告用语等都是很好的阅读材料。</p><p>（“鸣喇叭”的标志表示机动车行至该标志处必须鸣喇叭。此标志设在公路的急转弯处、陡坡等视线不良路段的起点。）</p><h3 id="（三）家庭与幼儿园之间开展多种形式的互动"><a href="#（三）家庭与幼儿园之间开展多种形式的互动" class="headerlink" title="（三）家庭与幼儿园之间开展多种形式的互动"></a>（三）家庭与幼儿园之间开展多种形式的互动</h3><p>全面提升孩子的各种综合能力。针对我国当前家庭的现状，大多数以三口之家为主，孩子从小就缺乏过集体生活的经历，而且大都以自我为主，很少能够替别人考虑，比较霸道任性，幼儿园开展了形式多样的互动活动，让孩子们在玩的过程中成长。家园合作活动的开展，不仅使家长成为活动的参与者，而且还是活动的策划者、组织者、实施者，他们真正成了幼儿园的合作伙伴和良师益友。这些活动的开展，使家长、老师、幼儿都得到了全方位的提高。</p>]]></content>
    
    <summary type="html">
    
      亲子共读的指导策略
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>幼儿故事的分类及策略</title>
    <link href="https://blog.songuo.tech/p/f34a2084.html"/>
    <id>https://blog.songuo.tech/p/f34a2084.html</id>
    <published>2021-04-08T12:09:00.000Z</published>
    <updated>2021-04-09T02:54:57.048Z</updated>
    
    <content type="html"><![CDATA[<p>儿童故事是一种具有悠久历史的儿童文学体裁，以其起伏多变、充满童趣的情节在小读者中播撒着文学的种子，因而他在儿童文学中站着十分重要的位置。故事作为一种最受幼儿喜欢的文字形式，其优美的景色，典型的人物形象塑造，生动的故事讲述，让幼儿深深为之吸引，使他们增长了知识，发展了智力，并从中受到感染和教育，懂得什么是真善美，什么的假丑恶，从而培养爱憎分明的情感，并把学到的好思想见褚于行动中。</p><h2 id="一、幼儿故事的分类"><a href="#一、幼儿故事的分类" class="headerlink" title="一、幼儿故事的分类"></a>一、幼儿故事的分类</h2><p>1、幼儿故事一般分为：民间故事、动物故事、历史故事、地理故事、生活故事</p><p>2、按照故事题材分：亲情类、社交类、成长类、励志类、知识类、友情类、行为习惯类、个性培养类。</p><h2 id="二、不同年龄幼儿故事学习的特点"><a href="#二、不同年龄幼儿故事学习的特点" class="headerlink" title="二、不同年龄幼儿故事学习的特点"></a>二、不同年龄幼儿故事学习的特点</h2><p>1．小班</p><p>幼儿已有简单的故事图式，但这个时期他们对故事的理解往往集中于某一个人物或者某一个事物，不能进行连贯的理解。教师应该注重语言规范的引导、故事情节连贯性的建构，引导幼儿了解故事发展的因果关系。教师所提供的故事内容应情节简单、语言简洁明了、易于理解、故事图画书的画面以简单为主要内容。</p><p>2．中班</p><p>这个时期是幼儿故事建构的重要时期。教师要充分利用各种活动，提供合适的、种类丰富的刺激材料发展幼儿故事的表述能力。教师要注重指导幼儿建构故事情节的完整结构，如故事高潮部分的讲述、对故事细节信息的关注、把握故事主题等。</p><p>3．大班</p><p>幼儿故事讲述、复述、续编能力都有了很大提高。教师要注重在对故事内容理解的指导，续编更适合大班幼儿。</p><h2 id="三、不同类型故事的教学策略"><a href="#三、不同类型故事的教学策略" class="headerlink" title="三、不同类型故事的教学策略"></a>三、不同类型故事的教学策略</h2><p>（一）亲情类：</p><p>1．概念：故事情节主要以家人之间的爱为线索展开讲述，让幼儿感受父母是如何我们，我们应该如何去爱父母。</p><p>2．教学策略：这一类的故事适合用谈话法。</p><p>通过老师设置不同的问题，层层深入的引导幼儿感受父母、长辈对自己的爱。只有这样才能让幼儿充分的感受到这种情感的教育与熏陶。</p><p>（二）社交类：</p><p>1．概念：通过各种生活故事，培养正在成长中幼儿初步的社会交往能力，告诉幼儿怎样与同伴相处。</p><p>2．教学策略：这一类故事都是来源于幼儿的实际生活场景，并且是通过故事情节培养幼儿与人交往的方式。因此适合用故事表演法，让幼儿通过扮演故事中的角色，体验角色的感受，从而获得交往的能力。</p><p>（三）成长类：</p><p>1．概念：通过一些简单的事件或孩子成长的对比告诉孩子成长的过程是曲折的，也是快乐的。</p><p>2．教学策略：这一类故事适合运用列提纲法和自制图书法。成长类故事主要是围绕着成长中经历的事情展开讲述，因此，适合运用列提纲的方法，将故事发展的线索用概括的语句整理出来，便于记忆、复述故事。</p><p>（四）励志类：</p><p>1．概念：故事的主旨是告诉孩子面对困难的态度及树立相信自己的信念，有持之以恒的决心。</p><p>2．教学策略：这一类故事需要幼儿从故事中获得一些启示，明白一些道理。因此适合运用故事命名法。让幼儿在听完故事后能够通过给自己的启示，用核心的词语或句子总结概括出故事的主旨。</p><p>（五）知识类：</p><p>1．概念：（含认知和启智两类故事）围绕一件事情让幼儿掌握解决问题的方法，或围绕一件事物展开思考，拓展幼儿的思维及想象能力。</p><p>2．教学策略：这一类故事是帮助幼儿增长见识，更充分的认识世界，获得更多经验的。适合于用解释概括法和小组探索法。</p><p>（六）友情类：</p><p>1．概念：故事情节主要围绕“同伴”、“朋友”间的友谊及真挚的情感，使幼儿从故事中体验到朋友的珍贵。</p><p>2．教学策略：这一类故事适合用移情法和戏剧表演法。因为友情类的故事一般都取材于幼儿的实际生活，贴近幼儿的经验，所以便于幼儿通过扮演角色，体验主人翁的情感，从而获得更多经验。</p><p>（七）行为习惯类:</p><p>1．概念：故事情节一般围绕幼儿生活中的不良的习惯展开，通过移情的方式帮助幼儿培养良好的行为习惯。</p><p>2．教学策略：这一类故事适合用讨论法，行为习惯类的故事，故事情节的安排一般都是先出现不好的或不争取得现象，然后通过完善、改正，从而得出正确的方法。因此，在这样的过程中教师可以运用讨论法，让幼儿结合自己的生活经验展开讨论，总结出正确的行为。</p><p>（八）个性培养类：</p><p>1．概念：通过故事培养幼儿完善、健全的人格。</p><p>2．教学策略：这一类故事适合于用移情法。个性培养类的故事主要是培养幼儿养成良好的个性，因此，教师可以运用移情的方法让幼儿通过体验主人翁的情感，从而转移到自己身上，使幼儿的个性得到良好的发展。</p><p>​    不同的故事具有不同的内容、情节和结构，要激发幼儿听讲故事的兴趣，帮助幼儿理解故事的主题、情节，使之产生心灵上的呼应和共鸣，关键在于教师的课前准备工作，教师必须反复钻研作品，分析故事的主题，掌握故事的情节、结构，找准其中的重点、难点，设计出适合幼儿和作品的教案，真正做到因材施教。在故事教学中，教师必须根据故事内容，结合幼儿的年龄特点，认知发展水平等，利用生动有趣的教育方法，鼓励、引导幼儿敢说、能说、会说。</p><p>​    在幼儿园开展故事教学活动，要以幼儿为主体，以兴趣为中心，从幼儿的心理和生理特点出发，遵循幼儿语言发展的规律，改变传统的学习方式，让幼儿通过体验、参与，生动活泼地进行学习。</p>]]></content>
    
    <summary type="html">
    
      幼儿故事的分类及策略
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>绘本教学的组织方法及策略（四）</title>
    <link href="https://blog.songuo.tech/p/dfe9d0e.html"/>
    <id>https://blog.songuo.tech/p/dfe9d0e.html</id>
    <published>2021-04-08T12:03:00.000Z</published>
    <updated>2021-04-09T02:54:57.056Z</updated>
    
    <content type="html"><![CDATA[<p>根据教学的策略来分：</p><h2 id="观察式清晰阅读法"><a href="#观察式清晰阅读法" class="headerlink" title="观察式清晰阅读法"></a>观察式清晰阅读法</h2><p>​    绘本是一种独立的图书形式，文字与图画共同承担着讲故事的重要责任，图画不再仅仅起辅助和诠释文字的作用，图画、文字之间是一种平衡的关系，相互衬托，才能营造出整个绘本的完美感觉，所以绘本特别注重文字与图画的内在关系。当然，也有一些相当著名的绘本只有图画，而完全没有文字。</p><p>​    绘本《神秘的大衣》这样的图画与文字的结合，深深地吸引住了孩子们的眼球，孩子们的观察力被这么拟人化的展示充分的调动起来，他们在阅读时很容易就关注到了类似于这样的有趣细节，可以让孩子们清晰地了解绘本的脉络，为成功阅读提供了有效的保证。</p><h2 id="想象式深入阅读法"><a href="#想象式深入阅读法" class="headerlink" title="想象式深入阅读法"></a>想象式深入阅读法</h2><p>​    优秀的绘本能给幼儿提供无限的想象空间，而包含了幼儿丰富想象的绘本更是拓展了原有作品的内涵，使其变得更加丰满。</p><p>​    1．预测故事。无论什么书，封面都是最先映入读者眼帘的，而在阅读前让孩子对故事进行猜测会激起孩子强烈的阅读欲望。比如绘本《神秘的大衣》的封面，瞧瞧他，一副神秘兮兮的样子，胖得无边无际，领子里居然露出火烈鸟的长脖子、长颈鹿的脑袋、兔子的耳朵。蜥蜴从他的衣襟里探出身来。他的挎包里面，蹲着两只怪模怪样的鹅。他的如同鳄鱼一般起伏的背上，停着一只乌鸦……</p><p>​    2．设疑想象。设置这样的环节，意在培养幼儿大胆质疑、猜想、预测等主动学习的能力。同时也能帮助教师了解幼儿的实际水平和已有的生活经验，为更好的阅读绘本奠定扎实的基础。如《我的幸运一天》看了题目和封面就设疑：这是谁的幸运一天呢？他幸运在什么地方呢？（它为什么会幸运呢）等等。</p><p>​    3．合理联想。幼儿在看一本书时，不仅会联想到现实的生活、其他的文学作品、还会把自己想象成这个作品中喜欢的角色，这就是幼儿的年龄特征所引发的。如《蛤蟆爷爷的秘诀》“如果你遇见了这样的怪兽，你会怎么办？”</p><h2 id="游戏情景式探究阅读法"><a href="#游戏情景式探究阅读法" class="headerlink" title="游戏情景式探究阅读法"></a>游戏情景式探究阅读法</h2><p>​    当阅读引起了强烈的情感共鸣时，幼儿常常会以角色扮演和身体动作等方式对绘本作出回应。当幼儿听到故事的高潮部分时或是阅读之后，幼儿的角色往往会从一个听众变成一个游戏者，在游戏的情境中，幼儿不是孤立存在的，有了伙伴的互动，大家可以共享对故事的不同见解，他们有时会用自己独特的动作或是简短语言以示回应，这也是幼儿将动作和语言结合起来表现对故事的理解，这样的游戏方式能促进幼儿更深入地探究绘本。</p><p>​    1．绘本阅读中的游戏。如在《猜猜我有多爱你》中让老师和家长扮演大兔子，小朋友扮演小兔子，开展的角色游戏活动。</p><p>​    2．绘本阅读之外的游戏。为了能给孩子创设更多的游戏机会，在绘本阅读之后，还可以开展语言游戏，将绘本中人物、动物制作成小卡片放入区域，丰富幼儿的游戏内容。</p><p>​    在游戏的情境中幼儿理解故事相对而言会比较容易些。如果设置了游戏的场景，并给孩子提供相应的服装等物品，再配上幼儿的语言、表情、感情、动作，幼儿就能通过多种感官进入故事的情境。游戏的情境随幼儿自己把握，幼儿可以在某一感兴趣的情节、或是疑惑的部分不断徘徊，直到问题和兴趣得以满足再进行接下来的游戏。</p><h2 id="生活式感悟阅读法。"><a href="#生活式感悟阅读法。" class="headerlink" title="生活式感悟阅读法。"></a>生活式感悟阅读法。</h2><p>​    图文并茂的绘本吸引着孩子。绘本的价值和魅力在于：它没有一句教条，却能满足孩子的成长需要；没有一丝说理，却能启发孩子的深入思考；没有一点儿喧闹，却能激起孩子的会心大笑。在绘本阅读中“让孩子像个孩子”。正如美国诗人惠特曼一首诗中所说：“有一个孩子每天向前走去/他看见最初的东西/他就变成那东西/那东西就变成了他的一部分……”通过阅读绘本，儿童不断进行着情感的体验，凭借着阅读，情感得到了提高和升华。在孩子的世界里，在轻松愉快的阅读中，埋下影响终生的良好的情感。如：在《猜猜我有多爱你》《我爱你，小猴子》《彩虹的尽头》的阅读中，孩子们充分感受到父母的爱，朋友的爱，丰富了孩子的情感，激发孩子的爱心。当阅读把快乐带给儿童时，就把无可估量的巨大精神财富带给了他们，就为他们建造起了自由的精神空间与心灵家园。儿童在与绘本进行心灵对话中，在闪烁着人性光辉、充满大自然和谐和童真童趣的字里行间徜徉时，必定会开阔眼界，丰富内心，升华境界，健全人格。</p><p>​    绘本阅读的开展给幼儿的早期阅读提供理性的经验，也为如何培养幼儿的早期阅读能力积累了一定的经验。但在实践中还有许多问题值得深入研究，比如阅读绘本时其他领域的活动如何整合才能促进幼儿全面的发展？阅读绘本的模式会有哪几种？等等。在今后的工作中我还将进行进一步的探究，争取获得更多的绘本指导策略。</p>]]></content>
    
    <summary type="html">
    
      绘本教学的组织方法及策略（四）
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>绘本教学的组织方法及策略（三）</title>
    <link href="https://blog.songuo.tech/p/bad3846b.html"/>
    <id>https://blog.songuo.tech/p/bad3846b.html</id>
    <published>2021-04-08T12:02:00.000Z</published>
    <updated>2021-04-09T02:54:57.051Z</updated>
    
    <content type="html"><![CDATA[<p><strong>（三）集体教学的组织方法及策略。</strong></p><p>根据教学的方式来分：1、分段式2、主干式3、细节式4、整体式5、综合式</p><p><strong>分段式阅读法——有机运用故事情节</strong>。</p><p>分段式阅读法是将一个绘本分成几个部分逐步进行教学的方法。绘本通常以较多连续的画面展示一个完整的故事，相对而言有故事的容量比较大，而且不少的作品情节跌宕起伏，每个转折的关键情节都是一个很好的教学契机，这样的绘本就很适合进行分段式的阅读。比如绘本《给天使一对翅膀》为例。将绘本的阅读分成三部分进行，第一部分集体阅读，知道小男孩画了一个天使，而天使不要那种有羽毛的翅膀。第二部分亲子阅读，小男孩为天使画了许多美丽而又新奇的翅膀。第三部分集体阅读，天使为了报答小男孩，带着小男孩绕着老胡桃树飞了三圈。最后再完整阅读故事。<br>  <strong>主干式阅读法——突出呈现故事的主题。</strong></p><p>主干式阅读法指的是在不影响作品主题的前提下，抽出绘本主要的骨架展开的教学方法。在阅读这类绘本时我们可以尝试在第一次的阅读中可采取先阅读故事的主要情节、简化语言等方式，再进入第二次的深入阅读。例如绘本《蛤蟆爷爷的秘诀》《神秘的大衣》。<br><strong></strong>  <strong>细节式阅读法**</strong>——<strong>**细致地感受作品精髓。</strong><br>   细节式阅读法指细致地观察绘本中有趣的细节，从而达到感受作品完美意境的方法。虽然每本书的文图构成不同，以图画为主，有的绘本文字少，有的文字多，但优秀的绘本文字都考虑了情节、场景、人物、心理等的变化，图画也具有动态感和流畅性，使整个画面看起来和谐、完整。一些图画设计非常巧妙，别具匠心，既能协助突出主题，又能让人忍俊不禁，运用细节式阅读绘本中这些精彩的部分，能让幼儿更细致感受作品，有时也能以这种方式切入来阅读绘本。如《母鸡萝丝去散步》，在故事的扉页有一张地图，就是母鸡散步的路线，画面把萝丝的家、院子、池塘、草垛、磨房、篱笆和蜂箱完整而连贯地以大页面的方式展现，把故事情节的主线直接拎出来，与地图上“母鸡萝丝去散步”相呼应，作者的考虑是多么的巧妙与慎密。</p><p><strong>整体式阅读法**</strong>——<strong>**整体地展现作品内容</strong>。</p><p>整体式阅读法是完整地阅读整个绘本的教学方法。精彩的绘本图画艺术性强，非常富有情感，故事的主题来自于幼儿的生活经验，能引发幼儿共鸣的，完整地阅读能带给幼儿情感上的冲击、语言上的提升。在绘本阅读中，整体式的阅读是最重要的策略之一，它经常使用在绘本的内容比较浅显或重复较多、幼儿阅读能力较强、阅读相似的绘本、分段阅读之后等情况之下。如《给天使一对翅膀》《猜猜我有多爱你》《彩虹的尽头》等在教学的最后环节都运用了整体式阅读。</p><p>  <strong>各种方法的综合运用</strong>。</p><p>  绘本是一种独立的图书形式，文字与图画共同承担着讲故事的重要责任，图画不再仅仅起辅助和诠释文字的作用，两者之间是一种相互依托的关系，这才营造出绘本完美的感觉。因此，我们应针对不同的绘本展开教学，深入分析的基础上进行精心设计，可以将上述方法进行有机地组合，帮助幼儿读懂绘本，读透绘本，从而提高幼儿的阅读能力。</p><p>以下，我列举了几种策略综合使用的心得：</p><div class="table-container"><table><thead><tr><th>策略</th><th>绘本</th><th>策略的反思</th><th>幼儿反应</th></tr></thead><tbody><tr><td>分段式+细节式+整体式</td><td>《给天使一对翅膀》</td><td>1.分段的时机比较恰当，给幼儿提供了充足的想象空间；2. 细节式阅读让幼儿更细致的发现小男孩丰富的想象力。3. 分段后的整体阅读能让幼儿整体地感受作品，并发现作品画面中的小细节。</td><td>（第一次分段的想象）1.猜想：小男孩会给天使画上怎样的翅膀呢？2.哇！有这么多的翅膀啊！3.小男孩可真会想啊！这些翅膀真漂亮！……</td></tr><tr><td>整体式+细节式</td><td>《母鸡萝丝去散步》</td><td>1.内容比较集中，整体式阅读直接给幼儿完整的印象；2.细节式的阅读体现在对比式阅读的铺垫和整体阅读后扉页的阅读中。</td><td>（幼儿在活动中的预测）1.我猜狐狸会踩在钉耙上，脚上会出血的；2.山羊用头上的角顶狐狸，他帮助了母鸡；3.看这只狐狸就知道它是吃不到母鸡的。</td></tr><tr><td>分段式+整体式+细节式</td><td>《猜猜我有多爱你》</td><td>1.完整式阅读能让幼儿完整地领略大兔子和小兔子的爱；2.细节式阅读时进一步观察两只兔子对爱的表达——那经典的动作。</td><td>（练习句式时的摘录）1.地球有多大，我就有多爱你；2.大海里的水有多深，我就有多爱你；3.高楼大厦有多高，我就有多爱你。</td></tr><tr><td>……</td><td>……</td><td>……</td><td>……</td></tr></tbody></table></div>]]></content>
    
    <summary type="html">
    
      绘本教学的组织方法及策略（三）
    
    </summary>
    
    
      <category term="生活学习" scheme="https://blog.songuo.tech/categories/%E7%94%9F%E6%B4%BB%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="绘本" scheme="https://blog.songuo.tech/tags/%E7%BB%98%E6%9C%AC/"/>
    
  </entry>
  
</feed>
