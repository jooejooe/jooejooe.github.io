<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.121.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16.icon><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32.icon><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="WEB套打程序开发 (lodop使用)"><meta itemprop=description content="记录轨迹。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=keywords content="lodop"><meta property="og:type" content="article"><meta property="og:title" content="WEB套打程序开发 (lodop使用)"><meta property="og:description" content="记录轨迹。"><meta property="og:image" content="/imgs/hugo_next_avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/post/%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF/web%E5%A5%97%E6%89%93%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91-lodop%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="松果小站"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="松果小站"><meta property="article:published_time" content="2021-05-12 15:30:00 +0000 UTC"><meta property="article:modified_time" content="2021-05-12 15:30:00 +0000 UTC"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.e83ed60f44a866830eb8ff84b9b1ceb1b585dff20463c785c1f71ea16bf54e9c.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"web%E5%A5%97%E6%89%93%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91-lodop%E4%BD%BF%E7%94%A8","permalink":"/post/%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF/web%E5%A5%97%E6%89%93%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91-lodop%E4%BD%BF%E7%94%A8/","title":"WEB套打程序开发 (lodop使用)","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>WEB套打程序开发 (lodop使用) - 松果小站</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>松果小站</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>松果小站博客</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>分类</a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>标签</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>142</span></a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=松果小站 src=/imgs/img-lazy-loading.gif data-src=/imgs/hugo_next_avatar.png><p class=site-author-name itemprop=name>松果小站</p><div class=site-description itemprop=description>记录轨迹。</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>142</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>35</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>112</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/jooejooe title="Github → https://github.com/jooejooe" rel=noopener target=_blank>Github</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>凡梦星尘空间站1</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-gtranslate class=button title=多语言翻译><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/jooejooe rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/post/%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF/web%E5%A5%97%E6%89%93%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91-lodop%E4%BD%BF%E7%94%A8/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/hugo_next_avatar.png"><meta itemprop=name content="松果小站"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="松果小站"><meta itemprop=description content="记录轨迹。"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="WEB套打程序开发 (lodop使用)"><meta itemprop=description content="

    WEB套打程序开发 (lodop使用)
    
    
    

WEB套打可选方案不多，理想的更少，利用免费控件Lodop+JavaScript实现精确套打，算是较为经典的选择。这种方案其实比较简单，利用一个htm文件就可以实现模板设计过程，几乎是“空手套”式的开发，但理解这几个步骤还是需要点时间，下面一步步详细演示说明："></span><header class=post-header><h1 class=post-title itemprop="name headline">WEB套打程序开发 (lodop使用)
<a href=https://github.com/jooejooe/jooejooe.github.io/tree/master/post/post/%e5%bc%80%e5%8f%91%e6%8a%80%e6%9c%af/WEB%e5%a5%97%e6%89%93%e7%a8%8b%e5%ba%8f%e5%bc%80%e5%8f%91%20%28lodop%e4%bd%bf%e7%94%a8%29.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2021-05-12 15:30:00 +0000 UTC" itemprop="dateCreated datePublished" datetime="2021-05-12 15:30:00 +0000 UTC">2021-05-12
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C itemprop=url rel=index><span itemprop=name>开发经验</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>3921</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>8分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=busuanzi_value_page_pv data-path=/post/%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF/web%E5%A5%97%E6%89%93%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91-lodop%E4%BD%BF%E7%94%A8/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p><a href=https://www.diewufeiyang.com/post/1210.html title="WEB套打程序开发 (lodop使用)" rel="noopener external nofollow noreferrer" target=_blank class=exturl>WEB套打程序开发 (lodop使用)
<i class="fa fa-external-link-alt"></i></a></p><p>WEB套打可选方案不多，理想的更少，利用免费控件Lodop+JavaScript实现精确套打，算是较为经典的选择。这种方案其实比较简单，利用一个htm文件就可以实现模板设计过程，几乎是“空手套”式的开发，但理解这几个步骤还是需要点时间，下面一步步详细演示说明：</p><p>第一步：建立一个空白的模板设计文件</p><p>把以下超文本代码复制到一个本地htm文件中:</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-1.jpg alt=img></p><p>本文模拟EMS特快专递单的程序开发，文件起名为printEMS.htm，权且称它为模板设计文件。</p><p>第二步：用浏览器打开该文件</p><p>在本地文件夹中双击该文件就可以打开，但在进入设计之前，你的机器需要安装Lodop，如果还没安装过，</p><p>请在如下地址下载安装文件(解压rar后运行那个exe文件，Lodop是一个1M左右的小文件)：</p><p><a href=http://www.lodop.net/download.html title=http://www.lodop.net/download.html rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://www.lodop.net/download.html
<i class="fa fa-external-link-alt"></i></a></p><p>第三步：准备设计</p><p>成功安装Lodop之后再次打开模板设计文件printEMS.htm，点击其中“模板设计”链接，就弹出如下空白的打印设计窗口：</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-2.jpg alt=img></p><p>为了尽快定位模板中的数据位置，你需要做一张票据扫描图作为背景，当然没有扫描图也能完成，只是需要多摸索几次，费点时间而已。</p><p>下面是我做的EMS扫描图，你把该图另存成一个jpg文件，以便我们一起完成后面的演示步骤。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-3.jpg alt=img></p><p>第四步：装载背景图并调整图片大小</p><p>在打印设计窗口，点下图所示的“装载背景图&mldr;”菜单，调入以上保存的EMS图片文件。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-4.jpg alt=img></p><p>装载背景图后，点上图所示的“调整背景图&mldr;”菜单，弹出下图“背景图调整”窗口，设定其中的图片宽度为209mm,高度113mm会自动变化。</p><p>这个宽度值是我测量实际票据得来的。如果扫描图是按1:1比例获得的，那么调整背景图这一步就免了，当然要做点这点很难，所以最好还是在这里直接设置具体尺寸反倒简单。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-5.jpg alt=img></p><p>第五步：添加数据内容，开始打印测试</p><p>点下图所示“插入文本项”菜单，添加打印内容，内容项可以拖拉或精细调整，基本对准之后，点击“预览”按钮（注意旁边的“打印”按钮是收费功能，纸上会有水印，而“预览时的打印”按钮是完全免费的，我们用后者）。</p><p>把内容打印到薄一点的白纸上，然后在阳光下与真实票据透亮对比，以最左最上的某个内容为基准，其它内容远近调整，如此反复测试直到所有内容相互位置都对准。</p><p>这一步先做到内容之间的相互位置对准，等下一步处理整体位置。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-6.jpg alt=img></p><p>第六步：整体对准</p><p>由于打印机左边距或上边距不一定是零或票据边缘有误差，所以尽管第五步打印出来的内容相互之间位置是准确的，但打印到真实票据上仍会整体偏离一些，需要进行整体位置调整。</p><p>点击下图红圈所示的“纸钉”按钮，“纸钉”弹起后，整个设计版面就可以上下左右调整了，然后按上一步的办法打印测试，直到整体对准成功。为了避免浪费票据，打印时仍可用薄白纸测试，注意此时透光对照时，纸张的左边沿和上边沿要与票据对齐，通过观察内容的位置来判断是否整体对准。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-7.jpg alt=img></p><p>第七步：生成打印模板的程序代码</p><p>套打测试成功后，点击第五步图中所示的“生成程序代码”菜单，出现下图结果，这些代码就是我们需要的模板程序代码，把他们复制出来，准备融合到你的页面程序中使用。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-8.jpg alt=img></p><p>第八步：完成打印模板设计文件</p><p>想不想知道WEB套打有啥感觉？好，我们先做一个静态WEB页面爽一下：把第七步生成的程序代码，</p><p>插入替换第一步的空白设计文件CreatePrintPage函数内，变成如下内容:</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-9.jpg alt=img></p><p>把以上内容复制到另外一个htm文件printEMS_OK.htm中，双击打开它，点其中的打印预览，就可以实现简单的WEB套打了。</p><p>以上八步基本完成了模板设计，并实现静态页面套打，但要把模板代码融合到实际的WEB程序中，还需要做些工作。</p><p>第九步：模板程序代码的使用</p><p>把以上CreatePrintPage函数进行简单改造，原函数如下：</p><p>Java</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>function <span style=color:#a6e22e>CreatePrintPage</span>() {
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>PRINT_INITA</span>(14,11,800,600,<span style=color:#e6db74>&#34;套打EMS的模板&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(95,95,75,20,<span style=color:#e6db74>&#34;寄件人姓名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(123,148,194,20,<span style=color:#e6db74>&#34;寄件人单位名称&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(158,101,238,35,<span style=color:#e6db74>&#34;寄件人的详细地址&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,446,75,20,<span style=color:#e6db74>&#34;收件人姓名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(122,496,208,20,<span style=color:#e6db74>&#34;收件人单位名称&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(160,460,244,35,<span style=color:#e6db74>&#34;收件人详细地址&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(289,47,178,22,<span style=color:#e6db74>&#34;内件品名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(290,258,100,20,<span style=color:#e6db74>&#34;内件数量&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,245,100,20,<span style=color:#e6db74>&#34;寄件人电话&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(90,608,75,20,<span style=color:#e6db74>&#34;收件人电话&#34;</span>);
</span></span><span style=display:flex><span> };
</span></span></code></pre></div><p>把其中的打印内容提出来做为变量参数，函数改成如下样式：</p><p>Java</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>function <span style=color:#a6e22e>CreatePrintPage</span>(strPName,strJJRXM,strJJRDW,strJJRDZ,strSJRXM,strSJRDW,strSJRDZ,strNJPM,strNJSL,strJJRDH,strSJRDH) {
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>PRINT_INITA</span>(14,11,800,600,strPName);        <span style=color:#75715e>//打印任务名</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(95,95,75,20,strJJRXM);       <span style=color:#75715e>//寄件人姓名</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(123,148,194,20,strJJRDW);    <span style=color:#75715e>//寄件人单位名称</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(158,101,238,35,strJJRDZ);    <span style=color:#75715e>//寄件人的详细地址</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,446,75,20,strSJRXM);      <span style=color:#75715e>//收件人姓名</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(122,496,208,20,strSJRDW);    <span style=color:#75715e>//收件人单位名称</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(160,460,244,35,strSJRDZ);    <span style=color:#75715e>//收件人详细地址</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(289,47,178,22,strNJPM);      <span style=color:#75715e>//内件品名</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(290,258,100,20,strNJSL);     <span style=color:#75715e>//内件数量</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,245,100,20,strJJRDH);     <span style=color:#75715e>//寄件人电话</span>
</span></span><span style=display:flex><span>    LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(90,608,75,20,strSJRDH);      <span style=color:#75715e>//收件人电话</span>
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>这个改造后的JS函数还是很好理解的，无论写入js文件还是直接嵌在页面内都简单易用。</p><p>如果你改变了内容的字体、大小、粗斜体等格式，代码还会多一些，但总体来说比较简洁。</p><p>第十步：设置纸张高度，实现连续套打</p><p>多数套打业务的票据是连续纸，需要精确地分页，从而保证连续多页打印不偏移，</p><p>为此以上代码还要在PRINT_INITA之后加一行SET_PRINT_PAGESIZE语句：</p><p>Java</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>function <span style=color:#a6e22e>CreatePrintPage</span>() {
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>PRINT_INITA</span>(14,11,800,600,<span style=color:#e6db74>&#34;套打EMS的模板&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>SET_PRINT_PAGESIZE</span>(1,<span style=color:#e6db74>&#34;209mm&#34;</span>,<span style=color:#e6db74>&#34;113mm&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>);<span style=color:#75715e>//设置纸张高度</span>
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(95,95,75,20,<span style=color:#e6db74>&#34;寄件人姓名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(123,148,194,20,<span style=color:#e6db74>&#34;寄件人单位名称&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(158,101,238,35,<span style=color:#e6db74>&#34;寄件人的详细地址&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,446,75,20,<span style=color:#e6db74>&#34;收件人姓名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(122,496,208,20,<span style=color:#e6db74>&#34;收件人单位名称&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(160,460,244,35,<span style=color:#e6db74>&#34;收件人详细地址&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(289,47,178,22,<span style=color:#e6db74>&#34;内件品名&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(290,258,100,20,<span style=color:#e6db74>&#34;内件数量&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(92,245,100,20,<span style=color:#e6db74>&#34;寄件人电话&#34;</span>);
</span></span><span style=display:flex><span>     LODOP.<span style=color:#a6e22e>ADD_PRINT_TEXT</span>(90,608,75,20,<span style=color:#e6db74>&#34;收件人电话&#34;</span>);
</span></span><span style=display:flex><span> };
</span></span></code></pre></div><p>其中209mm这个纸宽参数意义不大，主要是113mm这个高度参数，它决定了每页的走纸距离，对连续打印影响很大。这个值是我测量实际票据高度得来的，包含纸张之间的撕孔间隙。理想的测量方式，是若干页连起来一起测量取其平均高。</p><p>加入纸高控制后的打印预览如下，你可以连续打印两页内容到同一张长一点的白纸上，测试对照一下看看。把以上加入SET_PRINT_PAGESIZE语句的代码复制进第三个htm文件printEMS_OKM.htm试试。假如从第二页开始，内容向下偏移，说明纸张高度设置比实际票据大，就减小113mm这个参数值，否则增大它，这个参数可以精确到0.1mm。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-10.jpg alt=img></p><p>第十一步：让操作者自己调整位置</p><p>以上十步实现的套打可以很精确，但都是以当前打印机为前提。如果你的打印程序要面对许多种类型的打印机，甚至一些未知的打印机类型，那么“打印维护”功能会很有用处。你可以根据情况在程序中把该功能授权给最终操作者或现场技术维护人员，让使用者自己来调整打印位置，以适应各种类型的打印机。</p><p>打印维护的指令语句是PRINT_SETUP，进入包含该功能的在线文件PrintEMS_OKMSetup.htm,先在打印维护中调整一下打印内容或整体位置，点“应用”按钮。关闭浏览器后重新打开，进入“打印预览”，看看是否有关联变化。下图是打印维护界面，其中能看到“应用”按钮和“恢复整体缺省”按钮的位置。</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://cdn.jsdelivr.net/gh/jooejooe/images/image/20210512/0025zsLrzy6GWjHaJkK3a-11.jpg alt=img></p><p>注意： 如果你在电脑对打印纸张已经进行了设置，就不需要在程序中设置纸张大小，如下面两句:LODOP.PRINT_INITA(14,11,800,600,&ldquo;套打EMS的模板&rdquo;);LODOP.SET_PRINT_PAGESIZE(1,&ldquo;209mm&rdquo;,&ldquo;113mm&rdquo;,"");//设置纸张高度；如果你两边都进行设置就会出现打印纸张不符合的问题，打印机会出现检查错误，从而打印不了，具体设置根据你测试情况而定</p><p>本文参考如下资料：</p><p><a href=http://www.lodop.net/demo.html title=http://www.lodop.net/demo.html rel="noopener external nofollow noreferrer" target=_blank class=exturl>http://www.lodop.net/demo.html
<i class="fa fa-external-link-alt"></i></a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/lodop>lodop</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/office/word%E5%A6%82%E4%BD%95%E8%B0%83%E6%95%B4%E6%96%87%E5%AD%97%E5%AE%BD%E5%BA%A6/ rel=next title=Word如何调整文字宽度><i class="fa fa-chevron-left"></i> Word如何调整文字宽度</a></div><div class="post-nav-prev post-nav-item"><a href=/post/%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF/java%E5%88%A9%E7%94%A8freemarker%E6%A8%A1%E6%9D%BF%E7%94%9F%E6%88%90docx%E6%A0%BC%E5%BC%8F%E7%9A%84word%E6%96%87%E6%A1%A3/ rel=prev title=java利用Freemarker模板生成docx格式的word文档>java利用Freemarker模板生成docx格式的word文档
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=gtranslate class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2020 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>松果小站</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.121.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.0fb3547374c917d23a2e5f762b70f3698d20b46a01cc18c38f9c467aeffc99fc.js defer></script></body></html>